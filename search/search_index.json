{"config":{"lang":["en","ru"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"hey there  <p> About Me</p> <p>I am a DevOps engineer from Saint-Petersburg</p> <p>\u2705 Completed courses:</p> <ul> <li>KodeKloud - Certified Kubernetes Application Developer (CKAD)</li> <li>Yandex practicum - DevOps</li> <li>ITMO - DevOps engineer</li> <li>Yandex practicum - Algorithm and data structure</li> <li>MIPT - Deep Learning School</li> </ul> <p>\ud83d\udc36 Pet projects:</p> <ul> <li>Golang - telegrambot dockerization and grpc integration</li> <li> <p>Deep learning - deploy Convolutional neural network in Heroku</p> </li> <li> <p> How to reach me:  </p> </li> </ul> <p> Languages and Tools:</p>"},{"location":"03%20IaC/3.1_YandexCloud/","title":"3.1 Yandex cloud","text":""},{"location":"03%20IaC/3.1_YandexCloud/#cli-yandex-cloud","title":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 CLI yandex cloud","text":"<p>\u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f</p> <pre><code>curl -sSL https://storage.yandexcloud.net/yandexcloud-yc/install.sh | bash\n\nyc init\n\nyc config list\n</code></pre>"},{"location":"03%20IaC/3.1_YandexCloud/#_1","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0435\u0442\u0438","text":"<pre><code># \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043a\u043e\u043c\u0430\u043d\u0434 CLI \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u043e\u0431\u043b\u0430\u0447\u043d\u044b\u043c\u0438 \u0441\u0435\u0442\u044f\u043c\u0438:\nyc vpc network --help\n\n# \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043e\u0431\u043b\u0430\u0447\u043d\u0443\u044e \u0441\u0435\u0442\u044c \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c \u0432 \u0432\u0430\u0448\u0435\u043c \u043f\u0440\u043e\u0444\u0438\u043b\u0435 CLI:\nyc vpc network create \\\n  --name my-yc-network \\\n  --labels my-label=my-value \\\n  --description \"my first network via yc\"\n\n# \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043f\u043e\u0434\u0441\u0435\u0442\u044c \u0432 \u043e\u0431\u043b\u0430\u0447\u043d\u043e\u0439 \u0441\u0435\u0442\u0438 my-yc-network\nyc vpc subnet create \\\n  --name my-yc-subnet-a \\\n  --zone ru-central1-a \\\n  --range 10.1.2.0/24 \\\n  --network-name my-yc-network \\\n  --description \"my first subnet via yc\"\n\n# \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u0435 \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043e\u0431\u043b\u0430\u0447\u043d\u044b\u0445 \u0441\u0435\u0442\u0435\u0439 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c \u0432 \u0432\u0430\u0448\u0435\u043c \u043f\u0440\u043e\u0444\u0438\u043b\u0435 CLI\nyc vpc network list\n\nyc vpc network list --format yaml\n</code></pre>"},{"location":"03%20IaC/3.1_YandexCloud/#_2","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0412\u041c","text":"<pre><code># \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u0412\u041c Linux\nyc compute instance create \\\n  --name my-yc-instance \\\n  --network-interface subnet-name=my-yc-subnet-a,nat-ip-version=ipv4 \\\n  --zone ru-central1-a \\\n  --ssh-key ~/.ssh/id_ed25519.pub\n\n# \u0423\u0437\u043d\u0430\u0439\u0442\u0435 \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0439 IP-\u0430\u0434\u0440\u0435\u0441 \u0412\u041c. \u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0432\u0430\u0448\u0435\u0439 \u0412\u041c\nyc compute instance get my-yc-instance\n\n# \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f\nssh yc-user@xxx.xxx.xxx.xxx\n</code></pre>"},{"location":"03%20IaC/3.1_YandexCloud/#_3","title":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0412\u041c, \u0441\u0435\u0442\u044c \u0438 \u043f\u043e\u0434\u0441\u0435\u0442\u044c","text":"<pre><code>yc compute instance delete my-yc-instance\n\nyc vpc subnet delete my-yc-subnet-a\n\nyc vpc network delete my-yc-network\n</code></pre>"},{"location":"03%20IaC/3.1_YandexCloud/#_4","title":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u0442\u043e\u043a\u0435\u043d","text":"<pre><code>export YC_TOKEN=\"$(yc iam create-token)\"\n</code></pre>"},{"location":"03%20IaC/3.1_YandexCloud/#gitlab-ci-pipeline","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0432 gitlab-ci pipeline","text":"<ul> <li>\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e YC_SERVICE_ACCOUNT_KEY_FILE</li> </ul>"},{"location":"03%20IaC/3.2_Terraform/","title":"3.2 Terraform","text":""},{"location":"03%20IaC/3.2_Terraform/#terraform","title":"\u0417\u043d\u0430\u043a\u043e\u043c\u0441\u0442\u0432\u043e \u0441 Terraform","text":"<ul> <li>\u0418\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442 \u0434\u043b\u044f \u0434\u0435\u043a\u043b\u0430\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b</li> <li>\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0445 .tf-\u0444\u0430\u0439\u043b\u0430\u0445</li> <li>State<ul> <li>\u0412\u0430\u0448\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u043d\u0435 \u0437\u043d\u0430\u044e\u0442 \u043e \u0442\u043e\u043c \u0447\u0442\u043e \u043e\u043d\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u044b \u0447\u0435\u0440\u0435\u0437 \u0442\u0435\u0440\u0440\u0430\u0444\u043e\u0440\u043c</li> <li>\u0422\u0435\u0440\u0440\u0430\u0444\u043e\u0440\u043c \u0431\u0435\u0437 state'a \u043d\u0435 \u0437\u043d\u0430\u0435\u0442 \u043d\u0438\u0447\u0435\u0433\u043e \u043e \u0432\u0430\u0448\u0435\u0439 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0435</li> </ul> </li> </ul> <pre><code>terraform -h\n\nterraform init\nterraform plan\nterraform apply\nterraform destroy\nterraform show\n</code></pre> <p>Note</p> <p>\u041f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440 \u044d\u0442\u043e \u0443\u0436\u0435 \u043a\u0435\u043c \u0442\u043e \u043d\u0430\u043f\u0438\u0441\u0430\u043d\u043d\u0430\u044f \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0430 \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u0430\u043c \u043d\u0430 \u044f\u0437\u044b\u043a\u0435 \u0422\u0435\u0440\u0440\u0430\u0444\u043e\u0440\u043c\u0430 \u043e\u0431\u0449\u0430\u0442\u044c\u0441\u044f \u0441 \u043a\u0430\u043a\u043e\u0439 \u0442\u043e \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 \u0433\u0434\u0435 \u0432\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0434\u0435\u043b\u0430\u0442\u044c \u0441\u0432\u043e\u044e \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443</p> <pre><code>provider \"name\" {\n    key = value\n}\n\nresource \"type\" \"name\" {\n    key = value\n}\n\nvariable \"name\" {\n    type = \"\"\n    default = \"\"\n}\n</code></pre>"},{"location":"03%20IaC/3.2_Terraform/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>terraform validate</li> <li>terraform console</li> <li>TF_LOG=\"DEBUG\"</li> <li>TF_LOG_FILE</li> </ul>"},{"location":"03%20IaC/3.2_Terraform/#_1","title":"\u041c\u0435\u0442\u0430 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b","text":"<p>\u0423 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430 \u0441\u0432\u043e\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u0438 \u0443 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u0430 \u0441\u0432\u043e\u0439 \u043d\u0430\u0431\u043e\u0440 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432</p> <p>\u041d\u043e \u0435\u0441\u0442\u044c \u043e\u0431\u0449\u0438\u0435 \u043c\u0435\u0442\u0430 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b</p> <ul> <li>provisioner (\u0437\u0430\u043f\u0443\u0441\u043a \u0447\u0435\u0433\u043e \u0442\u043e \u0441\u0440\u0430\u0437\u0443 \u043f\u043e\u0441\u043b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 ansible (\u043b\u0443\u0447\u0448\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c cloud init))</li> <li>depends_on (\u043d\u0435\u044f\u0432\u043d\u044b\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432)</li> <li>count (\u0441\u0447\u0435\u0442\u0447\u0438\u043a \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432)</li> <li>for_each (\u0446\u0438\u043a\u043b\u044b \u0441 \u0440\u0430\u0437\u043d\u044b\u043c\u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u043c\u0438)</li> <li>provider</li> <li>lifecycle (\u0412\u043d\u0443\u0442\u0440\u0438 \u0431\u043b\u043e\u043a\u0430 lifecycle \u0438\u043c\u0435\u044e\u0442\u0441\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b create_before_destroy, prevent_destroy, ignore_changes, \u0438 replace_triggered_by.)</li> </ul>"},{"location":"03%20IaC/3.2_Terraform/#_2","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0412\u041c \u043d\u0430 \u042f\u043d\u0434\u0435\u043a\u0441 \u041e\u0431\u043b\u0430\u043a\u0435","text":"<pre><code>export YC_TOKEN=\"$(yc iam create-token)\"\n</code></pre> <code>main.tf</code> <code>terraform.tfvars</code> <code>variables.tf</code> <pre><code>terraform {\n  required_providers {\n    yandex = {\n      source = \"yandex-cloud/yandex\"\n    }\n  }\n}\n\nprovider \"yandex\" {\n  cloud_id = var.cloud_id\n  folder_id = var.folder_id\n  zone = var.zone\n  # token = var.yc_token\n}\n\nresource \"yandex_compute_instance\" \"vm-1\" {\n  name = \"terraform1\"\n\n  resources {\n    cores = 2\n    memory = 2\n  }\n\n  boot_disk {\n    initialize_params {\n      image_id = var.image_id\n    }\n  }\n\n  network_interface {\n    subnet_id = yandex_vpc_subnet.subnet-1.0.id\n    nat = true # \u0447\u0442\u043e\u0431\u044b \u043c\u0430\u0448\u0438\u043d\u0435 \u0431\u044b\u043b \u0432\u044b\u0434\u0430\u043d \u0432\u043d\u0435\u0448\u043d\u0438\u0439 IP-\u0430\u0434\u0440\u0435\u0441\n  }\n\n  metadata = {\n    ssh-keys = \"ubuntu:${file(\"~/.ssh/id_rsa.pub\")}\"\n  }\n\n  lifecycle {\n    prevent_destroy = true\n    ignore_changes = [boot_disk]\n  }\n\n}\n\nresource \"yandex_vpc_network\" \"network-1\" {\n  name = \"network1\"\n}\n\nresource \"yandex_vpc_subnet\" \"subnet-1\" {\n  count = 3\n  name = \"subnet-${count.index}\"\n  zone = \"ru-central1-a\"\n  network_id = yandex_vpc_network.network-1.id\n  v4_cidr_blocks = [\"192.168.${count.index+10}.0/24\"]\n}\n\noutput \"internal_ip_address_vm_1\" {\n  value = yandex_compute_instance.vm-1.network_interface.0.ip_address\n}\n\noutput \"external_ip_address_vm_1\" {\n  value = yandex_compute_instance.vm-1.network_interface.0.nat_ip_address\n}\n</code></pre> <pre><code>zone = \"ru-central1-a\"\nfolder_id = \"xxxxxx\"\ncloud_id = \"xxxxxx\"\nimage_id = \"fd8tkfhqgbht3sigr37c\"\n</code></pre> <pre><code>variable \"zone\"{\n  type = string\n}\n\nvariable \"cloud_id\"{\n  type = string\n}\n\nvariable \"folder_id\"{\n  type = string\n}\n\nvariable \"image_id\"{\n  type = string\n}\n\n# variable \"yc_token\"{\n  # type = string\n# }\n</code></pre>"},{"location":"03%20IaC/3.2_Terraform/#_3","title":"\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b","text":"<ul> <li>local</li> <li>random</li> <li>null</li> </ul> main.tf<pre><code>resource \"random_password\" \"rnd\" {\n  length = 16\n}\n\noutput \"password\" {\n  value = random_password.rnd.result\n  sensitive = true\n}\n</code></pre>"},{"location":"03%20IaC/3.2_Terraform/#_4","title":"\u0421\u0442\u0440\u043e\u043a\u043e\u0432\u044b\u0435 \u0448\u0430\u0431\u043b\u043e\u043d\u044b","text":"<p>\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u043c\u043e\u0436\u043d\u043e \u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u043d\u0432\u0435\u043d\u0442\u043e\u0440\u0438 \u0434\u043b\u044f \u0430\u043d\u0441\u0438\u0431\u043b\u0430</p> <code>hosts.tpl</code> <code>variables.tf</code> <code>main.tf</code> <pre><code>[lbs]\n%{ for i in range(length(names)) ~}\n%{ if names[i] ==  \"lb\" ~}\n${names[i]} ansible_host=${addrs[i]} ansible_user=${user}\n%{ endif ~}\n%{ endfor ~}\n\n[apps]\n%{ for i in range(length(names)) ~}\n%{ if split(\"-\", names[i])[0] ==  \"app\" ~}\n${names[i]} ansible_host=${addrs[i]} ansible_user=${user}\n%{ endif ~}\n%{ endfor ~}\n</code></pre> <pre><code>variable \"instances\" {\n  type = list(string)\n  default = [\n    \"app-1\",\n    \"app-2\",\n    \"lb\"\n  ]\n}\n\nvariable \"user\" {\n  type    = string\n  default = \"ubuntu\"\n}\n</code></pre> <pre><code>resource \"yandex_compute_instance\" \"vm-app\" {\n  for_each = toset(var.instances)\n  name     = each.key\n\n  allow_stopping_for_update = true\n  scheduling_policy {\n    preemptible = true\n  }\n\n  resources {\n    core_fraction = 5\n    cores         = 2\n    memory        = 4\n  }\n\n  boot_disk {\n    initialize_params {\n      image_id = var.image_id\n    }\n  }\n\n  network_interface {\n    subnet_id = var.subnet_id\n    nat       = true\n  }\n\n  metadata = {\n    ssh-keys = \"ubuntu:${file(\"~/.ssh/id_rsa.pub\")}\"\n  }\n\n  connection {\n    type        = \"ssh\"\n    host        = self.network_interface.0.nat_ip_address\n    user        = \"ubuntu\"\n    agent       = false\n    private_key = file(\"~/.ssh/id_rsa\")\n  }\n}\n\nlocals {\n  names = values(yandex_compute_instance.vm-app)[*].name\n  ips   = values(yandex_compute_instance.vm-app)[*].network_interface.0.nat_ip_address\n}\n\nresource \"local_file\" \"ansible_inventory\" {\n  content = templatefile(\"hosts.tpl\", {\n      names = local.names,\n      addrs = local.ips,\n      user = var.user\n  })\n  filename = \"inventory\"\n}\n</code></pre>"},{"location":"03%20IaC/3.2_Terraform/#_5","title":"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0442\u0435\u0439\u0442\u043e\u043c","text":"<ul> <li>\u0425\u0440\u0430\u043d\u0435\u043d\u0438\u0435 state \u0432 s3</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438 \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043f\u0435\u0440\u0435\u0437\u0430\u0442\u0438\u0440\u0430\u043d\u0438\u044f</li> <li>\u041c\u043e\u0436\u043d\u043e \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c remote state \u043a\u0430\u043a data source</li> </ul>"},{"location":"03%20IaC/3.2_Terraform/#data-sources","title":"Data-sources","text":"<ul> <li>\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0434\u0440\u0443\u0433\u0438\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u0445 \u0432 \u043e\u0431\u043b\u0430\u043a\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0435 \u043d\u0430\u043c\u0438</li> </ul> <code>prod/main.tf</code> <pre><code>data \"yandex_vpc_network\" \"default\" {\n    name = var.network_name\n}\n</code></pre>"},{"location":"03%20IaC/3.2_Terraform/#_6","title":"\u041c\u043e\u0434\u0443\u043b\u0438","text":"<code>modules/app/main.tf</code> <code>prod/main.tf</code> <pre><code>resource \"google_compute_instance\" \"app\" {\n    name = \"example-instance-${count.index + 1}\"\n    machine_type = \"f1-micro\"\n    count = var.instances_count\n    boot_disk {\n        initialize_params {\n            image = var.app_image\n        }\n    }\n    network_interface {\n        network = \"default\"\n        access_config {}\n    }\n}\n</code></pre> <pre><code>module \"app\" {\n    source = \"../modules/app/main.tf\"\n    instances_count = 2\n    app_image = \"myapp-centos-8\"\n}\n</code></pre>"},{"location":"03%20IaC/3.2_Terraform/#depends_on","title":"depends_on","text":"<ul> <li>\u0421\u043f\u0438\u0441\u043e\u043a \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0438 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 \u043e\u0442 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0440\u0435\u0441\u0443\u0440\u0441 \u0438\u043b\u0438 \u043c\u043e\u0434\u0443\u043b\u044c</li> <li>\u0423\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0435\u0441\u043b\u0438 \u043d\u0435\u043b\u044c\u0437\u044f \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0430\u0433\u0440\u0443\u043c\u0435\u043d\u0442 \u0437\u0430\u0432\u0438\u0441\u044f\u0449\u0438\u0439 \u043e\u0442 \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u0430</li> </ul>"},{"location":"03%20IaC/3.2_Terraform/#lifecycle","title":"lifecycle","text":"<ul> <li>create_before_destroy</li> <li>prevent_destroy (\u0437\u0430\u043f\u0440\u0435\u0442\u0438\u0442\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435)</li> <li>ignore_changes</li> </ul>"},{"location":"03%20IaC/3.2_Terraform/#provisioner","title":"provisioner","text":"<ul> <li>\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u0432\u044b\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0437\u0430 \u0440\u0430\u043c\u043a\u0438 \u0430\u043f\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432</li> <li>\u0422\u0430\u043a\u0436\u0435 \u0434\u043b\u044f \u043c\u043d\u043e\u0433\u0438\u0445 \u043e\u0431\u043b\u0430\u043a\u043e\u0432 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442 userdata, metadata</li> </ul> <code>prod/main.tf</code> <pre><code>resource \"aws_instance\" \"web\" {\n# ...\n\n  provisioner \"file\" {\n    source      = \"script.sh\"\n    destination = \"/tmp/script.sh\"\n  }\n\n  provisioner \"remote-exec\" {\n    inline = [\n      \"chmod +x /tmp/script.sh\",\n      \"/tmp/script.sh args\",\n    ]\n  }\n}\n</code></pre>"},{"location":"03%20IaC/3.3_Terragrunt/","title":"3.3 Terragrunt","text":""},{"location":"03%20IaC/3.3_Terragrunt/#_1","title":"\u041f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430","text":"<ul> <li>\u041e\u043d \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u043c\u043d\u043e\u0433\u043e\u0443\u0440\u043e\u0432\u043d\u0435\u0432\u044b\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438</li> <li>\u0420\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0442\u0435\u0440\u0440\u0430\u0444\u043e\u0440\u043c\u0430</li> <li>\u0421\u043b\u0435\u0434\u0443\u0435\u0442 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u0443 DRY (Don't Repeat Yourself)</li> </ul>"},{"location":"03%20IaC/3.3_Terragrunt/#_2","title":"\u041f\u0440\u0438\u043c\u0435\u0440","text":"<code>terraform.hcl</code> <code>yandex/terragrunt.hcl</code> <pre><code>locals {\n  servers = {\n    \"master\" = {\n      memory         = 4\n      cores          = 2\n      zone           = \"ru-central1-a\"\n      boot_disk_size = 20\n      boot_disk_type = \"network-ssd\"\n    }\n    \"slave\" = {\n      memory         = 4\n      cores          = 2\n      zone           = \"ru-central1-a\"\n      boot_disk_size = 20\n      boot_disk_type = \"network-ssd\"\n    }\n  }\n  s3_access_key = get_env(\"AWS_ACCESS_KEY_ID\")\n  s3_secret_key = get_env(\"AWS_SECRET_ACCESS_KEY\")\n  s3_bucket     = \"otus-tfstate\"\n  s3_region     = \"ru-central1\"\n\n  yc_token = get_env(\"YC_TOKEN\")\n  yc_cloud_id  = \"b1ga9aooiodscmmouobm\"\n  yc_folder_dev_id = \"b1g416evp4dl2eef88nt\"\n  yc_folder_test_id = \"b1gms5goflgecu065agg\"\n  yc_zone      = \"ru-central1-a\"\n\n}\n\ngenerate \"provider\" {\n  path      = \"provider_gen.tf\"\n  if_exists = \"overwrite\"\n  contents  = &lt;&lt;EOF\nprovider \"yandex\" {\n  token     = \"${local.yc_token}\"\n  cloud_id  = \"${local.yc_cloud_id}\"\n  folder_id = \"${local.yc_folder_dev_id}\"\n  zone      = \"${local.yc_zone}\"\n}\nprovider \"yandex\" {\n  alias     = \"test\"\n  token     = \"${local.yc_token}\"\n  cloud_id  = \"${local.yc_cloud_id}\"\n  folder_id = \"${local.yc_folder_test_id}\"\n  zone      = \"${local.yc_zone}\"\n}\nEOF\n}\n\ngenerate \"backend\" {\n  path      = \"backend_gen.tf\"\n  if_exists = \"overwrite\"\n  contents  = &lt;&lt;EOF\nterraform {\n  backend \"s3\" {\n    endpoint                    = \"storage.yandexcloud.net\"\n    bucket                      = \"${local.s3_bucket}\"\n    region                      = \"${local.s3_region}\"\n    key                         = \"${path_relative_to_include()}/terraform.tfstate\"\n    access_key                  = \"${local.s3_access_key}\"\n    secret_key                  = \"${local.s3_secret_key}\"\n    dynamodb_endpoint           = \"${local.dynamodb_endpoint}\"\n    dynamodb_table              = \"tfstate\"\n\n    skip_region_validation      = true\n    skip_credentials_validation = true\n  }\n}\nEOF\n}\n</code></pre> <pre><code>terraform {\n  source = \"../../../terraform/modules/yandex\"\n}\n\ninclude \"root\" {\n  path = find_in_parent_folders()\n  expose = true\n}\n\ndependency \"vpc\" {\n  config_path = \"../vpc\"\n  mock_outputs = {\n    vpc_id = \"dummy_vpc\"\n  }\n\n  mock_outputs_allowed_terraform_commands = [\"init\", \"validate\", \"plan\"]\n}\n\ninputs = {\n  servers      = include.root.locals.servers\n  vpc_id       = dependency.vpc.outputs.vpc_id\n  cidr_blocks  = [\"10.51.21.0/24\"]\n  network_name = \"test_network\"\n}\n</code></pre>"},{"location":"03%20IaC/3.4_Ansible/","title":"3.4 Ansible","text":""},{"location":"03%20IaC/3.4_Ansible/#ansible","title":"\u0417\u043d\u0430\u043a\u043e\u043c\u0441\u0442\u0432\u043e \u0441 Ansible","text":""},{"location":"03%20IaC/3.4_Ansible/#ansible_1","title":"\u0421\u0432\u043e\u0439\u0441\u0442\u0432\u0430 Ansible","text":"<ul> <li>\u0414\u0435\u043a\u043b\u0430\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c</li> <li>\u0418\u0434\u0435\u043c\u043f\u043e\u0442\u0435\u043d\u0442\u043d\u043e\u0441\u0442\u044c (\u043f\u0440\u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u043c \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u0434\u0430\u0432\u0430\u0442\u044c \u0442\u043e\u0442 \u0436\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442)</li> <li>\u041d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0430\u0433\u0435\u043d\u0442</li> </ul>"},{"location":"03%20IaC/3.4_Ansible/#ansible_2","title":"\u0417\u0430\u0434\u0430\u0447\u0438 Ansible","text":"<ul> <li>\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0441\u043e\u0444\u0442\u0430</li> <li>\u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u0438</li> <li>\u041c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u0443\u0435\u043c\u043e\u0441\u0442\u044c</li> </ul>"},{"location":"03%20IaC/3.4_Ansible/#4-ansible","title":"4 \u043a\u043e\u043d\u0446\u0435\u043f\u0446\u0438\u0438 Ansible","text":"<ul> <li>Inventory - \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043c\u0430\u0448\u0438\u043d\u0430\u0445 \u0432 \u0441\u0435\u0442\u0438</li> <li>Modules - \u043d\u0435\u043f\u043e\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u0447\u0442\u043e \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f</li> <li>Plugins - \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u044e\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0430\u043c\u043e\u0433\u043e Ansible (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 ssh)</li> <li>Api - \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f</li> </ul>"},{"location":"03%20IaC/3.4_Ansible/#_1","title":"\u041f\u0440\u043e\u0441\u0442\u044b\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430","text":"<p>\u0417\u0430\u043f\u0443\u0441\u043a \u043c\u043e\u0434\u0443\u043b\u044f \u043d\u0430 \u0432\u0441\u0435\u0445 \u0445\u043e\u0441\u0442\u0430\u0445 <pre><code>ansible all -i hosts.ini -m ping\n</code></pre> \u0417\u0430\u043f\u0443\u0441\u043a playbook <pre><code>ansible-playbook playbook.yml -i hosts.ini\n\nansible-playbook playbook.yml -i hosts.ini -K\n</code></pre></p>"},{"location":"03%20IaC/3.4_Ansible/#hostsini","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f hosts.ini","text":"<pre><code># \u0432\u0441\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043d\u0438\u0436\u0435 \u0432\u0445\u043e\u0434\u044f\u0442 \u0432 \u0433\u0440\u0443\u043f\u043f\u0443 all\n192.168.0.12\n192.168.0.14\n\n[debi_servers]\ndebi ansible_host=192.168.0.20 ansible_user=debiuser ansible_ssh_private_key_file=/home/debuser/.ssh/id_ed25519\ndebi2 ansible_host=192.168.0.32 ansible_user=debiuser ansible_ssh_private_key_file=/home/debuser/.ssh/id_ed25519\n\n# \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0439 \u043f\u0440\u0435\u0434 \u043f\u0440\u043e\u0434 \u0441\u0435\u0440\u0432\u0435\u0440 \u0431\u0430\u0437\n[staging_DB]\n192.168.0.1\n192.168.0.2\n\n# \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0439 \u043f\u0440\u0435\u0434 \u043f\u0440\u043e\u0434 \u0441\u0435\u0440\u0432\u0435\u0440 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439\n[staging_APP]\n192.168.0.5\n192.168.0.6\n\n# \u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u043c \u0433\u0440\u0443\u043f\u043f\u044b \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0432 \u043e\u0434\u043d\u0443 \u0431\u043e\u043b\u0435\u0435 \u043a\u0440\u0443\u043f\u043d\u0443\u044e\n[staging_ALL:children]\nstaging_DB\nstaging_APP\n</code></pre>"},{"location":"03%20IaC/3.4_Ansible/#_2","title":"\u0412\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u0437\u0430\u0434\u0430\u043d\u0438\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445","text":"<code>host.ini</code> <code>playbook.yaml</code> <pre><code>192.168.0.1 test=123 testvar=['11', '22']\n\u0438\u043b\u0438\n[centos]\n192.168.0.1\n192.168.0.2\n[centos:vars]\ntest=123\n</code></pre> <pre><code>- name: Basic group\n  hosts: testvm\n  become: true\n  roles:\n    - testrole\n  vars:\n    test_var: test\n    version: 7.0\n\n  tasks:\n  - name: \"Test vars\"\n    ansible.builtin.debug:\n      msg: \"Variable is set to {{ test_var }} {{ ansible_date_time }}\"tasks\n</code></pre> <p>\u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0432\u043d\u0443\u0442\u0440\u0438 \u0440\u043e\u043b\u0438 \u043f\u0435\u0440\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043f\u043b\u0435\u0439\u0431\u0443\u043a\u0430</p> <ul> <li>\u041e\u0434\u043d\u0430 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f \u0432 \u043e\u0434\u043d\u043e\u043c \u043c\u0435\u0441\u0442\u0435</li> <li>\u041d\u0430\u0437\u044b\u0432\u0430\u0435\u043c \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0440\u043e\u043b\u0438/\u043f\u0430\u043a\u0435\u0442\u044b \u0432 \u0438\u043c\u044f</li> <li>\u0418\u0437\u0431\u0435\u0433\u0430\u0435\u043c \u043f\u0440\u043e\u0441\u0442\u044b\u0445 \u0438\u043c\u0451\u043d (server, host)</li> <li>ansible_facts - \u0444\u0430\u043a\u0442\u044b \u043e \u043c\u0430\u0448\u0438\u043d\u0430\u0445, \u043f\u0435\u0440\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e</li> </ul> \u0420\u0430\u0437\u0443\u043c\u043d\u0430\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u0430 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u043e\u0432 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 <p>\u041f\u0440\u0438\u043c\u0435\u0440\u043d\u043e \u0442\u0430\u043a\u0430\u044f \u0436\u0435, \u043a\u0430\u043a\u00a0\u0442\u0443\u0442, \u043d\u043e \u0431\u0435\u0437 WTF'\u043e\u0432.</p> <ol> <li>Vars set on the command line -e foo=set_on_cmd_line</li> <li>Vars set in the vars_files: block in the play</li> <li>Vars set in the vars: block in the play</li> <li>Vars set in host_vars/</li> <li>Vars set in group_vars/</li> <li>Role default vars roles/.../defaults/main.yml</li> </ol>"},{"location":"03%20IaC/3.4_Ansible/#ping","title":"\u041f\u0440\u0438\u043c\u0435\u0440 ping","text":"<p>\u0418\u0437 \u043a\u043e\u043c\u0430\u043d\u0434\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 <pre><code>ansible all -i hosts.ini -m ping\n\nansible all -i hosts.ini --ask-pass -m ping\n</code></pre></p> <p>\u0421 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043f\u043b\u0435\u0439\u0431\u0443\u043a\u0430 playbook.yaml<pre><code>---\n- hosts: \"all\"\n  tasks:\n  - name: \"ping hosts\"\n    ansible.builtin.ping:\n</code></pre></p>"},{"location":"03%20IaC/3.4_Ansible/#lamp","title":"\u041f\u0440\u0438\u043c\u0435\u0440\u044b \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 LAMP \u0441\u0442\u0435\u043a\u0430","text":"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 <code>hosts.ini</code> <code>ansible.cfg</code> <code>playbook.yml</code> <code>roles/nginx/tasks/main.yml</code> <code>roles/mysql/tasks/main.yml</code> <pre><code>\u251c\u2500\u2500 ansible.cfg\n\u251c\u2500\u2500 group_vars\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 all.yml\n\u251c\u2500\u2500 host_vars\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 testhost1\n\u251c\u2500\u2500 hosts.ini\n\u251c\u2500\u2500 playbook.yml\n\u251c\u2500\u2500 requirements.yml\n\u2514\u2500\u2500 roles\n    \u251c\u2500\u2500 mysql\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 tasks\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 main.yml\n    \u251c\u2500\u2500 nginx\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 files\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 html\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 index.html\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 tasks\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 main.yml\n    \u251c\u2500\u2500 php\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 files\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 test-php\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 nginx.conf\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 php-test\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u251c\u2500\u2500 index.php\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u2514\u2500\u2500 test-connection.php\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 tasks\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 main.yml\n    \u2514\u2500\u2500 testrole\n        \u251c\u2500\u2500 defaults\n        \u2502\u00a0\u00a0 \u2514\u2500\u2500 main.yml\n        \u2514\u2500\u2500 tasks\n            \u2514\u2500\u2500 main.yml\n</code></pre> <pre><code>[testvm]\ntesthost1 ansible_host=192.168.0.15 ansible_user=pk ansible_password=password\n\n[testansible]\ntesthost2 ansible_host=192.168.0.188 ansible_user=pk \n</code></pre> <pre><code>[default]\ninventory=./hosts.ini\n</code></pre> <pre><code>---\n- hosts: \"testansible\"\n  become: true\n  roles:\n    - nginx\n    - mysql\n    - php\n\n  tasks:\n    - name: \"Reload nginx\"\n      ansible.builtin.service:\n        name: \"nginx\"\n        state: \"reloaded\"\n</code></pre> <pre><code>---\n- name: \"Install nginx via apt\"\n  ansible.builtin.apt:\n    name: \"nginx\"\n    state: \"latest\"\n    update_cache: true\n\n- name: \"Delete /var/www/html folder\"\n  ansible.builtin.file:\n    path: \"/var/www/html\"\n    state: \"absent\"\n\n- name: \"Copy our landing to /var/www/html folder\"\n  ansible.builtin.copy:\n    src: \"files/html\"\n    dest: \"/var/www\"\n    owner: \"pk\"\n    group: \"pk\"\n    mode: \"0644\"\n</code></pre> <pre><code>---\n- name: \"Install mysql via apt\"\n  ansible.builtin.apt:\n    name: \"mysql-server\"\n    state: \"latest\"\n    update_cache: true\n\n- name: \"Install pymysql via apt\"\n  ansible.builtin.apt:\n    name: \"python3-pymysql\"\n    state: \"latest\"\n    update_cache: true\n\n- name: \"Set up root user\"\n  community.mysql.mysql_user:\n    name: \"root\"\n    password: \"password\"\n    login_user: \"root\"\n    login_password: \"password\"\n    check_implicit_admin: true\n    login_unix_socket: \"/var/run/mysqld/mysqld.sock\"\n\n- name: \"Remove anonymous users\"\n  community.mysql.mysql_user:\n    name: \"\"\n    state: \"absent\"\n    login_user: \"root\"\n    login_password: \"password\"\n\n- name: \"Remove test database\"\n  community.mysql.mysql_db:\n    name: \"test\"\n    state: \"absent\"\n    login_user: \"root\"\n    login_password: \"password\"\n</code></pre>"},{"location":"03%20IaC/3.4_Ansible/#_3","title":"\u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u0430\u044f \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0438 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435","text":"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u043e\u0432 <pre><code>\u2500\u2500 inventories \n\u2502    \u251c\u2500\u2500 AWS \n\u2502    \u2502     \u251c\u2500\u2500 group_vars\n\u2502    \u2502     \u2502    \u251c\u2500\u2500 all \n\u2502    \u2502     \u2502    \u2514\u2500\u2500 web-servers\n\u2502    \u2502     \u251c\u2500\u2500 hosts\n\u2502    \u2502     \u2514\u2500\u2500 host_vars\n\u2502    \u2502           \u251c\u2500\u2500 hostname1\n\u2502    \u2502           \u2514\u2500\u2500 hostname2\n\u2502    \u2514\u2500\u2500 Local\n\u2502          \u251c\u2500\u2500 group_vars\n\u2502          \u251c\u2500\u2500 hosts\n\u2502          \u2514\u2500\u2500 host_vars\n\u251c\u2500\u2500 roles \n\u2502    \u251c\u2500\u2500 nginx\n|    |    \u251c\u2500\u2500  tasks/\n|    |    \u251c\u2500\u2500  handlers/\n|    |    |--- files/\n|    |    |--- templates/\n|    |    |--- vars/\n|    |    |--- defaults/\n|    |    |--- meta/\n\u2502    \u251c\u2500\u2500 grafana\n\u2502    \u2514\u2500\u2500 common\n\u251c\u2500\u2500 ansible.cfg\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 grafana.yml\n\u2514\u2500\u2500 web-server.yml\n</code></pre> <ul> <li>inventories<ul> <li>host, group_vars, host_vars<ul> <li>hosts - \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u0444\u0430\u0439\u043b, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0445\u043e\u0441\u0442\u044b \u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a \u0445\u043e\u0441\u0442\u0430\u043c</li> <li>group_vars - \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u044b \u043a \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u0435 \u0445\u043e\u0441\u0442\u043e\u0432</li> <li>host_vars - \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0445\u043e\u0441\u0442\u0430</li> </ul> </li> </ul> </li> <li>roles - \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0441 \u0440\u043e\u043b\u044f\u043c\u0438, \u043f\u0440\u0438\u043c\u0435\u0440 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0440\u043e\u043b\u0435\u0439 nginx, php<ul> <li>\u0420\u043e\u043b\u044c \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u0433\u0440\u0443\u043f\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0437\u0430\u0434\u0430\u0447 \u0432 \u043e\u0434\u0438\u043d \u043a\u043e\u043d\u0432\u0435\u0439\u0435\u0440</li> <li>tasks/main.yml \u2013 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0441\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u0434\u0430\u0447 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u0440\u043e\u043b\u044c</li> <li>handlers/main.yml \u2013 \u0441\u043f\u0438\u0441\u043a\u0438 \u0437\u0430\u0434\u0430\u0447 (\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432), \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b notify</li> <li>defaults/main.yml \u2013 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0441 \u043e\u0447\u0435\u043d\u044c \u043d\u0438\u0437\u043a\u0438\u043c \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u043e\u043c</li> <li>vars/main.yml \u2013 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0441 \u0431\u043e\u043b\u044c\u0448\u0438\u043c \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u043e\u043c</li> <li>files \u2013 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0441 \u0444\u0430\u0439\u043b\u0430\u043c\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0432 \u0440\u043e\u043b\u0438</li> <li>templates\u00a0\u2013\u00a0\u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0441 \u0448\u0430\u0431\u043b\u043e\u043d\u0430\u043c\u0438\u00a0Jinja2</li> <li>meta/main.yml\u00a0\u2013\u00a0\u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0441 \u043c\u0435\u0442\u0430\u0434\u0430\u0442\u0430\u0439 \u043e\u0431 \u0430\u0432\u0442\u043e\u0440\u0435, \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044f\u0445 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0440\u043e\u043b\u044c</li> </ul> </li> <li>ansible.cfg - \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u044e\u0442\u0441\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e</li> <li>playbook.yml - \u0444\u0430\u0439\u043b \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043c\u044b \u0441\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u043c \u0445\u043e\u0441\u0442\u044b \u0438 \u0440\u043e\u043b\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0443\u0436\u043d\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c</li> </ul>"},{"location":"03%20IaC/3.4_Ansible/#ansible-galaxy","title":"Ansible galaxy","text":"<p>\u041a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u0438 \u0432 Ansible \u2014 \u0444\u043e\u0440\u043c\u0430\u0442 \u0440\u0430\u0441\u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043d\u0430\u0431\u043e\u0440\u0430 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 \u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432. \u0421\u043a\u0430\u0447\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0438 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0432 ~/.ansible/collections</p> <p>requirements.yml<pre><code>roles:\n- src: geerlinguy.postgresql\n\n- name: green.mongodb\n  src: https://github.com/UnderGreen/ansible-role-mongodb\n\ncollections:\n- name: community.postgresql\n</code></pre> \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0440\u043e\u043b\u0435\u0439 \u0438\u0437 \u044d\u0442\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430 <pre><code>ansible-galaxy collection install -r requirements.yml\nansible-galaxy install -r requirements.yml\n</code></pre> \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0432\u043e\u0435\u0439 \u0440\u043e\u043b\u0438 <pre><code>ansible-galaxy role init test_galaxy\n</code></pre> \u0421\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u0439 (\u041a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u044f\u00a0ansible.builtin\u00a0\u0437\u0434\u0435\u0441\u044c \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u0430, \u0442\u0430\u043a \u043a\u0430\u043a \u044d\u0442\u043e \u0435\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u0430\u044f \u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u044f \u043c\u043e\u0434\u0443\u043b\u0435\u0439, \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u0430\u044f \u043f\u0440\u044f\u043c\u043e \u0432 \u044f\u0434\u0440\u043e Ansible) <pre><code>ansible-galaxy collection list\n</code></pre> \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0438 \u0442.\u043f. \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043f\u0430\u0440\u043e\u043b\u044c sudo \u0427\u0442\u043e\u0431\u044b \u0435\u0433\u043e \u043d\u0435 \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u043b\u043e \u043c\u043e\u0436\u043d\u043e \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0432 \u0444\u0430\u0439\u043b\u0435 /etc/sudoers \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c sudo visudo /etc/sudoers</p> <pre><code>`myuser ALL=(ALL) NOPASSWD: ALL`\u00a0for a single user, or\n`%sudo  ALL=(ALL) NOPASSWD: ALL`\u00a0for a group.\n</code></pre> <p>Info</p> <p>Yandex cloud \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0438\u0437 \u043e\u0431\u0440\u0430\u0437\u0430 \u0441\u0440\u0430\u0437\u0443 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u044d\u0442\u0443 \u0441\u0442\u0440\u043e\u043a\u0443 \u0432 /etc/sudoers.d/cloud_init</p>"},{"location":"03%20IaC/3.4_Ansible/#jinja","title":"Jinja \u0448\u0430\u0431\u043b\u043e\u043d\u044b","text":"<code>mongo.conf.j2</code> <code>main.yml</code> <pre><code># network interfaces\nnet:\n port: 27017\n bindIp: {{ mongodb_listen_ip }} # &lt;-- \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445\n# Replication params\n{% if mongodb_replication_replset -%} # &lt;-- \u0423\u0441\u043b\u043e\u0432\u043d\u044b\u0439 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435\n\u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445\nreplication:\n replSetName: {{ mongodb_replication_replset }}\n{% endif %}\n</code></pre> <pre><code>- name: Create mongod.conf file for MongoDB\n template:\n src: templates/mongodb/mongod.conf.j2\n dest: /etc/mongod.conf\n</code></pre>"},{"location":"03%20IaC/3.4_Ansible/#notify-and-handler","title":"Notify and Handler","text":"<ul> <li>Notify \u044d\u0442\u043e \u0442\u0440\u0438\u0433\u0433\u0435\u0440 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u0435\u0441\u043b\u0438 \u0444\u0430\u0439\u043b \u0438\u0437\u043c\u0435\u043d\u0438\u043b\u0441\u044f \u0442\u043e \u043d\u0443\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c nginx)</li> <li>\u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0435\u0441\u043b\u0438 task \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u043e \u0441\u0442\u0430\u0442\u0443\u0441 change (\u0442.\u0435. \u0441\u0434\u0435\u043b\u0430\u043b\u043e \u043a\u0430\u043a\u0438\u0435 \u0442\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f)</li> <li>\u0415\u0441\u043b\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0445 notify \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c\u0441\u044f \u0432\u0441\u0451 \u0440\u0430\u0432\u043d\u043e \u043e\u0434\u0438\u043d handler</li> <li>Handler \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0432 \u043a\u043e\u043d\u0446\u0435 \u043a\u0430\u0436\u0434\u043e\u0433\u043e play\u2019a (Play \u2014 \u0441\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0440\u043e\u043b\u0435\u0439 \u0438 \u0442\u0430\u0441\u043a\u043e\u0432 \u0441 \u0441\u043f\u0438\u0441\u043a\u043e\u043c \u0445\u043e\u0441\u0442\u043e\u0432 )</li> <li>Notify \u043e\u0434\u043d\u043e\u0439 \u0440\u043e\u043b\u0438 \u043c\u043e\u0436\u0435\u0442 \u0432\u044b\u0437\u0432\u0430\u0442\u044c handler \u0438\u0437 \u0434\u0440\u0443\u0433\u043e\u0439</li> <li>\u0415\u0441\u043b\u0438 \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u0442\u043e handler \u0432\u044b\u0437\u0432\u0430\u043d \u043d\u0435 \u0431\u0443\u0434\u0435\u0442</li> </ul> playbook.yml<pre><code>handlers:\n- name: reload mongodb # &lt;-- \u0418\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u043e\u0442\u043e\u043c \u0437\u0430\u0434\u0430\u0435\u043c \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u0438\u0432\u0435 notify\n service:\n name: mongod\n state: reloaded\n\ntasks:\n- name: Create mongod.conf file for MongoDB\n template:\n src: templates/mongodb/mongod.conf\n dest: /etc/mongod.conf\n notify:\n - reload mongodb # &lt;-- \u0412\u044b\u0437\u043e\u0432\u0435\u043c \u044d\u0442\u0443 \u0437\u0430\u0434\u0430\u0447\u0443, \u0435\u0441\u043b\u0438 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u0441\u044f\n</code></pre>"},{"location":"03%20IaC/3.4_Ansible/#dinamic-inventory","title":"Dinamic inventory","text":"<ul> <li>\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441 inventory \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u043c \u0438\u0437 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432</li> <li>\u0420\u0435\u0448\u0430\u0435\u0442 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0443 \u0434\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u043d\u0438\u044f \u0445\u043e\u0441\u0442\u043e\u0432</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0432 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u0441\u0438\u0441\u0442\u0435\u043c</li> </ul> <pre><code>ansible -i $HOME/test_inventroy.py -m ping all\n</code></pre>"},{"location":"03%20IaC/3.4_Ansible/#ansible-vault","title":"Ansible Vault \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u0435","text":"<ul> <li>\u041a\u043e\u043d\u0441\u043e\u043b\u044c\u043d\u0430\u044f \u0443\u0442\u0438\u043b\u0438\u0442\u0430 \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0441\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u043c\u0438</li> <li>\u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c \u0447\u0435\u0440\u0435\u0437 vars_files</li> <li>\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0432 \u043e\u0431\u0449\u0438\u0445 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f\u0445 \u0444\u0430\u0439\u043b\u0430\u0445, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442\u0441\u044f \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f</li> <li>\u0414\u043b\u044f \u0431\u043e\u043b\u0435\u0435 \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u0441\u043b\u0443\u0447\u0430\u0435\u0432 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f Hashicorp Vault</li> </ul> <p><pre><code>vars_files:\n    - secrets.yml\n</code></pre> <pre><code>secret_pass: password\n</code></pre> \u0427\u0442\u043e\u0431\u044b \u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u0442\u044c \u0444\u0430\u0439\u043b <pre><code>ansible-vault --vault-id dev@prompt encrypt --encrypt-vault-id dev secrets.yml\n</code></pre> \u0417\u0430\u043f\u0443\u0441\u043a \u0441 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u043c \u043f\u0430\u0440\u043e\u043b\u044f \u043e\u0442 \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u044f <pre><code>ansible-playbook myplaybook.yml --ask-vault-pass\n</code></pre></p>"},{"location":"03%20IaC/3.4_Ansible/#_4","title":"\u041e\u0442\u043b\u0430\u0434\u043a\u0430","text":"<ul> <li>-vvvv - \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434</li> <li>\u041f\u043e\u0448\u0430\u0433\u043e\u0432\u043e\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 --step</li> <li>Ansible-console</li> <li>debugger (break point \u0432\u043d\u0443\u0442\u0440\u0438 task)<ul> <li>p task.vars</li> <li>p task.args</li> </ul> </li> </ul>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/","title":"4.1 Docker","text":""},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#linux","title":"\u0422\u0438\u043f\u044b \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432 \u0438\u043c\u0435\u043d Linux","text":"<p>\u0412 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u043e\u0439 \u0432\u0435\u0440\u0441\u0438\u0438 \u044f\u0434\u0440\u0430 \u0435\u0441\u0442\u044c \u0441\u0435\u043c\u044c \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432 \u0438\u043c\u0435\u043d:</p> <ul> <li>PID: \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f \u0434\u0435\u0440\u0435\u0432\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432;</li> <li>NET: \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0441\u0442\u0435\u043a\u0430 \u0445\u043e\u0441\u0442\u0430;</li> <li>MNT: \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f \u0442\u043e\u0447\u0435\u043a \u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0445\u043e\u0441\u0442\u0430;</li> <li>UTS: \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f \u0438\u043c\u0435\u043d\u0438 \u0445\u043e\u0441\u0442\u0430;</li> <li>IPC: \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f \u0443\u0442\u0438\u043b\u0438\u0442 \u043c\u0435\u0436\u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043d\u043e\u0433\u043e \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f (\u0441\u0435\u0433\u043c\u0435\u043d\u0442\u044b \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u043c\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438, \u0441\u0435\u043c\u0430\u0444\u043e\u0440\u044b);</li> <li>USER: \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f ID \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b;</li> </ul> <p>\u041a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u043d\u0435 \u0441\u043e\u043f\u0435\u0440\u043d\u0438\u0447\u0430\u0435\u0442 \u0441 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0435\u0439 - \u044d\u0442\u043e \u0434\u0432\u0430 \u0440\u0430\u0437\u043d\u044b\u0445 \u043f\u043e\u0434\u0445\u043e\u0434\u0430.</p> <p>\u0420\u0430\u0437\u043b\u0438\u0447\u0438\u044f \u0412\u041c \u043e\u0442 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430</p> <ul> <li>\u041a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u044f\u0434\u0440\u043e \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b</li> <li>\u0415\u0441\u043b\u0438 \u0443\u044f\u0437\u0432\u0438\u043c\u043e\u0441\u0442\u044c \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u0430 \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435 \u0442\u043e \u043f\u043e \u0441\u0443\u0442\u0438 \u043e\u043d\u0430 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u0430 \u043d\u0430 \u0445\u043e\u0441\u0442\u0435!</li> <li>\u0412 \u0412\u041c \u043c\u043e\u0436\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u043b\u044e\u0431\u0430\u044f \u041e\u0421, \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435 \u2013 \u043d\u0435 \u043b\u044e\u0431\u0430\u044f</li> <li>\u0412\u041c \u0445\u043e\u0440\u043e\u0448\u043e \u0438\u0437\u043e\u043b\u0438\u0440\u0443\u0435\u0442\u0441\u044f, \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 - \u0445\u0443\u0436\u0435</li> </ul>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#docker","title":"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0438 \u0441\u0443\u0449\u043d\u043e\u0441\u0442\u0438 Docker","text":"<p>Docker daemon - c\u0435\u0440\u0432\u0435\u0440\u043d\u0430\u044f \u0447\u0430\u0441\u0442\u044c</p> <ul> <li>\u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0441\u0431\u043e\u0440\u043a\u0443 \u0438 \u0437\u0430\u043f\u0443\u0441\u043a \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432</li> <li>\u0421\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u0440\u0430\u0437\u043e\u0432</li> <li>\u0421\u043e\u0431\u0438\u0440\u0430\u0435\u0442 \u043b\u043e\u0433\u0438</li> <li>\u0421\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u0442 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u044b \u043f\u043e \u0441\u0435\u0442\u0438</li> <li>\u0418 \u0442.\u043f.</li> </ul> <p>Docker CLI - \u043a\u043b\u0438\u0435\u043d\u0441\u043a\u0430\u044f \u0447\u0430\u0441\u0442\u044c (\u043c\u043e\u0436\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e \u0438 \u043f\u043e \u0441\u0435\u0442\u0438)</p> <ul> <li>\u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 Docker daemon</li> </ul> <p>Dockerfile - \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f \u043f\u043e \u0441\u0431\u043e\u0440\u043a\u0435 docker-image</p> <ul> <li>\u041f\u0440\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043a\u0430\u0436\u0434\u0430\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u043d\u043e\u0432\u044b\u0439 \u0441\u043b\u043e\u0439</li> </ul> <p>Docker image - \u043e\u0431\u0440\u0430\u0437, \u043f\u043e \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u043f\u0443\u0449\u0435\u043d \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440</p> <ul> <li>\u0423\u043f\u0430\u043a\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435</li> <li>\u0425\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u0432 registry</li> <li>\u0421\u043e\u0441\u0442\u043e\u0438\u0442 \u0438\u0437 \u0441\u043b\u043e\u0435\u0432</li> </ul> <p>Docker container - \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0439 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f</p> <p>Docker registry - \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439 \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0441\u043e\u0431\u0440\u0430\u043d\u043d\u044b\u0445 docker image</p>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#_1","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b","text":"<pre><code>docker pull mongo\n\ndocker images\n\ndocker run -p 27017:27017 --name mydb mongo\n\ndocker ps\n\ndocker exec -it mydb /bin/bash\n\ndocker stop mydb\n\ndocker rm mydb\n\ndocker rmi mongo\n</code></pre> <p>Docker volumes</p> <pre><code>docker run -v /home/mount/data:/var/lib/mysql/data\n</code></pre>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#docker_1","title":"\u0421\u0435\u0442\u0435\u0432\u043e\u0435 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 Docker \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432","text":"<p>Docker Network Drivers</p> <p>Network Drivers</p> <ul> <li>None (\u041e\u0442\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u0432\u0441\u0435 \u0441\u0435\u0442\u0438)</li> <li>Bridge (\u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u044b \u043c\u043e\u0433\u0443\u0442 \u043e\u0431\u0449\u0430\u0442\u044c\u0441\u044f \u0434\u0440\u0443\u0433 \u0441 \u0434\u0440\u0443\u0433\u043e\u043c)<ul> <li>\u041d\u0435\u043b\u044c\u0437\u044f \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0442\u044c ip \u0430\u0434\u0440\u0435\u0441\u0430</li> <li>\u041d\u0435\u0442 service discovery</li> </ul> </li> <li>Host (\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u0441\u0435\u0442\u0438)</li> <li>Overlay (\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u0435\u0442 \u0441\u0435\u0442\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432 \u043d\u0430 \u0440\u0430\u0437\u043d\u044b\u0445 \u0434\u043e\u043a\u0435\u0440 \u0445\u043e\u0441\u0442\u0430\u0445)</li> <li>Macvlan (\u041f\u0440\u0438\u0441\u0432\u0430\u0438\u0432\u0430\u0435\u0442 \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0443 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0439 MAC-\u0430\u0434\u0440\u0435\u0441)</li> </ul> <p>Bridge </p> <p>Note</p> <p>\u0412\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 DNS \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0434\u043b\u044f default bridge</p> <pre><code>docker network ls\n\ndocker network inspect net_default\n</code></pre>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#docker-compose","title":"Docker compose","text":"<pre><code>docker-compose up\n\ndocker-compose up -d --build\n\ndocker-compose down\n</code></pre>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#docker_2","title":"Docker \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c","text":"<ul> <li>\u041d\u0435 \u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430</li> <li>Capabilietes \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u043d\u0430 \u0432\u044b\u0437\u043e\u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0445 \u0444\u0443\u043d\u043a\u0446\u0438\u0439 \u044f\u0434\u0440\u0430 (\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0442\u0443\u0442)</li> <li>\u0412\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u043c\u043e\u0434\u0443\u043b\u0438 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u041e\u0421 (Apparmor, SELinux)</li> <li>\u041d\u0435 \u0437\u0430\u0431\u044b\u0432\u0430\u0435\u043c \u043f\u0440\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u044b</li> <li>\u041f\u0440\u0438\u0432\u044b\u043a\u0430\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432</li> <li>\u041d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043e\u0431\u0440\u0430\u0437\u044b \u043e\u0442 \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439</li> <li>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 auditctl \u0434\u043b\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0441 docker</li> <li>\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a docker daemon (tcp, unix socket)</li> <li>\u0421\u0442\u0430\u0440\u0430\u0435\u043c\u0441\u044f \u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u0440\u0432\u0438\u0441\u044b \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u043d\u0443\u0436\u043d\u043e\u043c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435</li> </ul> <pre><code>docker scan ubuntu\n\ndocker scan --severity=high ubuntu\n</code></pre> <p>\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0433\u0434\u0435 \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u043b\u043e\u0433 \u0444\u0430\u0439\u043b <pre><code>docker inspect test | grep \"LogPath\"\n</code></pre></p>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#_2","title":"\u0422\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435","text":"<p>\u0427\u0442\u043e \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c?</p> <ul> <li>\u0421\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043e\u0431\u0440\u0430\u0437\u0430<ul> <li>goss - \u0443\u0442\u0438\u043b\u0438\u0442\u0430 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b</li> <li>dgoss - \u043e\u0431\u0435\u0440\u0442\u043a\u0430 \u043d\u0430 bash, \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u044e\u0449\u0430\u044f \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0438\u0437 \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043e\u0431\u0440\u0430\u0437\u0430 \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0449\u0430\u044f \u0442\u0435\u0441\u0442\u044b</li> </ul> </li> <li>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0435 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435</li> <li>Security<ul> <li>\u041a\u0430\u043a \u043d\u0430\u043f\u0438\u0441\u0430\u043d\u043e Dockerfile</li> <li>\u041a\u0430\u043a \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u044b \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u044b</li> <li>\u0427\u0442\u043e \u0432\u043d\u0443\u0442\u0440\u0438 \u043e\u0431\u0440\u0430\u0437\u043e\u0432</li> <li>docker-bench-security</li> </ul> </li> </ul> <code>goss.yaml</code> <pre><code>command:\n mongod --version | head -n1:\n exit-status: 0\n stdout:\n - db version v3.2.17\nprocess:\n mongod:\n running: true\naddr:\n tcp://localhost:27017:\n reachable: true\n timeout: 500\n</code></pre> healtcheck<pre><code>healthcheck:\n test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:5000/healthcheck\"]\n interval: 1m30s\n timeout: 10s\n retries: 3\n</code></pre>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#_3","title":"\u041e\u0440\u043a\u0435\u0441\u0442\u0440\u0430\u0446\u0438\u044f","text":"<p>\u041f\u0440\u043e\u0431\u043b\u0435\u043c\u044b</p> <ul> <li>\u0420\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u043f\u043e\u0442\u0440\u0435\u0431\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0441\u043b\u043e\u0436\u043d\u043e</li> <li>\u0420\u0443\u0447\u043d\u043e\u0435 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439 \u043f\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u043c \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u0441\u043b\u043e\u0436\u043d\u043e\u0439</li> <li>\u0414\u0435\u043f\u043b\u043e\u0439 \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u0440\u0443\u0442\u0438\u043d\u043e\u0439</li> </ul> <p>\u041e\u0440\u043a\u0435\u0441\u0442\u0440\u0430\u0442\u043e\u0440</p> <ul> <li>\u0423\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u043e\u043c \u0445\u043e\u0441\u0442\u043e\u0432</li> <li>\u041f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447 </li> <li>\u0413\u0438\u0431\u043a\u043e\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0431\u043e\u043b\u044c\u0448\u0438\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e\u043c \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432</li> <li>\u041d\u0443\u0436\u0435\u043d \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043d\u0430\u0434 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435\u043c \u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043c\u0438</li> </ul> <p>Kubernetes. \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430</p> <ul> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 YAML \u0438 JSON \u0444\u043e\u0440\u043c\u0430\u0442\u043e\u0432</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u043c\u043e\u0449\u043d\u043e\u0433\u043e \u0448\u0430\u0431\u043b\u043e\u043d\u0438\u0437\u0430\u0442\u043e\u0440\u0430 HELM</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430 CNI-\u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 rolling update, blue-green \u0438 canary \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439, \u0441 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435\u043c \u0438\u0441\u0442\u043e\u0440\u0438\u0438</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u0430\u0432\u0442\u043e\u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, HPA, VPA</li> <li>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0441\u0438\u0441\u0442\u0435\u043c \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430, \u0442\u0440\u0430\u0441\u0441\u0438\u0440\u043e\u0432\u043a\u0438, \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u043f\u0440\u043e\u0447.</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 service-discovering \u0437\u0430 \u0441\u0447\u0435\u0442 \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u043e\u0433\u043e DNS-\u0441\u0435\u0440\u0432\u0438\u0441\u0430</li> <li>\u0412\u044b\u0441\u043e\u043a\u0438\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438, \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u043d\u044b\u0439 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u043c\u0438 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438 \u0441 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c\u044e \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f</li> </ul>"},{"location":"04%20DevOps%20and%20CICD/4.2_CICD/","title":"4.2 \u0422\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u044f \u043d\u0435\u043f\u0440\u0435\u0440\u044b\u0432\u043d\u043e\u0439 \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u041f\u041e","text":""},{"location":"04%20DevOps%20and%20CICD/4.2_CICD/#cicd","title":"\u041f\u0440\u043e\u0446\u0435\u0441\u0441\u044b CI/CD","text":"<ul> <li>\u0421\u0431\u043e\u0440\u043a\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f</li> <li>\u041a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430</li> <li>\u041f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442\u043e\u0432 \u0441\u0431\u043e\u0440\u043a\u0438 \u0432 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435</li> <li>\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f / \u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0431\u043e\u043b\u0435\u0435 \u043d\u0435 \u043d\u0443\u0436\u043d\u043e\u0433\u043e \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f</li> <li>\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u0434\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f, \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u043e\u0433\u043e \u0432 \u0432\u0438\u0434\u0435 \u043a\u043e\u0434\u0430</li> <li>\u0412\u044b\u043a\u0430\u0442\u043a\u0430 \u043d\u043e\u0432\u043e\u0439 \u0432\u0435\u0440\u0441\u0438\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f / \u041e\u0442\u043a\u0430\u0442 \u0434\u043e \u043f\u0440\u043e\u0448\u043b\u043e\u0439 \u0432\u0435\u0440\u0441\u0438\u0438</li> <li>\u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u043a \u0431\u0430\u0437\u0430\u043c \u0434\u0430\u043d\u043d\u044b\u0445 \u044d\u0442\u043e\u0433\u043e \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f</li> </ul>"},{"location":"04%20DevOps%20and%20CICD/4.2_CICD/#cicd_1","title":"\u041f\u0440\u0438\u043d\u0446\u0438\u043f\u044b CICD","text":"<ul> <li>\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u043c\u044b\u0439 \u0438 \u043d\u0430\u0434\u0435\u0436\u043d\u044b\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u041f\u041e</li> <li>\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0441\u0435, \u0447\u0442\u043e \u043c\u043e\u0436\u043d\u043e. \u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0441 \u043a\u043d\u043e\u043f\u043a\u0430\u043c\u0438</li> <li>\u0425\u0440\u0430\u043d\u0438\u0442\u044c \u0432\u0441\u0435 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044f \u0432\u0435\u0440\u0441\u0438\u0439</li> <li>\u041f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u0440\u0430\u043d\u043d\u044e\u044e \u043e\u0431\u0440\u0430\u0442\u043d\u0443\u044e \u0441\u0432\u044f\u0437\u044c</li> <li>\u0421\u043e\u0432\u0435\u0440\u0448\u0435\u043d\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u044f</li> <li>\u0412\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430</li> <li>\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e, \u0437\u043d\u0430\u0447\u0438\u0442 \u0437\u0430\u0440\u0435\u043b\u0438\u0437\u0438\u043b\u043e\u0441\u044c</li> <li>\u0420\u0435\u043b\u0438\u0437\u0438\u043c \u0438\u043c\u0435\u043d\u043d\u043e \u0442\u043e, \u0447\u0442\u043e \u0431\u044b\u043b\u043e \u043f\u0440\u043e\u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043e</li> <li>\u041a\u0430\u0436\u0434\u044b\u0439 \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u041f\u041e</li> </ul>"},{"location":"04%20DevOps%20and%20CICD/4.2_CICD/#_1","title":"\u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438","text":"<ul> <li>Mean Lead Time \u2013 \u0432\u0440\u0435\u043c\u044f \u043d\u0430 \u0431\u0438\u043b\u0434, \u0442\u0435\u0441\u0442\u044b, \u0434\u0435\u043f\u043b\u043e\u0439</li> <li>Daily Change Rate \u2013 \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0445 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u0432 \u0434\u0435\u043d\u044c</li> <li>Mean Time To Environment \u2013 \u0432\u0440\u0435\u043c\u044f \u043d\u0430 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0443 \u043d\u043e\u0432\u043e\u0433\u043e \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f</li> <li>Mean Time To Detect \u2013 \u043a\u0430\u043a \u0434\u043e\u043b\u0433\u043e \u0431\u0430\u0433 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043d\u0435\u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u043c</li> </ul>"},{"location":"04%20DevOps%20and%20CICD/4.2_CICD/#_2","title":"\u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430","text":"<ul> <li>Build Failure Rate \u2013 \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u043d\u0435\u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0445 \u0441\u0431\u043e\u0440\u043e\u043a</li> <li>Deployment Failure Rate \u2013 \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u043d\u0435\u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0445 \u0432\u044b\u043a\u0430\u0442\u043e\u043a</li> <li>Infra-Related Failure Rate \u2013 \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u043d\u0435\u0443\u0441\u043f\u0435\u0449\u043d\u044b\u0445 \u0432\u044b\u043a\u0430\u0442\u043e\u043a / \u0441\u0431\u043e\u0440\u043e\u043a \u0438\u0437 -\u0437\u0430 \u043f\u0440\u043e\u0431\u043b\u0435\u043c \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b</li> <li>Automated Detection Rate \u2013 \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u043f\u0440\u043e\u0431\u043b\u0435\u043c, \u0432\u044b\u044f\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043d\u0430 \u044d\u0442\u0430\u043f\u0430\u0445 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f</li> </ul>"},{"location":"05%20Kubernetes/5.1_Kubernetes/","title":"5.1 \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b k8s","text":""},{"location":"05%20Kubernetes/5.1_Kubernetes/#k8s-","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b k8s-\u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430:","text":"<ul> <li>etcd \u2013 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438</li> <li>api-server \u2013 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 API</li> <li>controller-manager \u2013 \u0437\u0430\u043f\u0443\u0441\u043a \u043d\u0430\u0431\u043e\u0440\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u043e\u0432 \u0438 \u0441\u0431\u043e\u0440\u043a\u0430 \u043c\u0443\u0441\u043e\u0440\u0430</li> <li>scheduler \u2013 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u043e\u0432 \u043d\u0430 \u043d\u043e\u0434\u044b \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430 \u0444\u0430\u043a\u0442\u043e\u0440\u043e\u0432</li> </ul> <p>Etcd \u2013 key/value \u0431\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430</p> <ul> <li>\u0420\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043f\u043e \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0443 raft (\u043e\u043d \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u043d\u0430\u0434\u0435\u0436\u043d\u043e\u0441\u0442\u044c \u0437\u0430 \u0441\u0447\u0435\u0442 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438 \u043a\u0432\u043e\u0440\u0443\u043c\u0430)</li> <li>\u0415\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u0430\u044f \u0431\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 k8s</li> <li>\u0415\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 stateful-\u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 (\u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0445\u0440\u0430\u043d\u0438\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435)</li> <li>\u041d\u0430 \u043a\u0430\u0436\u0434\u0443\u044e master-\u043d\u043e\u0434\u0443 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u043e \u043d\u043e\u0434\u0435 etcd</li> </ul> <p>raft \u2013 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0441\u0435\u043d\u0441\u0443\u0441\u0430 \u0432 \u0441\u0435\u0442\u0438 \u043d\u0430\u0434\u0435\u0436\u043d\u044b\u0445 \u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0439 \u041a\u0430\u0436\u0434\u0430\u044f \u043d\u043e\u0434\u0430 \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c\u0441\u044f \u0432 \u043e\u0434\u043d\u043e\u043c \u0438\u0437 3-\u0445 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0439:</p> <ul> <li>\u041b\u0438\u0434\u0435\u0440 (Leader)</li> <li>\u041a\u0430\u043d\u0434\u0438\u0434\u0430\u0442 (Candidate)</li> <li>\u0412\u0435\u0434\u043e\u043c\u044b\u0439 (Follower)</li> </ul> <p>Api-server \u2013 \u0446\u0435\u043d\u0442\u0440\u0430\u043b\u044c\u043d\u044b\u0439, \u0433\u043b\u0430\u0432\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 k8s</p> <ul> <li>Stateless (\u0432 \u043e\u0442\u043b\u0438\u0447\u0438\u0438 \u043e\u0442 etcd)</li> <li>\u0412\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 kubectl (\u043d\u043e \u043c\u043e\u0436\u043d\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0438 \u043f\u0440\u043e\u0441\u0442\u043e curl\u2019\u043e\u043c)</li> <li>\u0415\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0431\u0449\u0430\u0435\u0442\u0441\u044f \u0441 etcd</li> <li>\u0420\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043f\u043e REST API</li> <li>\u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u0438 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044e (\u0440\u0430\u0437\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u0430\u0432 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0434\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u043c\u0443 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)</li> </ul> <p>Controller-manager \u2013 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u043d\u0430\u0431\u043e\u0440\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u043e\u0432</p> <p>\u041a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u044b \u043f\u0440\u0438\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u0430 \u0435\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0439 \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u0438</p> <p>\u0412 \u0441\u043e\u0441\u0442\u0430\u0432 controller-manager\u2019\u0430 \u0432\u0445\u043e\u0434\u044f\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u044b:</p> <ul> <li>node controller - \u0434\u0435\u0440\u0436\u0438\u0442 \u0441\u0432\u044f\u0437\u044c \u0441 \u043d\u043e\u0434\u0430\u043c\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u0435\u0441\u043b\u0438 \u043d\u043e\u0434\u0430 \u043d\u0435 \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442, \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0438\u0442 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043d\u0430 \u0434\u0440\u0443\u0433\u0438\u0435 \u043d\u043e\u0434\u0443<ul> <li>kubelet \u043e\u0431\u0449\u0430\u0435\u0442\u0441\u044f \u0441 api server, \u043e\u043d \u0441 controller manager'\u043e\u043c, \u0430 \u0443\u0436\u0435 \u043e\u043d \u043e\u0431\u0449\u0430\u0435\u0442\u0441\u044f \u0441 node controller'\u043e\u043c</li> </ul> </li> <li>replicaset controller - \u0441\u043c\u043e\u0442\u0440\u0438\u0442 \u0432 api-server \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u0432\u0438\u0434\u0438\u0442 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0435 replicaset\u2019\u044b, \u0440\u0435\u0430\u043b\u0438\u0437\u0443\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u0443 \u0438\u0445 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f</li> <li>endpoints controller - \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u043e\u0432 \u0434\u043b\u044f \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 (\u0441\u0432\u044f\u0437\u044c \u043c\u0435\u0436\u0434\u0443 \u043f\u043e\u0434\u043e\u043c \u0438 \u0435\u0433\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u043c)</li> <li>account controller - \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u0443\u0447\u0435\u0442\u043d\u044b\u0445 \u0437\u0430\u043f\u0438\u0441\u0435\u0439</li> <li>token controller - \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0442\u043e\u043a\u0435\u043d\u043e\u0432 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 API</li> </ul> <p>Info</p> <p>\u041e\u0431\u044b\u0447\u043d\u043e, \u043d\u0430 \u043a\u0430\u0436\u0434\u0443\u044e \u043c\u0430\u0441\u0442\u0435\u0440-\u043d\u043e\u0434\u0443 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u044e\u0442 \u043f\u043e \u043e\u0434\u043d\u043e\u043c\u0443 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0443 controller-manager. \u041d\u043e, \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e \u043c\u043e\u0436\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0434\u0438\u043d \u043b\u0438\u0434\u0438\u0440\u0443\u044e\u0449\u0438\u0439 controller-manager, \u0438 \u0432\u044b\u0431\u043e\u0440 \u043b\u0438\u0434\u0435\u0440\u0430 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u043f\u043e \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0443 lease \u0421\u0443\u0442\u044c \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430 lease \u043e\u0447\u0435\u043d\u044c \u043f\u0440\u043e\u0441\u0442\u0430 \u2013 \u0442\u043e\u0442, \u043a\u0442\u043e \u043f\u0435\u0440\u0432\u044b\u043c \u0443\u0441\u043f\u0435\u0435\u0442 \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0441\u0435\u0431\u044f \u043b\u0438\u0434\u0435\u0440\u043e\u043c \u0432 api-server \u0442\u043e\u0442 \u0438 \u043b\u0438\u0434\u0435\u0440 \u0415\u0441\u043b\u0438 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043b\u0438\u0434\u0435\u0440 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u0432\u0435\u0447\u0430\u0442\u044c \u043d\u0443\u0436\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f, \u0431\u043e\u0440\u044c\u0431\u0430 \u0437\u0430 \u043b\u0438\u0434\u0435\u0440\u0441\u0442\u0432\u043e \u0432\u043e\u0437\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u043f\u043e \u0442\u043e\u043c\u0443 \u0436\u0435 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u0443</p> <p>Scheduler \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u0442 \u043f\u043e\u0434\u044b \u043d\u0430 \u043d\u043e\u0434\u044b \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430 \u0444\u0430\u043a\u0442\u043e\u0440\u043e\u0432</p> <p>controller-manager \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u0442 \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u044b \u043f\u043e\u0434\u043e\u0432, \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 api-server, \u0430 scheduler \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u0442 \u0438\u0445 \u043d\u0430 \u043d\u043e\u0434\u044b, \u043d\u043e \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u0442 \u0432\u0430\u0436\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b:</p> <ul> <li>QoS (quality of service)</li> <li>Affinity \u0438 Anti-affinity</li> <li>Requests \u0438 Limits</li> <li>Priority Class (preemption)</li> </ul>"},{"location":"05%20Kubernetes/5.1_Kubernetes/#k8s","title":"\u0412\u0441\u043f\u043e\u043c\u043e\u0433\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b k8s","text":"<p>\u041f\u043e\u043c\u0438\u043c\u043e \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432, \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043d\u0430 \u043c\u0430\u0441\u0442\u0435\u0440-\u043d\u043e\u0434\u0430\u0445, \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u043d\u0430 \u0432\u0441\u0435\u0445 \u043d\u043e\u0434\u0430\u0445 (\u043c\u0430\u0441\u0442\u0435\u0440\u044b \u0438 \u0432\u043e\u0440\u043a\u0435\u0440\u044b):</p> <p>kubelet \u2013 \u0430\u0433\u0435\u043d\u0442, \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0439 \u043d\u0430 \u0443\u0437\u043b\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430</p> <ul> <li>\u0420\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043d\u0430 \u043a\u0430\u0436\u0434\u043e\u0439 \u043d\u043e\u0434\u0435 (\u0438 \u043c\u0430\u0441\u0442\u0435\u0440\u044b \u0438 \u0432\u043e\u0440\u043a\u0435\u0440\u044b)</li> <li>\u041d\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0432 \u0434\u043e\u043a\u0435\u0440\u0435, \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043a\u0430\u043a \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043d\u0430 \u0445\u043e\u0441\u0442\u0435 (systemctl status kubelet)</li> <li>\u041e\u0442\u0434\u0430\u0435\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u044b docker daemon \u0447\u0435\u0440\u0435\u0437 docker api (docker run, \u043d\u0430\u043f\u0440.)</li> <li>\u0424\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0440\u0435\u0430\u043b\u0438\u0437\u0443\u0435\u0442 \u0437\u0430\u043f\u0443\u0441\u043a \u043f\u043e\u0434\u043e\u0432 \u043d\u0430 \u0443\u0437\u043b\u0435</li> <li>\u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 liveness probe, readiness probe, startup probe</li> </ul> <p>Startup probe \u2013 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438, \u0447\u0442\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435 \u0431\u044b\u043b\u043e \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043e. \u0415\u0441\u043b\u0438 \u043f\u0440\u043e\u0431\u0430 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u0430, \u0442\u043e liveness \u0438 readiness \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0431\u043b\u043e\u043a\u0438\u0440\u0443\u0435\u0442\u0441\u044f, \u0434\u043e \u0442\u043e\u0433\u043e \u043a\u0430\u043a \u043f\u0440\u043e\u0431\u0430 \u043f\u0440\u043e\u0439\u0434\u0435\u0442 \u0443\u0441\u043f\u0435\u0448\u043d\u043e (\u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0432 \u0441\u0442\u0430\u0442\u0443\u0441e running)</p> <p>Readiness probe \u2013 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438, \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u043b\u0438 \u043c\u043e\u0434\u0443\u043b\u044c \u0432 \u0442\u0435\u0447\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u0433\u043e \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u0446\u0438\u043a\u043b\u0430. \u0412 \u043e\u0442\u043b\u0438\u0447\u0438\u0435 \u043e\u0442 liveness probe, \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0441\u0431\u043e\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0440\u0430\u0444\u0438\u043a \u043a \u043c\u043e\u0434\u0443\u043b\u044e, \u043d\u043e \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043d\u0435 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442  (\u0441\u0430\u043c\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0433\u043e\u0442\u043e\u0432\u043e \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f)</p> <p>Liveness probe \u2013 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f, \u043a\u043e\u0433\u0434\u0430 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c  (\u043a\u043e\u0433\u0434\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0443\u0436\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442, \u0440\u0430\u0437 \u0432 \u043a\u0430\u043a\u043e\u0435 \u0442\u043e \u0432\u0440\u0435\u043c\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0435\u0433\u043e)</p> <p>kube-proxy - \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u043f\u0440\u043e\u043a\u0441\u0438, \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0439 \u043d\u0430 \u043a\u0430\u0436\u0434\u043e\u043c \u0443\u0437\u043b\u0435 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435</p> <ul> <li>\u0412\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u0435\u0442 \u0441 api-server</li> <li>\u0423\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u0432\u0441\u0435\u0445 \u043d\u043e\u0434\u0430\u0445</li> <li>\u0423\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u0435\u0442\u0435\u0432\u044b\u043c\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u0430\u043c\u0438 \u043d\u0430 \u043d\u043e\u0434\u0430\u0445</li> <li>\u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435</li> </ul> <p>\u0412\u0442\u043e\u0440\u043e\u0441\u0442\u0435\u043f\u0435\u043d\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b, \u0441 \u043a\u043e\u0442\u043e\u0440\u044b\u043c\u0438 \u0432\u044b \u0441\u0442\u043e\u043b\u043a\u043d\u0435\u0442\u0435\u0441\u044c \u043f\u0440\u0438 \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u043e\u043c k8s:</p> <ul> <li>cri (\u0434\u0432\u0438\u0436\u043e\u043a \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0438\u0437\u0430\u0446\u0438\u0438)</li> <li>cni (\u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u043f\u043b\u0430\u0433\u0438\u043d\u044b)</li> <li>dns (k8s-\u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u044b\u0435 dns-\u0441\u0435\u0440\u0432\u0435\u0440\u044b)</li> <li>ccm (controller-manager \u0434\u043b\u044f \u043e\u0431\u043b\u0430\u0447\u043d\u044b\u0445 \u0440\u0435\u0448\u0435\u043d\u0438\u0439)</li> </ul>"},{"location":"05%20Kubernetes/5.2_Kubernetes/","title":"5.2 \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 K8s","text":""},{"location":"05%20Kubernetes/5.2_Kubernetes/#deployment-replicaset-pod","title":"Deployment, ReplicaSet, Pod","text":"<p>\u041a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f (deployment controller) \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b \u0434\u0435\u043a\u043b\u0430\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0447\u0438\u0445 \u043d\u0430\u0433\u0440\u0443\u0437\u043e\u043a</p> <p>\u0412 \u0441\u0432\u043e\u0435\u0439 \u0440\u0430\u0431\u043e\u0442\u0435 Deployment \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u043a\u043e\u043d\u0446\u0435\u043f\u0446\u0438\u044e \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0441\u0435\u0442\u043e\u0432 (ReplicaSet), \u0437\u0430\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044f replicaset controller</p> <p></p> <p>\u0424\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b \u0434\u0435\u043f\u043b\u043e\u0439\u043c\u0435\u043d\u0442\u0430 \u0442\u0435\u0441\u043d\u043e \u0441\u0432\u044f\u0437\u0430\u043d \u0441 \u0441\u0443\u0449\u043d\u043e\u0441\u0442\u044c\u044e replicaset</p> <p>\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430 ReplicaSet - \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0430\u043d\u0438\u0435 \u0441\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u043e\u0433\u043e \u043d\u0430\u0431\u043e\u0440\u0430 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0439 \u043f\u043e\u0434\u043e\u0432, \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0445 \u0432 \u043e\u0434\u0438\u043d \u043c\u043e\u043c\u0435\u043d\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 ReplicaSet \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u0443\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0438\u0434\u0435\u043d\u0442\u0438\u0447\u043d\u044b\u0445 \u043f\u043e\u0434\u043e\u0432</p> <p>\u0417\u0430 \u0441\u0447\u0435\u0442 \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0430\u043d\u0438\u0101 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0438\u0434\u0435\u043d\u0442\u0438\u0447\u043d\u044b\u0445 \u043f\u043e\u0434\u043e\u0432, ReplicaSet \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435:</p> <ul> <li>\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 (rolling update)</li> <li>\u041f\u0440\u043e\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0442\u0435\u043a\u0443\u0449\u0435\u043c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 (rollout status)</li> <li>\u041e\u0442\u043a\u0430\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f (rollout undo)</li> <li>\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0440\u0435\u0432\u0438\u0437\u0438\u0439 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 (rollout history)</li> <li>\u041e\u0442\u043a\u0430\u0442 (\u0440\u043e\u043b\u043b\u0431\u0443\u043a) \u0434\u043e \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u0440\u0435\u0432\u0438\u0437\u0438\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f (rollout undo to revision)</li> <li>\u0421\u043a\u0430\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u0430\u0431\u043e\u0447\u0438\u0445 \u043d\u0430\u0433\u0440\u0443\u0437\u043e\u043a (scaling)</li> </ul> <pre><code>kubectl create ns mobsf\n\nkubectl create deployment mobsf --image=opensecurity/mobile-security-framework-mobsf:v3.1.1 -n mobsf\n\nkubectl expose deployment mobsf --port=8000 --type=NodePort -n mobsf\n\nkubectl get svc -n mobsf\n\nkubectl get pods -n mobsf\n\nkubectl desctibe replicaset -n mobsf\n\n# \u0421\u0442\u0430\u0442\u0443\u0441 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f\nkubectl rollout status deployment/mobsf -n mobsf\n\n# \u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435\nkubectl rollout undo deployment/mobsf -n mobsf\n\n# \u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0438\u0441\u0442\u043e\u0440\u0438\u0438\nkubectl rollout history deployment/mobsf -n mobsf\n\n# \u041e\u0442\u043a\u0430\u0442 \u043d\u0430 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u0443\u044e \u0432\u0435\u0440\u0441\u0438\u044e\nkubectl rollout undo deployment/mobsf -n mobsf --to-revision=3\n\nkubectl scale deployment/mobsf --replicas=3 -n mobsf\n</code></pre>"},{"location":"05%20Kubernetes/5.2_Kubernetes/#kubernetes","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u0432 Kubernetes","text":"<p>PersistentVolume (PV) - \u043d\u0435\u043f\u043e\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 (\u0440\u0430\u0437\u0434\u0435\u043b \u043d\u0430 \u0436\u0435\u0441\u0442\u043a\u043e\u043c \u0434\u0438\u0441\u043a\u0435)</p> <p>\u0421 \u0442\u043e\u0447\u043a\u0438 \u0437\u0440\u0435\u043d\u0438\u044f \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, Persistent Volume \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0442\u0430\u043a\u0438\u043c \u0436\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u043c, \u043a\u0430\u043a, \u043a \u043f\u0440\u0438\u043c\u0435\u0440\u0443, Worker Node</p> <p>\u0420\u0430\u0431\u043e\u0442\u0430\u0442\u0430\u0442\u044c \u0441 PV (\u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c/\u0447\u0438\u0442\u0430\u0442\u044c/\u0438\u0437\u043c\u0435\u043d\u044f\u0442\u044c/\u0443\u0434\u0430\u043b\u044f\u0442\u044c) \u043c\u043e\u0436\u043d\u043e \u0447\u0435\u0440\u0435\u0437 \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442</p> <p>PersistentVolumeClaim (PVC) - \u044d\u0442\u043e \u0437\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0435 PersistentVolume (PV)</p> <p>\u0421 \u043f\u043e\u043c\u043e\u0449\u044c\u044e PVC \u043c\u043e\u0436\u043d\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435\u043c \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043f\u0443\u0442\u0435\u043c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u043f\u043e\u0434\u0430\u043c \u0434\u0438\u0441\u043a\u043e\u0432 \u0441 \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0430\u043c\u0438</p> <p>PVC \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u043a \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0435\u043c\u0443 PV, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0441\u043e\u0437\u0434\u0430\u043d \u0438\u0437 \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u0430, \u0438\u043b\u0438 \u0441\u043e\u0437\u0434\u0430\u043d \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u043e\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u043e\u043c \u043f\u0440\u043e\u0432\u0438\u0436\u0438\u043d\u0438\u043d\u0433\u0430</p> <p>\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 PVC \u0440\u0430\u0441\u043f\u043e\u043b\u0430\u0433\u0430\u0435\u0442\u0441\u044f \u0432 \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u0435 \u0434\u0435\u043f\u043b\u043e\u0439\u043c\u0435\u043d\u0442\u0430 \u0432\u0430\u0448\u0435\u0439 \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438</p> <ul> <li>Deployment \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0437\u0430\u043f\u0438\u0441\u044c \u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f PVC</li> <li>PVC \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f \u043a \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0443 (PV)</li> <li>PV \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u0438\u043b\u0438 \u043f\u0440\u043e\u0432\u0438\u0436\u0438\u043d\u0438\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435</li> </ul>"},{"location":"05%20Kubernetes/5.3_Kubernetes/","title":"5.3 Services and Ingress","text":"<ul> <li>\u0421\u0435\u0440\u0432\u0438\u0441 \u044d\u0442\u043e \u043e\u0431\u044a\u0435\u043a\u0442 kubernetes, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0435\u0434\u0438\u043d\u0443\u044e \u0442\u043e\u0447\u043a\u0443 \u0432\u0445\u043e\u0434\u0430 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043f\u043e\u0434\u0430\u043c \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u0445 \u043e\u0434\u043d\u043e \u0438 \u0442\u043e\u0436\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435</li> <li>\u0421\u0435\u0440\u0432\u0438\u0441 (Service) \u0432 Kubernetes \u2014 \u044d\u0442\u043e \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0439 \u043e\u0431\u044a\u0435\u043a\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043d\u0430\u0431\u043e\u0440 \u043f\u043e\u0434\u043e\u0432 \u0438 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0443 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043d\u0438\u043c.</li> <li>\u0421\u0435\u0440\u0432\u0438\u0441\u044b \u0441\u043e\u0437\u0434\u0430\u044e\u0442 \u0441\u043b\u0430\u0431\u0443\u044e \u0441\u0432\u044f\u0437\u044c \u043c\u0435\u0436\u0434\u0443 \u043f\u043e\u0434\u0430\u043c\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u0442 \u043d\u0438\u0445 \u0437\u0430\u0432\u0438\u0441\u044f\u0442. </li> </ul> <p>Note</p> <p>\u041f\u043e\u0434\u044b \u2013 \u044d\u0442\u043e \u043d\u0435 \u043f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u044b\u0435 \u0441\u0443\u0449\u043d\u043e\u0441\u0442\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430. \u0412 \u043b\u044e\u0431\u043e\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u043f\u043e\u0434 \u0438\u043b\u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043d\u0435 \u043d\u0443\u0436\u043d\u044b\u0439. \u041f\u0440\u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0438 \u043f\u043e\u0434\u0430 \u043c\u0435\u0436\u0434\u0443 \u043d\u043e\u0434\u0430\u043c\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u043f\u043e\u0434 \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043d\u043e\u0432\u043e\u0439 \u043d\u043e\u0434\u0435 \u0438 \u0443\u0434\u0430\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430 \u0441\u0442\u0430\u0440\u043e\u0439. \u041f\u0440\u0438 \u044d\u0442\u043e\u043c \u0443 \u043f\u043e\u0434\u0430 \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f IP \u0430\u0434\u0440\u0435\u0441. \u0418\u043c\u0435\u043d\u043d\u043e \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043d\u0435 \u0441\u0442\u043e\u0438\u0442 \u043e\u0431\u0440\u0430\u0449\u0430\u0442\u044c\u0441\u044f \u043a \u043f\u043e\u0434\u0443 \u043f\u043e ip \u0430\u0434\u0440\u0435\u0441\u0443.</p> <pre><code>kubectl create -f svc.yaml\n\nkubectl get services\n\nkubectl get svc\n\n# \u041f\u0440\u0438\u043c\u0435\u0440: \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c curl \u0432\u043d\u0443\u0442\u0440\u0438 \u043f\u043e\u0434\u0430 \u043d\u0430 \u0441\u0435\u0440\u0432\u0438\u0441\n# -- \u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442 \u0434\u043b\u044f kubectl \u043e\u0431 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u0438 \u0432\u0432\u043e\u0434\u0430 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432\n# \u0435\u0441\u043b\u0438 \u0431\u044b \u043c\u044b \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0438 -- \u0442\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 -s \u043f\u043e\u043f\u044b\u0442\u0430\u043b\u0441\u044f \u0431\u044b \u043e\u0442\u043d\u0435\u0441\u0442\u0438 \u043a kubectl\nkubectl exec kubia-9g -- curl -s http://10.105.77.0\n</code></pre> <p>Info</p> <p>ping \u0434\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u0430 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u043d\u0435 \u0431\u0443\u0434\u0435\u0442, \u0442.\u043a. service \u0430\u0441\u043e\u0446\u0438\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0441 ip \u0438 port</p>"},{"location":"05%20Kubernetes/5.3_Kubernetes/#4","title":"4 \u0442\u0438\u043f\u0430 \u0441\u0435\u0440\u0432\u0438\u0441\u0430","text":"<ul> <li>ClusterIP (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e) \u2014 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0441\u0435\u0440\u0432\u0438\u0441\u0443 \u043f\u043e \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u043c\u0443 IP-\u0430\u0434\u0440\u0435\u0441\u0443 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435. \u042d\u0442\u043e\u0442 \u0442\u0438\u043f \u0434\u0435\u043b\u0430\u0435\u0442 \u0441\u0435\u0440\u0432\u0438\u0441 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430;</li> <li>NodePort \u2014 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0441\u0435\u0440\u0432\u0438\u0441 \u043d\u0430 \u0442\u043e\u043c \u0436\u0435 \u043f\u043e\u0440\u0442\u0443 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e NAT. \u0414\u0435\u043b\u0430\u0435\u0442 \u0441\u0435\u0440\u0432\u0438\u0441 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u043c \u0432\u043d\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0447\u0435\u0440\u0435\u0437 :. \u042f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430\u0434\u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u043e\u043c ClusterIP. <li>LoadBalancer \u2014 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0432\u043d\u0435\u0448\u043d\u0438\u0439 \u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0449\u0438\u043a \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u043c \u043e\u0431\u043b\u0430\u043a\u0435 (\u0435\u0441\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f) \u0438 \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u0442 \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0432\u043d\u0435\u0448\u043d\u0438\u0439 IP-\u0430\u0434\u0440\u0435\u0441 \u0434\u043b\u044f \u0441\u0435\u0440\u0432\u0438\u0441\u0430. \u042f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430\u0434\u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u043e\u043c NodePort.</li> <li>ExternalName \u2014 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0441\u0435\u0440\u0432\u0438\u0441\u0443 \u043f\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u043c\u0443 \u043f\u043e\u043b\u044f externalName (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, foo.bar.example.com), \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u044f \u0437\u0430\u043f\u0438\u0441\u044c CNAME \u0441 \u0435\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\u043c. \u041f\u0440\u0438 \u044d\u0442\u043e\u043c \u043f\u0440\u043e\u043a\u0441\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f.</li>"},{"location":"05%20Kubernetes/5.3_Kubernetes/#ingress","title":"Ingress","text":"<ul> <li>\u0420\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043d\u0430 OSI \u0443\u0440\u043e\u0432\u043d\u0435 7</li> <li>\u041e\u043f\u0435\u0440\u0438\u0440\u0443\u0435\u0442 \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0441\u0442\u0435\u043a\u0430</li> <li>\u041c\u043e\u0436\u0435\u0442 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430 \u0442\u0430\u043a\u043e\u0439 \u043a\u0430\u043a \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0441\u0435\u0441\u0441\u0438\u0438</li> </ul>"},{"location":"05%20Kubernetes/5.4_Helm/","title":"5.4 Helm","text":"<p>Helm \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u043e\u043c \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0434\u043b\u044f Kubernetes, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0443\u043f\u0440\u043e\u0449\u0430\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f\u043c\u0438 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430\u0445 Kubernetes. \u041e\u043d \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u043e\u0431\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0443, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430\u043c \u0443\u043f\u0430\u043a\u043e\u0432\u044b\u0432\u0430\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0432 \u0435\u0434\u0438\u043d\u044b\u0435 \u043f\u0430\u043a\u0435\u0442\u044b, \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0435 \u043a\u0430\u043a \u0447\u0430\u0440\u0442\u044b (charts), \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u043b\u0435\u0433\u043a\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b, \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u044b \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 Kubernetes.</p> <p>\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430 Helm \u0432\u043a\u043b\u044e\u0447\u0430\u044e\u0442:</p> <ul> <li>\u0423\u043f\u0440\u043e\u0449\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439: Helm \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043a\u0430\u043a \u043d\u0430\u0431\u043e\u0440 \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 Kubernetes \u0441 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u043c\u0438 \u0432\u0435\u0440\u0441\u0438\u044f\u043c\u0438, \u0447\u0442\u043e \u0441\u043e\u043a\u0440\u0430\u0449\u0430\u0435\u0442 \u0443\u0441\u0438\u043b\u0438\u044f \u0438 \u0443\u043f\u0440\u043e\u0449\u0430\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f.</li> <li>\u0411\u043e\u0433\u0430\u0442\u0430\u044f \u044d\u043a\u043e\u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0447\u0430\u0440\u0442\u043e\u0432: Helm \u0434\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043e\u0431\u0448\u0438\u0440\u043d\u043e\u0439 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0435 \u0447\u0430\u0440\u0442\u043e\u0432, \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u043e\u043c, \u0447\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043b\u0435\u0433\u043a\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c \u0433\u043e\u0442\u043e\u0432\u044b\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439 \u0438 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432.</li> <li>\u041f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u044c \u0438 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u0438\u0437\u0430\u0446\u0438\u044f: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0447\u0430\u0440\u0442\u043e\u0432 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u044c \u0438 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439, \u0447\u0442\u043e \u0432\u0430\u0436\u043d\u043e \u0434\u043b\u044f \u043d\u0435\u043f\u0440\u0435\u0440\u044b\u0432\u043d\u043e\u0439 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0438 \u043d\u0435\u043f\u0440\u0435\u0440\u044b\u0432\u043d\u043e\u0439 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438 (CI/CD).</li> <li>\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0440\u0435\u043b\u0438\u0437\u0430\u043c\u0438: Helm \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043b\u0435\u0433\u043a\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u043c\u0438 \u0432\u0435\u0440\u0441\u0438\u044f\u043c\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439, \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0442\u044c \u0438\u0445 \u0438 \u043e\u0442\u043a\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u043a \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u043c \u0432\u0435\u0440\u0441\u0438\u044f\u043c \u043f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438.</li> </ul>"},{"location":"05%20Kubernetes/5.4_Helm/#_1","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b","text":"<pre><code>helm template my-nginx bitnami/nginx\n\nhelm install my-nginx bitnami/nginx\n\nhelm upgrade my-nginx bitnami/nginx --set replicaCount=2\n\nhelm upgrade my-nginx bitnami/nginx -f stage.yaml\n\nhelm uninstall my-nginx\n</code></pre>"},{"location":"05%20Kubernetes/5.4_Helm/#_2","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0440\u0435\u043b\u0438\u0437\u0430\u043c\u0438","text":"<ul> <li>RELEASE - \u044d\u0442\u043e \u0438\u043c\u044f \u0440\u0435\u043b\u0438\u0437\u0430, \u043a \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0442\u043a\u0430\u0442.</li> <li>[REVISION] - \u044d\u0442\u043e \u043d\u043e\u043c\u0435\u0440 \u0440\u0435\u0432\u0438\u0437\u0438\u0438, \u043a \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0442\u043a\u0430\u0442\u0438\u0442\u044c\u0441\u044f. \u0415\u0441\u043b\u0438 \u044d\u0442\u043e\u0442 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442 \u043e\u043f\u0443\u0449\u0435\u043d \u0438\u043b\u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u043d\u0430 0, \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u043e\u0442\u043a\u0430\u0442\u0438\u0442 \u0440\u0435\u043b\u0438\u0437 \u043a \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u043c\u0443 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044e.</li> <li>[flags] - \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0444\u043b\u0430\u0433\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0441 \u043a\u043e\u043c\u0430\u043d\u0434\u043e\u0439, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 --dry-run \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u0431\u0435\u0437 \u0438\u0445 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f.</li> </ul> <pre><code>helm rollback &lt;RELEASE&gt; [REVISION] [flags]\n\nhelm rollback my-nginx\n\nhelm history my-nginx\n\nhelm rollback my-nginx 1\n</code></pre>"},{"location":"05%20Kubernetes/5.4_Helm/#_3","title":"\u0428\u0430\u0431\u043b\u043e\u043d\u0438\u0437\u0430\u0442\u043e\u0440","text":"<p>\u0428\u0430\u0431\u043b\u043e\u043d\u0438\u0437\u0430\u0442\u043e\u0440 Helm \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 Go \u0448\u0430\u0431\u043b\u043e\u043d\u044b \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u043e\u0432 Kubernetes \u0438\u0437 \u0447\u0430\u0440\u0442\u043e\u0432. \u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430\u043c \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0438 \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u043c\u044b\u0435 \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u044b \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0439, \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 \u0432 values.yaml \u0444\u0430\u0439\u043b\u0435 \u0447\u0430\u0440\u0442\u0430. \u0428\u0430\u0431\u043b\u043e\u043d\u0438\u0437\u0430\u0442\u043e\u0440 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0442\u0430\u043a\u0438\u0435 \u043a\u0430\u043a \u0446\u0438\u043a\u043b\u044b, \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435, \u0447\u0442\u043e \u0434\u0435\u043b\u0430\u0435\u0442 \u0435\u0433\u043e \u043c\u043e\u0449\u043d\u044b\u043c \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u043c \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u043e\u0432.</p> <p>\u0412\u0441\u0442\u0430\u0432\u043a\u0430 <pre><code>labels:\n  {{- include \"grafana.labels\" . | nindent 4 }}\n  {{- with .Values.labels }}\n  {{- toYaml . | nindent 4 }}\n  {{- end }}\n</code></pre> \u0423\u0441\u043b\u043e\u0432\u0438\u0435 <pre><code>{{- if .Values.dashboards }}\nchecksum/dashboards-json-config: {{ include (print $.Template.BasePath \"/dashboards-json-configmap.yaml\") . | sha256sum }}\n{{- end }}\n</code></pre> \u0426\u0438\u043a\u043b <pre><code>{{- range $key, $value := .Values.imageRenderer.envValueFrom }}\n  - name: {{ $key | quote }}\n    valueFrom:\n      {{- tpl (toYaml $value) $ | nindent 16 }}\n{{- end }}\n</code></pre></p>"},{"location":"05%20Kubernetes/5.4_Helm/#helm-chart","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0432\u043e\u0435\u0433\u043e helm chart","text":"<pre><code>mychart/\n Chart.yaml\n values.yaml\n templates/\n    deployment.yaml\n    service.yaml\n    _helpers.tpl\n charts/\n    mydependency/\n .helmignore\n README.md\n requirements.yaml\n NOTES.txt\n</code></pre> <p>\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0432 Helm \u0447\u0430\u0440\u0442\u0435 \u0438 \u0438\u0445 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0432\u043a\u043b\u044e\u0447\u0430\u044e\u0442:</p> <ul> <li>Chart.yaml: \u042d\u0442\u043e\u0442 \u0444\u0430\u0439\u043b \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0447\u0430\u0440\u0442\u0435, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0435\u0433\u043e \u0432\u0435\u0440\u0441\u0438\u044e, \u0438\u043c\u044f, \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435.</li> <li>values.yaml: \u042d\u0442\u043e\u0442 \u0444\u0430\u0439\u043b \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0445 \u0432 \u0448\u0430\u0431\u043b\u043e\u043d\u0430\u0445 \u0447\u0430\u0440\u0442\u0430.</li> <li>templates/: \u0412 \u044d\u0442\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u044b Kubernetes.</li> <li>charts/: \u0415\u0441\u043b\u0438 \u0432\u0430\u0448 \u0447\u0430\u0440\u0442 \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0447\u0430\u0440\u0442\u043e\u0432, \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u044d\u0442\u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u0432 \u044d\u0442\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438.</li> <li>NOTES.txt: \u0432 Helm \u0447\u0430\u0440\u0442\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043f\u043e\u0441\u043b\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0433\u043e \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f \u0447\u0430\u0440\u0442\u0430. \u042d\u0442\u043e\u0442 \u0444\u0430\u0439\u043b \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043f\u043e\u043b\u0435\u0437\u043d\u044b\u0435 \u0441\u0432\u0435\u0434\u0435\u043d\u0438\u044f, \u0442\u0430\u043a\u0438\u0435 \u043a\u0430\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 URL-\u0430\u0434\u0440\u0435\u0441\u0430, \u0443\u0447\u0435\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430, \u0448\u0430\u0433\u0438 \u0434\u043b\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0439 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0438\u043b\u0438 \u043b\u044e\u0431\u0443\u044e \u0434\u0440\u0443\u0433\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u043c\u043e\u0447\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c \u0432 \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044b\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435\u043c \u0438\u043b\u0438 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u043c.</li> </ul> <pre><code>helm create new-app\n\nhelm lint new-app\n</code></pre> <p>\u0424\u0430\u0439\u043b _helpers.tpl \u043f\u043e\u043c\u043e\u0433\u0430\u0435\u0442 \u0443\u043f\u0440\u043e\u0441\u0442\u0438\u0442\u044c \u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u0434 \u0432 \u0448\u0430\u0431\u043b\u043e\u043d\u0430\u0445 \u0447\u0430\u0440\u0442\u0430, \u0434\u0435\u043b\u0430\u044f \u0438\u0445 \u0431\u043e\u043b\u0435\u0435 \u0447\u0438\u0442\u0430\u0435\u043c\u044b\u043c\u0438 \u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u043c\u0438.</p> <code>_helpers.tpl</code> <code>pod.yaml</code> <pre><code>{{- define \"mychart.labels\" }}\napp.kubernetes.io/name: {{ include \"mychart.name\" . }}\napp.kubernetes.io/instance: {{ .Release.Name }}\napp.kubernetes.io/version: {{ .Chart.AppVersion | quote }}\napp.kubernetes.io/managed-by: {{ .Release.Service }}\n{{- end }}\n</code></pre> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n name: {{ include \"mychart.fullname\" . }}\n labels:\n    {{- include \"mychart.labels\" . | nindent 4 }}\n</code></pre>"},{"location":"05%20Kubernetes/5.4_Helm/#loki","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0447\u0430\u0440\u0442\u0430 loki","text":"<pre><code>helm repo add grafana https://grafana.github.io/helm-charts\n\nhelm pull grafana/loki-stack --untar\n\n$ vim value.yaml\ngrafana:\n  enabled: true\n\nhelm upgrade --install loki --namespace=monitoring --values values.yaml grafana/loki-stack\n\nkubectl get secret loki-grafana -n monitoring -o json\n\nkubectl port-forward svc/loki-grafana 3000:3000\n</code></pre>"},{"location":"05%20Kubernetes/5.7_Security/","title":"5.7 \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0432 K8s","text":"<p>\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c k8s \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0445 \u044d\u0442\u0430\u043f\u0430\u0445: - \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c docker image - Admission controllers   * \u044d\u0442\u043e \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u043b\u0430\u0433\u0438\u043d\u044b k8s, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0435\u0440\u0435\u0445\u0432\u0430\u0442\u044b\u0432\u0430\u044e\u0442 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 API Kubernetes \u0434\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u0430, \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u043f\u043e\u0434\u043b\u0438\u043d\u043d\u043e\u0441\u0442\u0438 \u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 - \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0445\u043e\u0441\u0442\u0430 (node) - \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0432 \u0440\u0430\u043d\u0442\u0430\u0439\u043c\u0435 (pod security admisson) - Network security - Application security</p>"},{"location":"05%20Kubernetes/5.7_Security/#docker","title":"\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c docker","text":"<p>\u0411\u0430\u0437\u043e\u0432\u044b\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u043f\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 docker:</p> <ul> <li>\u0420\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u043e \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0439\u0442\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f</li> <li>\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0439\u0442\u0435 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0441\u043e\u043a\u0435\u0442\u0443 docker \u0438 \u043d\u0435 \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0439\u0442\u0435 \u0435\u0433\u043e \u0431\u0435\u0437 \u0437\u0430\u0449\u0438\u0442\u044b</li> <li>\u0421\u043e\u0437\u0434\u0430\u0432\u0430\u0439\u0442\u0435 \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043d\u0435\u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430</li> <li>\u041d\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0439\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0441 \u043f\u043e\u0432\u044b\u0448\u0435\u043d\u043d\u044b\u043c\u0438 \u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u044f\u043c\u0438</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043f\u0440\u043e\u0444\u0438\u043b\u044c\u043d\u044b\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 docker \u043e\u0431\u0440\u0430\u0437\u043e\u0432 \u043d\u0430 \u043f\u0440\u0435\u0434\u043c\u0435\u0442 \u0443\u044f\u0437\u0432\u0438\u043c\u043e\u0441\u0442\u0435\u0439</li> <li>\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0439\u0442\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0438 \u0435\u0433\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u044b</li> <li>\u041f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0430\u0439\u0442\u0435 \u043f\u043e\u0432\u044b\u0449\u0435\u043d\u0438\u0435 \u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u0439 \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430</li> <li>\u041e\u0442\u043a\u043b\u044e\u0447\u0430\u0439\u0442\u0435 \u043c\u0435\u0436\u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043d\u043e\u0435 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043c\u043e\u0434\u0443\u043b\u0438 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 Linux</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 readonly \u0424\u0421 \u0438 docker volumes</li> </ul> <p>\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u043f\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 docker:</p> <ul> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043b\u0435\u0433\u043a\u043e\u0432\u0435\u0441\u043d\u044b\u0435 \u043e\u0431\u0440\u0430\u0437\u044b \u041e\u0421</li> <li>\u041f\u043e\u0434\u043f\u0438\u0441\u044b\u0432\u0430\u0439\u0442\u0435 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0439\u0442\u0435 docker-\u043e\u0431\u0440\u0430\u0437\u044b \u0434\u043b\u044f \u043c\u0438\u0442\u0438\u0433\u0430\u0446\u0438\u0438 \u0430\u0442\u0430\u043a MITM</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u044b\u0435 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442\u043e\u0432</li> <li>\u041f\u0440\u0438\u043c\u0435\u043d\u044f\u0439\u0442\u0435 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u043c\u043d\u043e\u0433\u043e\u044d\u0442\u0430\u043f\u043d\u043e\u0439 \u0441\u0431\u043e\u0440\u043a\u0438 (multistaging)</li> <li>\u041d\u0435 \u0434\u043e\u043f\u0443\u0441\u043a\u0430\u0439\u0442\u0435 \u0443\u0442\u0435\u0447\u043a\u0438 \u0441\u0435\u043d\u0441\u0435\u0442\u0438\u0432\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u0432 Dockerfile</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0442\u0435\u0433\u0438 \u0432\u0435\u0440\u0441\u0438\u0439 \u043e\u0431\u0440\u0430\u0437\u043e\u0432</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044e COPY \u0432\u043c\u0435\u0441\u0442\u043e ADD</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043b\u0438\u043d\u0442\u0435\u0440\u044b \u043f\u0440\u0438 \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 Dockerfile</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043f\u043e\u043b\u043d\u043e\u0446\u0435\u043d\u043d\u044b\u0439 DevSecOps-\u043a\u043e\u043d\u0432\u0435\u0439\u0435\u0440</li> </ul> <p>\u0411\u0430\u0437\u043e\u0432\u044b\u0435 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u044b \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0445\u043e\u0441\u0442\u0430</p> <ul> <li>\u0420\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u043e \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0439\u0442\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f (\u041e\u0421, \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438, \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438)</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u0441\u043a\u0430\u043d\u0435\u0440\u044b (nessus, openvas greenbone, xspider)</li> <li>\u041f\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438, \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 public-ip (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435 \u0441\u0435\u0442\u0438 \u0438\u043b\u0438 VPN)</li> </ul> <p>Sysdig Falco \u2014 opensource-\u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442 \u0434\u043b\u044f \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u0430\u043d\u043e\u043c\u0430\u043b\u0438\u0439 \u0438 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435.</p>"},{"location":"05%20Kubernetes/5.7_Security/#network-security","title":"Network security","text":"<p>\u0412 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 k8s \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u043d\u0430\u0431\u043b\u044e\u0434\u0430\u0435\u0442\u0441\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0441 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c\u044e:</p> <ul> <li>\u0442\u0440\u0430\u0444\u0438\u043a \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0440\u0430\u0437\u0440\u0435\u0449\u0435\u043d \u0438 \u043d\u0438\u043a\u0430\u043a \u043d\u0435 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u0438\u0440\u0443\u0435\u0442\u0441\u044f (\u0435\u0441\u043b\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f, \u043a \u043f\u0440\u0438\u043c\u0435\u0440\u0443, service mesh)</li> <li>\u0430\u0434\u0440\u0435\u0441\u0430 \u043f\u043e\u0434\u043e\u0432 \u0447\u0430\u0441\u0442\u043e \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f</li> <li>\u0442\u0440\u0430\u0444\u0438\u043a \u043d\u0435 \u0449\u0438\u0444\u0440\u0443\u0435\u0442\u0441\u044f (\u0435\u0441\u043b\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0441\u0440\u0435\u0434\u0441\u0442\u0432, service mesh \u0432 \u0442\u043e\u043c \u0447\u0438\u0441\u043b\u0435)</li> </ul> <p>\u0414\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u043e\u0432 \u0434\u043b\u0101 \u0436\u0435\u043b\u0430\u0435\u043c\u044b\u0445 Network Policy \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442 cilium editor (cni cilium) - https://editor.cilium.io/</p> <p>Service mesh</p> <p>\u0412 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u0438 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0441\u0435\u0442\u0435\u0439 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 \u0432\u0430\u043c \u0442\u0430\u043a\u0436\u0435 \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u043c\u043e\u0447\u044c \u0441\u0435\u0440\u0432\u0438\u0441\u043d\u0430\u044f \u0441\u0435\u0442\u043a\u0430 (service mesh)</p> <p>\u0421\u0435\u0440\u0432\u0438\u0441\u043d\u0430\u044f \u0441\u0435\u0442\u043a\u0430 \u2013 \u044d\u0442\u043e \u043d\u0430\u0431\u043e\u0440 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0438\u0445 \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u0442\u044c \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043c\u0435\u0436\u0434\u0443 \u043c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0441\u0445\u0435\u043c\u0443 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0438 \u043a\u043e\u0434\u044b HTTP-\u0441\u0442\u0430\u0442\u0443\u0441\u043e\u0432 \u043c\u0435\u0436\u0434\u0443 \u043d\u0438\u043c\u0438.</p> <p>\u041f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430 \u0441\u0435\u0440\u0432\u0438\u0441\u043d\u043e\u0439 \u0441\u0435\u0442\u043a\u0438 (service mesh) \u043d\u0430 \u0431\u0430\u0437\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u0430 Istio:</p> <ul> <li>Istio \u2013 \u0432\u043c\u0435\u0448\u0430\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u043e \u0432 \u0441\u0435\u0442\u0435\u0432\u043e\u0435 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435</li> <li>\u041e\u0442\u043a\u0430\u0437\u043e\u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u043e\u0441\u0442\u044c: \u0440\u0435\u0442\u0440\u0430\u0439 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043f\u0440\u0438 \u0441\u0431\u043e\u0435 (\u0431\u043b\u0430\u0433\u043e\u0434\u0430\u0440\u044f \u043a\u043e\u0434\u0443 \u043e\u0442\u0432\u0435\u0442\u0430)</li> <li>\u041a\u0430\u043d\u0430\u0440\u0435\u0435\u0447\u043d\u044b\u0435 \u0432\u044b\u043a\u0430\u0442\u044b: \u0440\u0435\u0433\u0443\u043b\u0438\u0440\u0443\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043d\u0430 \u043d\u043e\u0432\u043e\u0439 \u0432\u0435\u0440\u0441\u0438\u0438 \u0441\u0435\u0440\u0432\u0438\u0441\u0430</li> <li>\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0440\u0430\u0444\u0438\u043a\u043e\u043c (\u0442\u0430\u0439\u043c\u0430\u0443\u0442\u044b, \u0440\u0435\u0442\u0440\u0430\u0438, \u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u043a\u0430)</li> <li>\u041d\u0430\u0431\u043b\u044e\u0434\u0430\u0435\u043c\u043e\u0441\u0442\u044c: \u0436\u0443\u0440\u043d\u0430\u043b\u044b, \u043c\u0435\u0442\u0440\u0438\u043a\u0438, \u0442\u0440\u0430\u0441\u0441\u0438\u0440\u043e\u0432\u043a\u0438</li> <li>\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c: \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f, \u0440\u0430\u0431\u043e\u0442\u0430 \u0441 \u0442\u043e\u043a\u0435\u043d\u0430\u043c\u0438, \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u0442\u0440\u0430\u0444\u0438\u043a\u0430</li> </ul>"},{"location":"05%20Kubernetes/5.7_Security/#app-security","title":"App security","text":"<p>\u0414\u043b\u044f \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044b\u0445 \u0432 \u0432\u0430\u0448\u0435\u043c \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 k8s \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439 \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c\u0438 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u044f\u043c\u0438:</p> <ul> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 k8s secrets (\u0438\u043b\u0438 HashiCorp Vault \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u044b)</li> <li>\u041f\u0440\u0438\u043c\u0435\u043d\u044f\u0439\u0442\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438 devsecops (SAST, SCA, DAST, IAST, RASP)</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u043d\u0443\u044e \u0441\u0435\u0442\u043a\u0443 (service mesh) \u0434\u043b\u044f \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044f \u0437\u0430 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u043c\u0438 \u043f\u043e\u0442\u043e\u043a\u0430\u043c\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439, \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u043d\u044b\u043c\u0438 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044f\u043c\u0438 \u0434\u0435\u043f\u043b\u043e\u044f \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f)</li> <li>\u041f\u0440\u043e\u0432\u043e\u0434\u0438\u0442\u0435 \u0430\u0443\u0434\u0438\u0442 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043f\u0440\u043e\u0444\u0438\u043b\u044c\u043d\u00fd\u0445 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438: kube-hunter, kube-audit, chaos-monkey \u0438 \u043f\u0440\u043e\u0447.</li> </ul>"},{"location":"05%20Kubernetes/5.7_Security/#kubernetes-system-admin","title":"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u0432 Kubernetes system-admin","text":"<p>\u0418\u0437 kube/conf \u0431\u0435\u0440\u0435\u043c \u043f\u043e\u043b\u0435 client-certificate-data \u0438 \u0434\u0435\u043a\u043e\u0434\u0438\u0440\u0443\u0435\u043c, \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 pem</p> <p><pre><code>echo \"client-certificate-data\" | base64 -d &gt; cert.pem\n</code></pre> \u0414\u0430\u043b\u0435\u0435 \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u044b\u0432\u0430\u0435\u043c \u0441\u0430\u043c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 <pre><code>openssl x509 -in cert.pem -text -noout\n</code></pre> \u0412 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d Subject, Public-Key, Signature <pre><code>---\nCertificate:\n    Data:\n        Subject: O = system:masters, CN = system:admin\n        Public-Key\n        Signature Value\n</code></pre> \u041d\u0430\u0439\u0434\u0435\u043c \u0432\u0441\u0435 \u043f\u0440\u0430\u0432\u0430 \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u043b\u0438 \u0433\u0440\u0443\u043f\u043f\u044b <pre><code>kubectl get rolebinding,clusterrolebinding --all-namespaces -o yaml | grep system:masters -B 20\n\n---\n- apiVersion: rbac.authorization.k8s.io/v1\n  kind: ClusterRoleBinding\n  metadata:\n    annotations:\n      rbac.authorization.kubernetes.io/autoupdate: \"true\"\n    creationTimestamp: \"2024-01-16T09:35:53Z\"\n    labels:\n      kubernetes.io/bootstrapping: rbac-defaults\n    name: cluster-admin\n    resourceVersion: \"139\"\n    uid: 652339e7-38c8-4009-8ddf-adc61b7154c4\n  roleRef:\n    apiGroup: rbac.authorization.k8s.io\n    kind: ClusterRole\n    name: cluster-admin\n  subjects:\n  - apiGroup: rbac.authorization.k8s.io\n    kind: Group\n    name: system:masters\n</code></pre> \u0418 \u0442\u0435\u043f\u0435\u0440\u044c \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0441\u0430\u043c\u0443 \u0440\u043e\u043b\u044c <pre><code>kubectl get clusterrole/cluster-admin -o yaml\n</code></pre> <pre><code>---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  annotations:\n    rbac.authorization.kubernetes.io/autoupdate: \"true\"\n  creationTimestamp: \"2024-01-16T09:35:53Z\"\n  labels:\n    kubernetes.io/bootstrapping: rbac-defaults\n  name: cluster-admin\n  resourceVersion: \"77\"\n  uid: 7a87ee32-c6bf-409b-bca6-5abe5c833c30\nrules:\n- apiGroups:\n  - '*'\n  resources:\n  - '*'\n  verbs:\n  - '*'\n- nonResourceURLs:\n  - '*'\n  verbs:\n  - '*'\n</code></pre></p> <pre><code>kubectl auth can-i list pods --as jean\n</code></pre>"},{"location":"05%20Kubernetes/5.7_Security/#x509","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0438 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0445 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 X.509","text":"<p><pre><code>openssl genrsa -out pavel.key 2048\nopenssl req -new -key pavel.key \\\\n-out pavel.csr \\\\n-subj \"/CN=pavel\"\ncat pavel.csr | base64\nnvim csr.yaml\n</code></pre> <pre><code>apiVersion: certificates.k8s.io/v1\nkind: CertificateSigningRequest\nmetadata:\n  name: pavel\nspec:\n  request: LS0tLS1CRULS0tLQo=\n  signerName: kubernetes.io/kube-apiserver-client\n  expirationSeconds: 86400  # one day\n  usages:\n  - client auth\n</code></pre> <pre><code>kubectl apply -f csr.yaml\nkubectl get csr\nkubectl certificate approve pavel\nkubectl get csr pavel -o jsonpath='{.status.certificate}'| base64 -d &gt; pavel.crt\nkubectl config --kubeconfig pavel-kubeconfig set-credentials pavel --client-key=pavel.key --client-certificate=pavel.crt --embed-certs=true\nkubectl config --kubeconfig pavel-kubeconfig set-context pavel --user=pavel\nkubectl config --kubeconfig pavel-kubeconfig get-contexts\nkubectl get pods\n</code></pre> <pre><code>---\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n namespace: default\n name: pod-reader\nrules:\n- apiGroups: [\"\"]\n  resources: [\"pods\"]\n  verbs: [\"get\", \"watch\", \"list\"]\n\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n name: pod-reader-binding\n namespace: default\nsubjects:\n- kind: User\n  name: pavel\n  apiGroup: rbac.authorization.k8s.io\nroleRef:\n kind: Role\n name: pod-reader\n apiGroup: rbac.authorization.k8s.io\n</code></pre> <pre><code>kubectl apply -f prr.yaml\nkubectl get pods\nexport KUBECONFIG=~/Documents/pavel-kubeconfig\nkubectl get pods\n</code></pre></p>"},{"location":"05%20Kubernetes/5.8_CKAD/","title":"5.8 KodeKloud CKAD","text":""},{"location":"05%20Kubernetes/5.8_CKAD/#core-commands","title":"Core commands","text":"<p>Pods</p> <pre><code>kubectl get pods\n\nkubectl get pods --namepace=test\n\nkubectl run webapp --image=nginx\n\nkubectl run redis --image=redis:alpine --dry-run=client -o=yaml &gt; redis-pod.yaml\n\nkubectl describe pod webapp\n\nkubectl get pods -o wide\n\nkubectl delete pod webapp\n</code></pre> <p>ReplicaSets</p> <pre><code>kubectl get replicaset\n\nkubectl get rs\n\nkubectl describe rs new-replica-set\n\nkubectl edit rs new-replica-set\n\nkubectl replace --force -f /tmp/kubectl-edit.yaml\n\nkubectl scale rs new-replica-set --replicas=5\n</code></pre> <p>Deployments</p> <pre><code>kubectl create deployment nginx --image=nginx --replicas=4\n\n# \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u043f\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u0443\nkubectl explain deployment\n\n# \u0421\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432\nkubectl api-resources\n\n# \u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f\nkubectl rollout history deployment/my-app\n\n# \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f\nkubectl rollout status deployment/my-app\n\n# \u041e\u0442\u043a\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u043a \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u043c\u0443 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044e\nkubectl rollout undo deployment/my-app\n\n# \u041e\u0442\u043a\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u043a 3 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044e\nkubectl rollout undo deployment/my-app --to-revision=3\n\n# \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0432 \u0444\u0430\u0439\u043b\nkubectl get deploy/my-deployment -o yaml &gt; my-deploy.yaml\n\n# Set a deployment's nginx container image to nginx:1.9.1\nkubectl set image deployment/nginx nginx=nginx:1.9.1\n\n# Update image of all containers of daemonset abc to nginx:1.9.1\nkubectl set image daemonset abc *=nginx:1.9.1\n</code></pre> <p>Service</p> <pre><code>kubectl get svc\n\nkubectl expose pod redis --port=6379 --name redis-service\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#service","title":"Service","text":"<p>\u0424\u043e\u0440\u043c\u0430\u0442 \u0434\u043e\u043c\u0435\u043d\u043d\u043e\u0433\u043e \u0438\u043c\u0435\u043d\u0438 \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043a \u0442\u0430\u043a\u043e\u043c\u0443 \u0441\u0435\u0440\u0432\u0438\u0441\u0443 \u0438\u0437\u043d\u0443\u0442\u0440\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 Kubernetes \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439:</p> <pre><code>&lt;service-name&gt;.&lt;namespace&gt;.svc.cluster.local\n</code></pre> <pre><code>---\napiVersion: v1\nkind: Service\nmetadata:\n  name: my-service\nspec:\n  type: NodePort\n  selector:\n    app.kubernetes.io/name: MyApp\n  ports:\n    - port: 80\n      targetPort: 80\n      # will allocate a port from a range (default: 30000-32767)\n      nodePort: 30007\n</code></pre> <p>Headless \u0441\u0435\u0440\u0432\u0438\u0441\u044b \u0432 Kubernetes \u2014 \u044d\u0442\u043e \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u0442\u0438\u043f \u0441\u0435\u0440\u0432\u0438\u0441\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u043d\u044b\u0439 IP-\u0430\u0434\u0440\u0435\u0441.</p> <p>\u0424\u043e\u0440\u043c\u0430\u0442 DNS-\u0437\u0430\u043f\u0438\u0441\u0438 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043e\u0434\u0430 \u0431\u0443\u0434\u0435\u0442  <pre><code>&lt;pod-name&gt;.&lt;headless-service-name&gt;.&lt;namespace&gt;.svc.cluster.local\n</code></pre></p> <pre><code>---\napiVersion: v1\nkind: Service\nmetadata:\n  name: my-service\nspec:\n  clusterIP: None\n  selector:\n    app: my-app\n  ports:\n  - protocol: TCP\n    port:  80\n    targetPort:  9376\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#configmap","title":"ConfigMap","text":"<pre><code>kubectl create configmap  webapp-config-map --from-literal=APP_COLOR=darkblue\n</code></pre> <pre><code>---\napiVersion: v1\nkind: ConfigMap\ndata:\n  testkey: hello\n  testkey2: hello2\n\n---\n  containers:\n    - name: test-container\n      image: registry.k8s.io/busybox\n      command: [ \"/bin/sh\", \"-c\", \"env\" ]\n      envFrom:\n      - configMapRef:\n          name: special-config\n\n---\n  containers:\n    - name: test-container\n      image: registry.k8s.io/busybox\n      command: [ \"/bin/sh\", \"-c\", \"env\" ]\n      env:\n        - name: SPECIAL_LEVEL_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: special-config\n              key: special.how\n\n---\n  containers:\n  - name: mypod\n    image: nginx\n    volumeMounts:\n    - name: config-volume\n      mountPath: /etc/config\n  volumes:\n  - name: config-volume\n    configMap:\n      name: my-configmap\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#secret","title":"Secret","text":"<pre><code>kubectl create secret generic db-secret --from-literal=DB_Host=sql01 --from-literal=DB_User=root\n</code></pre> <pre><code>---\napiVersion: v1\nkind: Secret\nmetadata:\n  name: mysecret\ntype: Opaque\ndata:\n  username: YWRtaW4=\n  password: MWYyZDFlMmU2N2Rm\n\n---\napiVersion: v1\nkind: Pod\nmetadata:\n  name: envfrom-secret\nspec:\n  containers:\n  - name: envars-test-container\n    image: nginx\n    envFrom:\n    - secretRef:\n        name: test-secret\n\n---\n  containers:\n  - name: envars-test-container\n    image: nginx\n    env:\n    - name: BACKEND_USERNAME\n      valueFrom:\n        secretKeyRef:\n          name: backend-user\n          key: backend-username\n\n---\n  containers:\n  - name: mypod\n    image: myimage\n    volumeMounts:\n    - name: mysecret\n      mountPath: \"/etc/mysecret\"\n      readOnly: true\n  volumes:\n  - name: mysecret\n    secret:\n      secretName: mysecret\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#persistent-volume","title":"Persistent Volume","text":"<pre><code>---\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: pv-log\nspec:\n  persistentVolumeReclaimPolicy: Retain\n  accessModes:\n    - ReadWriteMany\n  capacity:\n    storage: 100Mi\n  hostPath:\n    path: /pv/log\n\n---\nkind: PersistentVolumeClaim\napiVersion: v1\nmetadata:\n  name: claim-log-1\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 50Mi\n\n---\napiVersion: v1\nkind: Pod\nmetadata:\n  name: webapp\nspec:\n  containers:\n  - name: event-simulator\n    image: kodekloud/event-simulator\n    env:\n    - name: LOG_HANDLERS\n      value: file\n    volumeMounts:\n    - mountPath: /log\n      name: log-volume\n\n  volumes:\n  - name: log-volume\n    persistentVolumeClaim:\n      claimName: claim-log-1\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#network-policies","title":"Network Policies","text":"<pre><code>---\napiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: test-network-policy\n  namespace: default\nspec:\n  podSelector:\n    matchLabels:\n      role: db\n  policyTypes:\n  - Ingress\n  - Egress\n  ingress:\n  - from:\n    - ipBlock:\n        cidr: 172.17.0.0/16\n        except:\n        - 172.17.1.0/24\n    - namespaceSelector:\n        matchLabels:\n          project: myproject\n    - podSelector:\n        matchLabels:\n          role: frontend\n    ports:\n    - protocol: TCP\n      port: 6379\n  egress:\n  - to:\n    - ipBlock:\n        cidr: 10.0.0.0/24\n    - namespaceSelector:\n        matchExpressions:\n        - key: namespace\n          operator: In\n          values: [\"frontend\", \"backend\"]\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#node-affinity","title":"Node Affinity","text":"<pre><code>kubectl label node node01 color=blue\n</code></pre> <pre><code>---\nspec:\n  affinity:\n    nodeAffinity:\n      requiredDuringSchedulingIgnoredDuringExecution:\n        nodeSelectorTerms:\n        - matchExpressions:\n          - key: topology.kubernetes.io/zone\n            operator: In\n            values:\n            - antarctica-east1\n            - antarctica-west1\n      preferredDuringSchedulingIgnoredDuringExecution:\n      - weight: 1\n        preference:\n          matchExpressions:\n          - key: another-node-label-key\n            operator: In\n            values:\n            - another-node-label-value\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#pod-anti-affinity","title":"Pod Anti Affinity","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n name: my-pod\n labels:\n    app: myapp\nspec:\n affinity:\n    podAntiAffinity:\n      requiredDuringSchedulingIgnoredDuringExecution:\n      - labelSelector:\n          matchExpressions:\n          - key: app\n            operator: In\n            values:\n            - myapp\n        topologyKey: \"kubernetes.io/hostname\"\n containers:\n - name: my-container\n    image: myapp-image\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#pod-distruption-budgets","title":"Pod Distruption Budgets","text":"<pre><code>apiVersion: policy/v1beta1\nkind: PodDisruptionBudget\nmetadata:\n name: nginx-pdb\nspec:\n minAvailable: 1\n selector:\n   matchLabels:\n     app: nginx\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#taints-and-toleration","title":"Taints and Toleration","text":"<p>Taints \u044d\u0442\u043e \u0437\u0430\u043f\u0440\u0435\u0442, \u0440\u0430\u0437\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u044e\u0449\u0438\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u0442\u0430\u043a \u0447\u0442\u043e \u043f\u043e\u043f\u0430\u0441\u0442\u044c \u0442\u0443\u0434\u0430 \u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f\u043c. Tolerations \u2013 \u044d\u0442\u043e \u043a\u0430\u043a \u0440\u0430\u0437 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0432\u0445\u043e\u0434\u0430.</p> <pre><code>kubectl taint nodes node01 spray=mortein:NoSchedule\n</code></pre> <pre><code>---\napiVersion: v1\nkind: Pod\nmetadata:\n  name: bee\nspec:\n  containers:\n  - image: nginx\n    name: bee\n  tolerations:\n  - key: spray\n    value: mortein\n    effect: NoSchedule\n    operator: Equal\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#serviceaccount-role-binding","title":"ServiceAccount, Role, Binding","text":"<pre><code>kubectl create sa dashboard-sa\n\nkubectl create token dashboard-sa\n\nkubectl set serviceaccount deploy/web-dashboard dashboard-sa\n</code></pre> <pre><code>kubectl create clusterrole --help\n\nkubectl create clusterrole storage-admin --resource=persistentvolume,storageclasses --verb=list,create,get,watch\n\nkubectl create clusterrolebinding admin --user=admin --clusterrole=storage-admin\n</code></pre> <pre><code>---\nkind: Role\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  namespace: default\n  name: pod-reader\nrules:\n- apiGroups:\n  - ''\n  resourceNames:\n  - my-pod\n  resources:\n  - pods\n  verbs:\n  - get\n  - watch\n  - list\n\n---\nkind: RoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: read-pods\n  namespace: default\nsubjects:\n- kind: ServiceAccount\n  name: dashboard-sa # Name is case sensitive\n  namespace: default\nroleRef:\n  kind: Role #this must be Role or ClusterRole\n  name: pod-reader # this must match the name of the Role or ClusterRole you wish to bind to\n  apiGroup: rbac.authorization.k8s.io\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#lightning-lab-1","title":"Lightning Lab 1","text":""},{"location":"05%20Kubernetes/5.8_CKAD/#task-1","title":"Task 1","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c PV, PVC, POD</p> <pre><code>---\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: log-volume\nspec:\n  storageClassName: manual\n  capacity:\n    storage: 1Gi\n  accessModes:\n    - ReadWriteMany\n  hostPath:\n    path: /opt/volume/nginx\n\n---\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: log-claim\nspec:\n  accessModes:\n    - ReadWriteMany\n  volumeMode: Filesystem\n  resources:\n    requests:\n      storage: 200Mi\n  storageClassName: manual\n</code></pre> <p><pre><code>kubectl run logger --image=nginx:alpine --dry-run=client -oyaml &gt; logger.yaml\n</code></pre> <pre><code>volumes:\n  - name: log\n    persistentVolumeClaim:\n      claimName: log-claim\ncontainers:\n  - image: nginx:alpine\n    name: logger\n    volumeMounts:\n      - name: log\n        mountPath: /var/www/nginx\n</code></pre></p>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-2","title":"Task 2","text":"<p>Troubleshoot \u043f\u043e\u0447\u0435\u043c\u0443 \u043e\u0434\u0438\u043d \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043d\u0435 \u0432\u0438\u0434\u0438\u0442 \u0434\u0440\u0443\u0433\u043e\u0439</p> <p><pre><code>kubectl get svc\n\nkubectl get pods\n\nkubectl exec -it webapp-color -- sh\n\nnc -v -z -w 2 secure-service 80\n\nOperation timed out\n</code></pre> \u041a\u043e\u043c\u0430\u043d\u0434\u0430 nc -v -z -w 2 secure-service 80 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0443\u0442\u0438\u043b\u0438\u0442\u0443 netcat (\u0438\u043b\u0438 nc) \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u043f\u043e\u0440\u0442\u0430 80 \u043d\u0430 \u0445\u043e\u0441\u0442\u0435 secure-service. \u0412\u043e\u0442 \u0447\u0442\u043e \u043e\u0437\u043d\u0430\u0447\u0430\u044e\u0442 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b: - v (verbose) \u2014 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434. - z \u2014 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u0440\u0442\u0430 \u0431\u0435\u0437 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445, \u043f\u0440\u043e\u0441\u0442\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0440\u0442\u0430. - w 2 \u2014 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u0442\u0430\u0439\u043c\u0430\u0443\u0442 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0432 2 \u0441\u0435\u043a\u0443\u043d\u0434\u044b. \u042d\u0442\u043e \u0437\u043d\u0430\u0447\u0438\u0442, \u0447\u0442\u043e netcat \u0431\u0443\u0434\u0435\u0442 \u0436\u0434\u0430\u0442\u044c \u043e\u0442\u0432\u0435\u0442\u0430 \u043e\u0442 secure-service \u043d\u0430 \u043f\u043e\u0440\u0442 80 \u0432 \u0442\u0435\u0447\u0435\u043d\u0438\u0435 2 \u0441\u0435\u043a\u0443\u043d\u0434.</p> <p><pre><code>kubectl get netpol\n\nkubectl describe netpol\n\nkubectl get pod --show-labels\n\nkubectl get netpol default-deny -oyaml &gt; netpol.yaml\n</code></pre> <pre><code>spec:\npodSelector:\n  matchLabels:\n    run: secure-pod\npolicyTypes:\n- Ingress\ningress:\n  - from:\n    - podSelector:\n        matchLabels:\n          name: webapp-color\n    ports:\n    - protocol: TCP\n      port: 80\n</code></pre></p>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-3","title":"Task 3","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c Pod, ConfigMap, Volume</p> <pre><code>kubectl create ns dvl1987\nkubectl create cm time-config -n dvl1987 --from-literal=TIME_FREQ=10\nkubectl get cm -n dvl1987\nkubectl run time-check --image=busybox --dry-run=client -oyaml &gt; time-check.yaml\n</code></pre> <pre><code>volumeMounts:\n  - name: log-volume\n    mountPath: /opt/time\nenv:\n  - name: TIME_FREQ\n    valueFrom:\n      configMapKeyRef:\n        name: time-config\n        key: TIME_FREQ\n\nvolumes:\n  - name: log-volume\n    emptyDir: {}\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-4","title":"Task 4","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c Deployment</p> <pre><code>kubectl create deploy nginx-deploy --image=nginx:1.16 --replicas=4 --dry-run=client -oyaml &gt; deploy.yaml\n</code></pre> <pre><code>strategy:\n  rollingUpdate:\n    maxSurge: 1\n    maxUnavailable: 2\n</code></pre> <pre><code>kubectl set image deployment nginx-deploy nginx=nginx:1.17\n\nkubectl get pod\n\nkubectl rollout undo deployment nginx-deploy\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-5","title":"Task 5","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c Deployment \u0441 configmap \u0438 \u043b\u0438\u043c\u0438\u0442\u0430\u043c\u0438</p> <pre><code>volumes:\n  - name: redis-config\n    configMap:\n      name: redis-config\n\ncontainers:\n- image: redis:alpine\n  name: redis\n    resources:\n      requests:\n        cpu: \"0.2\"\n  volumeMounts:\n    - name: redis-config\n      mountPath: /redis-master\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#lightning-lab-2","title":"Lightning Lab 2","text":""},{"location":"05%20Kubernetes/5.8_CKAD/#task-1_1","title":"Task 1","text":"<p>Troubleshooting pods \u0432 \u0441\u0442\u0430\u0442\u0443\u0441 != Ready, \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c liveness probe</p> <p><pre><code>kubectl describe pod nginx1401 -n dev\n</code></pre> \u041e\u0448\u0438\u0431\u043a\u0430 Readless probe, \u043d\u0430\u0434\u043e \u043f\u043e\u043c\u0435\u043d\u044f\u0442\u044c \u043f\u043e\u0440\u0442</p> <pre><code>livenessProbe:\n  exec:\n    command:\n    - ls\n    - /var/www/html/file_check\n  initialDelaySeconds: 10\n  periodSeconds: 60\n</code></pre> <pre><code>kubectl replace -f nginx.yaml --force\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-2_1","title":"Task 2","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c cronejob</p> <pre><code>completions: 1\nbackoffLimit: 25\nactiveDeadlineSeconds: 20\n\nrestartPolicy: Never\n</code></pre> <ul> <li>completions: \u042d\u0442\u043e\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0445 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0439 \u0437\u0430\u0434\u0430\u0447\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b.</li> <li>backoffLimit: \u042d\u0442\u043e\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442, \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0440\u0430\u0437 Kubernetes \u043f\u043e\u043f\u044b\u0442\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443.</li> <li>activeDeadlineSeconds: \u042d\u0442\u043e\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0437\u0430\u0434\u0430\u0435\u0442 \u0432\u0440\u0435\u043c\u044f \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f \u0434\u043b\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445. \u0415\u0441\u043b\u0438 \u0437\u0430\u0434\u0430\u0447\u0430 \u043d\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0441\u044f \u0432 \u0442\u0435\u0447\u0435\u043d\u0438\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438, \u043e\u043d\u0430 \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0435\u0440\u0432\u0430\u043d\u0430 \u0438 \u0441\u0447\u0438\u0442\u0430\u0442\u044c\u0441\u044f \u043d\u0435\u0443\u0434\u0430\u0447\u043d\u043e\u0439.</li> </ul>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-3_1","title":"Task 3","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0435\u043a\u0440\u0435\u0442\u044b</p> <pre><code>volumes:\n - name: secret-volume\n   secret:\n     secretName: dotfile-secret\n\n\ncontainers:\n  volumeMounts:\n    - name: secret-volume\n      readOnly: true\n      mountPath: /etc/secret-name\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-4_1","title":"Task 4","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c ingress</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: ingress-vh-routing\n  annotations:\n    nginx.ingress.kubernetes.io/rewrite-target: /\nspec:\n  ingressClassName: nginx-example\n  rules:\n   - host: watch-store.com:30093\n     http:\n      paths:\n      - path: /video\n        pathType: Prefix\n        backend:\n          service:\n            name: video-service\n            port:\n              number: 8080\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-5_1","title":"Task 5","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c pod \u0438 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043b\u043e\u0433\u0438</p> <p><pre><code>kubectl logs dev-pod-dind -c log-x\n\nkubectl logs dev-pod-dind -c log-x | grep WARNING &gt; /opt/dind_logs.txt\n</code></pre> \u0412 \u0434\u0430\u043d\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, -c log-x \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043d\u0430 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 log-x \u0432 \u043f\u043e\u0434\u0435 dev-pod-dind, \u0438\u0437 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u043d\u0443\u0436\u043d\u043e \u0438\u0437\u0432\u043b\u0435\u0447\u044c \u043b\u043e\u0433\u0438.</p>"},{"location":"05%20Kubernetes/5.8_CKAD/#mock-exam-1","title":"Mock Exam 1","text":""},{"location":"05%20Kubernetes/5.8_CKAD/#task-1_2","title":"Task 1","text":"<pre><code>kubectl run nignx-44889 --image=nginx:alpine\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-2_2","title":"Task 2","text":"<pre><code>kubectl create ns apx-z9938\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-3_2","title":"Task 3","text":"<pre><code>kubectl create deployment httpd-front --image=httpd:2.4-apline --replicas=3\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-4_2","title":"Task 4","text":"<pre><code>kubectl run messagins --image=redis:apline -l tier=msg\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-5_2","title":"Task 5","text":"<pre><code>kubectl get rs\n\nkubectl describe rs rs-d3393\n\nkubectl edit rs rs-d3393\n\nkubectl delete -l name=busybox-pod\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-6","title":"Task 6","text":"<p>\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u0430 <pre><code>kubectl expose deploy redis --port=6379 --name messaging-service\n</code></pre></p>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-7","title":"Task 7","text":"<pre><code>kubectl get pod webapp-color -oyaml &gt; pod.yaml\n\nchange env\n\nkubectl replace -f pod.yaml\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-8","title":"Task 8","text":"<pre><code>kubectl create configmap cm-3928 --from-literal=DB_NAME=SQL3322 --from-literal=DB_HOST=sql322.com\nkubectl describe cm cm-3928\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-9","title":"Task 9","text":"<pre><code>kubectl create secret generic db-secret --from-literal=DB_HOST=sql01 --from-literal=DB_USER=root\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-10","title":"Task 10","text":"<pre><code>kubectl get pod\n\nkubectl get pod app-sec -o yaml &gt; app-sec.yaml\n</code></pre> <pre><code>containers:\n  securityContext:\n    capabilities:\n      add: [\"SYS_TIME\"]\n\nsecurityContext:\n  runAsUser: 0\n</code></pre> <pre><code>kubectl replace -f app-sec.yaml --froce\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-11","title":"Task 11","text":"<pre><code>kubectl get ns\n\nkubectl get pod e-com -n e-commerce\n\nkubectl logs e-com --namespace=e-commerce &gt; /opt/log.txt\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-12","title":"Task 12","text":"<pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: pv-analytics\nspec:\n  volumeMode: Filesystem\n  persistentVolumeReclaimPolicy: Retain\n  accessModes:\n    - ReadWriteMany\n  capacity:\n    storage: 100Mi\n  hostPath:\n    path: /pv/data-analitycs\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-13","title":"Task 13","text":"<pre><code>kubectl create deployment redis --image=redis --replicas=1\n\nkubectl expose deployment redis --name=redis --port=6379 --target-port=6379\n</code></pre> <pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: redis-access\n  namespace: default\nspec:\n  podSelector:\n    matchLabels:\n      app: redis\n  policyTypes:\n  - Ingress\n  ingress:\n  - from:\n    - podSelector:\n        matchLabels:\n          access: redis\n    ports:\n    - protocol: TCP\n      port: 6379\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-14","title":"Task 14","text":"<pre><code>---\napiVersion: v1\nkind: Pod\nmetadata:\n  name: sega\nspec:\n  containers:\n  - name: tails\n    image: busybox\n    command:\n    - sleep\n    - \"3600\"\n  - name: sonic\n    image: nginx\n    env:\n      - name: NGINX_PORT\n        value: \"8080\"\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#mock-exam-2","title":"Mock Exam 2","text":""},{"location":"05%20Kubernetes/5.8_CKAD/#task-1_3","title":"Task 1","text":"<pre><code>kubectl create deployment my-webapp --image=nginx --replicas=2 --dry-run=client -oyaml &gt; webapp.yaml\n\nkubectl expose deploymeny my-webapp --name front-end-service --type NodePort --port 80\n</code></pre> <pre><code>NodePort: 30083\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-2_3","title":"Task 2","text":"<pre><code>kubectl get node\n\nkubectl tain node node01 app_type=alpha:NoSchedule\n\nkubectl run redis --image=redis\n</code></pre> <pre><code>tolerations:\n  - effect: NoSchedule\n    key: app_type\n    value: alpha\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-3_3","title":"Task 3","text":"<pre><code>kubectl label node controlplane app_type=beta\n\nkubectl get node controlplane --show-labels\n\nkubectl create deploy beta-apps --image=nginx --replicas=3 --dry-run=clien\n</code></pre> <pre><code>spec:\n  affinity:\n    nodeAffinity:\n      requiredDuringSchedulingIgnoredDuringExecution:\n        nodeSelectorTerms:\n        - matchExpressions:\n          - key: app_type\n            operator: In\n            values: [\"beta\"]\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-4_3","title":"Task 4","text":"<pre><code>kubect get svc\n\nkubectl create ingress ingress --rule=\"ckad-mock.com/video*=my-video-service:8080\" --dry-run=client\n</code></pre> <pre><code>spec:\n  rules:\n    - host: ckad-mock.com\n      http:\n        paths:\n        - backend:\n            service:\n              name: my-video-service\n              port:\n                number: 8080\n          path: /video\n          pathType: Prefix\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-5_3","title":"Task 5","text":"<pre><code>kubectl get pod pod-with-rprobe -oyaml\n</code></pre> <pre><code>readinessProbe:\n  httpGet:\n    path: /ready\n    port: 8080\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-6_1","title":"Task 6","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx1401\n  namespace: default\nspec:\n  containers:\n    - name: nginx1401\n      image: nginx\n      livenessProbe:\n        exec:\n          command: [\"ls /var/www/html/probe\"]\n        initialDelaySeconds: 10\n        periodSeconds: 60\n</code></pre> <ul> <li>initialDelaySeconds: \u042d\u0442\u043e\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0435\u043a\u0443\u043d\u0434, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 Kubernetes \u0434\u043e\u043b\u0436\u0435\u043d \u043f\u043e\u0434\u043e\u0436\u0434\u0430\u0442\u044c \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430, \u043f\u0440\u0435\u0436\u0434\u0435 \u0447\u0435\u043c \u043d\u0430\u0447\u0430\u0442\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0431.</li> <li>periodSeconds: \u042d\u0442\u043e\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442, \u043a\u0430\u043a \u0447\u0430\u0441\u0442\u043e (\u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445) Kubernetes \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u043f\u0440\u043e\u0431\u044b.</li> </ul>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-7_1","title":"Task 7","text":"<pre><code>kubectl create job --image=docker/whalesay whalesay --dry-run\n</code></pre> <pre><code>completions: 10\nbackoffLimit: 6\n\nspec:\n  containers:\n    - image: docker/whalesay\n      command:\n        - sh\n        - -c\n        - \"cowsay I am going to ace CKAD!\"\n  restartPolicy: Never\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-8_1","title":"Task 8","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: multi-pod\nspec:\n  containers:\n    - name: jupiter\n      image: nginx\n      env:\n        - name: type\n          value: planet\n    - name: europa\n      image: busybox\n      command: [\"/bin/sh\", \"-c\", \"sleep 4800\"]\n      env:\n        - name: type\n          value: moon\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-9_1","title":"Task 9","text":"<pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: custom-volume\nspec:\n  capacity:\n    storage: 50Mi\n  accessModes:\n    - ReadWriteMany\n  persistentVolumeReclaimPolicy: Retain\n  hostPath:\n    path: /opt/data\n</code></pre>"},{"location":"06%20ServiceMesh/6.1_ServiceMesh/","title":"6.1 \u041c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441\u043d\u0430\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430","text":""},{"location":"06%20ServiceMesh/6.1_ServiceMesh/#_1","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u043c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441\u043d\u043e\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b","text":"<ul> <li>\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u043d\u0430\u0434\u0435\u0436\u043d\u043e\u0439 \u0438 \u043e\u0442\u043a\u0430\u0437\u043e\u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u044b \u0432\u0441\u0435\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0438\u0437-\u0437\u0430 \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430 \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f</li> <li>\u0414\u043e\u043b\u0433\u0438\u0439 \u043f\u043e\u0438\u0441\u043a \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0439 \u043f\u0440\u0438\u0447\u0438\u043d\u044b \u0434\u0435\u0433\u0440\u0430\u0434\u0430\u0446\u0438\u0438</li> <li>\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0433\u043e \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438</li> <li>\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0435 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u043e\u0432 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043d\u0430 \u0447\u0430\u0441\u0442\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439</li> </ul>"},{"location":"06%20ServiceMesh/6.1_ServiceMesh/#service-mesh","title":"Service mesh","text":"<ul> <li>\u0414\u0430\u0451\u0442 \u0431\u043e\u043b\u044c\u0448\u0443\u044e \u043d\u0430\u0434\u0435\u0436\u043d\u043e\u0441\u0442\u044c \u043d\u043e \u0443\u0441\u043b\u043e\u0436\u043d\u044f\u0435\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0443</li> <li>\u041f\u043e\u0442\u0440\u0435\u0431\u043b\u044f\u0435\u0442 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b</li> <li>\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u044c \u043d\u0430\u043b\u0438\u0447\u0438\u044f \u044d\u043a\u0441\u043f\u0435\u0440\u0442\u0438\u0437\u044b \u0434\u043b\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0439 \u044d\u043a\u0441\u043f\u043b\u0443\u0430\u0442\u0430\u0446\u0438\u0438 (\u043d\u0430 \u0443\u0440\u043e\u0432\u0435\u043d\u044c -1)</li> </ul>"},{"location":"06%20ServiceMesh/6.2_Istio/","title":"6.2 Istio","text":""},{"location":"06%20ServiceMesh/6.2_Istio/#envoy-proxy","title":"Envoy proxy","text":"<ul> <li>\u0421\u0430\u043c\u044b\u0439 \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0439 proxy \u0434\u043b\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 service mesh </li> <li>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0432 runtime \u0447\u0435\u0440\u0435\u0437 API</li> <li>\u041c\u043e\u0449\u043d\u044b\u0439 \u043d\u0430\u0431\u043e\u0440 observability \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0439: tracing, prom/statsd \u043c\u0435\u0442\u0440\u0438\u043a\u0438</li> <li>\u0413\u0438\u0431\u043a\u0430\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f: circuit breakers, retries, rate limiting, mTLS</li> <li>L4 \u0438 L7 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430, \u0432\u043a\u043b\u044e\u0447\u0430\u044f http/2, gRPC</li> </ul>"},{"location":"06%20ServiceMesh/6.2_Istio/#envoy","title":"Envoy \u0442\u0435\u0440\u043c\u0438\u043d\u043e\u043b\u043e\u0433\u0438\u044f","text":"<p>Listener - \u0447\u0442\u043e \u0441\u043b\u0443\u0448\u0430\u0435\u0442 envoy</p> <p>Route - \u043c\u0435\u0445\u0430\u043d\u0438\u043a\u0430 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 (location \u0432 nginx)</p> <p>Cluster - \u0442\u043e \u043a\u0443\u0434\u0430 \u043c\u044b \u0431\u0443\u0434\u0435\u043c \u0441\u043a\u0438\u0434\u044b\u0432\u0430\u0442\u044c \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0443 (upstream \u0432 nginx)</p> <p>Cluster load assignment - \u0441\u0430\u043c\u0438 \u0430\u0434\u0440\u0435\u0441\u0430</p> <p>\u041d\u0430 \u0432\u0445\u043e\u0434 \u043c\u044b \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u0432 listener \u043f\u043e route \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c \u043a\u0443\u0434\u0430 \u0438\u0434\u0442\u0438 \u0434\u0430\u043b\u044c\u0448\u0435 \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u043c \u0432 cluster \u0438 load assignment</p>"},{"location":"06%20ServiceMesh/6.2_Istio/#_1","title":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440","text":"<pre><code>curl -L https://istio.io/downloadIstio | ISTIO_VERSION=1.21.2 TARGET_ARCH=x86_64 sh -\ncd istio-1.21.2\nexport PATH=$PWD/bin:$PATH\nistioctl x precheck\nistioctl install --set profile=default --set \"values.global.proxy.resources.requests.cpu=10m\" --set \"values.global.proxy.resources.requests.memory=100Mi\" -y\n</code></pre>"},{"location":"07%20Observability/7.1_Monitoring/","title":"7.1 \u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433","text":"<p>C\u043e\u0432\u043e\u043a\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0438 \u043f\u0440\u0430\u043a\u0442\u0438\u043a, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0430\u044f \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u0442\u044c \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043d\u0430\u0434 \u0440\u0430\u0431\u043e\u0442\u043e\u0439 IT \u0441\u0438\u0441\u0442\u0435\u043c \u0438 \u0434\u0430\u0432\u0430\u0442\u044c \u043e\u0446\u0435\u043d\u043a\u0443 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u044d\u0442\u0438\u0445 \u0441\u0438\u0441\u0442\u0435\u043c.</p> <p>\u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u0445\u043e\u0441\u0442\u0430</p> <ul> <li>CPU</li> <li>Memory</li> <li>Processes</li> <li>Disk</li> <li>Network</li> <li>\u0438 \u0442.\u0434.</li> </ul> <p>\u041c\u0435\u0442\u0440\u0438\u043a\u0438 Docker-\u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432</p> <ul> <li>CPU</li> <li>Memory</li> <li>Network</li> <li>Block I/O</li> <li>Docker Daemon</li> </ul> <p>\u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432</p> <ul> <li>\u0411\u0414, \u043e\u0447\u0435\u0440\u0435\u0434\u0438</li> <li>Load balancer</li> <li>\u0421\u0435\u0440\u0432\u0435\u0440 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f</li> <li>\u0421\u0442\u043e\u0440\u043e\u043d\u043d\u0438\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u044b</li> <li>\u0412\u0441\u0435, \u043e\u0442 \u0447\u0435\u0433\u043e \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u0441\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u044b \u0432\u0430\u0448\u0435\u0433\u043e \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430</li> </ul>"},{"location":"07%20Observability/7.2_Logging/","title":"7.2 \u041b\u043e\u0433\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435","text":"<p>\u041f\u043e \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0443 \u043c\u044b \u0432\u0438\u0434\u0438\u043c \u0447\u0442\u043e \u0441 \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 \u0447\u0442\u043e-\u0442\u043e \u043d\u0435 \u0442\u0430\u043a \u0438 \u043b\u043e\u0433\u0438 \u0434\u0430\u044e\u0442 \u043d\u0430\u043c \u0443\u0436\u0435 \u0431\u043e\u043b\u0435\u0435 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e</p> <ul> <li>\u0412\u0438\u0434\u0438\u043c\u043e\u0441\u0442\u044c \u0438 \u043f\u043e\u043d\u0438\u043c\u0430\u043d\u0438\u0435 \u0442\u043e\u0433\u043e, \u043a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0442 \u043d\u0430\u0448\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b</li> <li>\u041f\u043e\u0438\u0441\u043a \u043e\u0448\u0438\u0431\u043e\u043a \u0438 \u0438\u0445 \u043f\u0440\u0438\u0447\u0438\u043d</li> <li>\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043d\u043e\u0435 \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043c\u0435\u0442\u0440\u0438\u043a \u0441\u0438\u0441\u0442\u0435\u043c \u0438\u043b\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432</li> </ul>"},{"location":"07%20Observability/7.2_Logging/#elk-kafka","title":"ELK + kafka","text":"<ul> <li>Filebeat - \u0421\u0431\u043e\u0440\u0449\u0438\u043a</li> <li>Kafka - \u0411\u0443\u0444\u0435\u0440 (\u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u0437\u0430\u0445\u043b\u0435\u0431\u043d\u0443\u043b\u0441\u044f logstash)</li> <li>Logstash - \u0410\u0433\u0440\u0435\u0433\u0430\u0446\u0438\u044f \u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430</li> <li>Elasticsearch - \u0418\u043d\u0434\u0435\u043a\u0441\u0430\u0446\u0438\u044f \u0438 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435</li> <li>Kibana - \u0410\u043d\u0430\u043b\u0438\u0437 \u0438 \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f</li> </ul>"},{"location":"07%20Observability/7.3_Tracing/","title":"7.3 \u0422\u0440\u0435\u0439\u0441\u0438\u043d\u0433","text":"<ul> <li>Metrics - \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u0438 \u043f\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u044f\u043c, \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u044e\u0449\u0438\u0435 \u0442\u0440\u0435\u043d\u0434\u044b</li> <li>Logging - \u0436\u0443\u0440\u043d\u0430\u043b \u0441\u043e\u0431\u044b\u0442\u0438\u0439 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432</li> <li>Distributed tracing - \u0436\u0443\u0440\u043d\u0430\u043b \u0441\u043e\u0431\u044b\u0442\u0438\u0439 \u0441 \u043f\u0440\u0438\u0447\u0438\u043d\u043e-\u0441\u043b\u0435\u0434\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0439 \u0441\u0432\u044f\u0437\u044c\u044e</li> </ul> <p>Tracing</p> <ul> <li>\u041e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u043e\u0434\u043d\u043e\u0433\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u044f (\u0432 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435)</li> <li>\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0433\u0440\u0430\u0444\u044b \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 (traces) \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438</li> <li>\u0410\u043d\u0430\u043b\u0438\u0437 \u0433\u0440\u0430\u0444\u043e\u0432 \u043f\u043e\u043c\u043e\u0433\u0430\u0435\u0442 \u043d\u0430\u0439\u0442\u0438 \u043f\u0440\u0438\u0447\u0438\u043d\u044b \u0434\u043e\u043b\u0433\u0438\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432</li> </ul> <p>Zipkin</p>"},{"location":"10%20Security/10.1_TLS/","title":"10.1 TLS and mTLS","text":""},{"location":"10%20Security/10.1_TLS/#tls-","title":"\u0421\u043e\u0437\u0434\u0430\u0435\u043c TLS-\u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u044b","text":"<pre><code>openssl req -new -x509 -days 365 -nodes -out nginx_cert.crt -keyout nginx_cert.key -subj \"/CN=localhost\"\n</code></pre> <ul> <li>new: \u0412 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0435 \u044d\u0442\u043e\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043e\u043d \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u0441\u0430\u043c\u043e\u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430.</li> <li>x509: \u042d\u0442\u043e\u0442 \u0444\u043b\u0430\u0433 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 OpenSSL \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0430\u043c\u043e\u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0439 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 X.509 \u0432\u043c\u0435\u0441\u0442\u043e CSR.</li> <li>days 1461: \u042d\u0442\u043e\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0441\u0440\u043e\u043a \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0432 \u0434\u043d\u044f\u0445.</li> <li>nodes: \u042d\u0442\u043e\u0442 \u0444\u043b\u0430\u0433 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 OpenSSL \u043d\u0435 \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0439 \u043a\u043b\u044e\u0447.</li> <li>subj \"/CN=pk.nginx\": \u041e\u0431\u044a\u0435\u043a\u0442, \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u0432\u044b\u0434\u0430\u043d \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442. \u042d\u0442\u043e \u043c\u043e\u0436\u0435\u0442 \u0432\u043a\u043b\u044e\u0447\u0430\u0442\u044c \u0432 \u0441\u0435\u0431\u044f \u0438\u043c\u044f \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438, \u0434\u043e\u043c\u0435\u043d\u043d\u043e\u0435 \u0438\u043c\u044f (Common Name) \u0438\u043b\u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u044e\u0442 \u043d\u0430 \u0442\u043e, \u043a\u043e\u043c\u0443 \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442. \u0412 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0435 SSL/TLS, Subject \u043e\u0431\u044b\u0447\u043d\u043e \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0441\u044f \u043a \u0438\u043c\u0435\u043d\u0438 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438 \u0438\u043b\u0438 \u0434\u043e\u043c\u0435\u043d\u0443, \u0437\u0430\u0449\u0438\u0449\u0430\u0435\u043c\u043e\u043c\u0443 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u043c</li> </ul> <p>\u0422\u0435\u043f\u0435\u0440\u044c \u043c\u043e\u0436\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u044b \u0432 \u043a\u043e\u043d\u0444\u0438\u0433 nginx.conf <pre><code>events { worker_connections 1024; }\n\nhttp {\n    server {\n        listen 443 ssl;\n\n        ssl_certificate     nginx_cert.crt;\n        ssl_certificate_key nginx_cert.key;\n\n        location / {\n            return 200 'Hello, world!';\n        }\n    }\n}\n</code></pre></p> <p>\u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c nginx <pre><code>docker run -d -p 443:443 --name nginx -v $(pwd)/nginx/:/etc/nginx/ nginx:latest\n</code></pre></p> <pre><code>curl --cacert nginx/nginx_cert.crt https://localhost:443\n\nHello, world!\n</code></pre>"},{"location":"10%20Security/10.1_TLS/#_1","title":"\u0421\u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u043c \u043a\u043b\u044e\u0447 \u0434\u043b\u044f \u0446\u0435\u043d\u0442\u0440\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438","text":"<pre><code>openssl req -newkey rsa:2048 -x509 -nodes -keyout ca.key -days 3650 -subj \"/CN=ca.pk.nginx\" -out ca.crt\n</code></pre> <p>\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u0432 \u043a\u043e\u043d\u0444\u0438\u0433 <pre><code>server {\n    ...\n    ssl_client_certificate /etc/ssl/client/ca.crt;\n    ssl_verify_client on;\n    ...\n}\n</code></pre></p> <pre><code>docker run -d -p 443:443 --name nginx -v $(pwd)/nginx/:/etc/nginx/ -v $(pwd)/cacert/:/etc/ssl/client/ nginx:latest\n</code></pre> <p>\u0421\u043e\u0437\u0434\u0430\u0434\u0438\u043c \u0444\u0430\u0439\u043b \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430</p> <p>\u0424\u0430\u0439\u043b CSR (Certificate Signing Request) \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0439 \u043a\u043b\u044e\u0447 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043a\u043b\u0438\u0435\u043d\u0442 \u0445\u043e\u0447\u0435\u0442 \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0432 \u0441\u0432\u043e\u0439 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0438\u043c\u044f \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438, \u0441\u0442\u0440\u0430\u043d\u0430, \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0438 \u0442.\u0434.). CSR \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0432 \u0426\u0421 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430.</p> <pre><code>openssl req -newkey rsa:2048 -keyout client1.key -out client1.csr -nodes -days 365 -subj \"/CN=client1\"\n</code></pre> <p>\u0412\u044b\u0434\u0430\u0435\u043c \u0438 \u0437\u0430\u0432\u0435\u0440\u044f\u0435\u043c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u043a\u043b\u044e\u0447\u043e\u043c \u0446\u0435\u043d\u0442\u0440\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438</p> <pre><code>openssl x509 -req -in client1.csr -out client1.crt -CA ca.crt -CAkey ca.key -CAcreateserial -days 365\n\nCertificate request self-signature ok\nsubject=CN = client1\n</code></pre> <p>\u0422\u0435\u043f\u0435\u0440\u044c \u043c\u043e\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u043c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u043c</p> <pre><code>curl -k --key client1.key --cert client1.crt https://127.0.0.1:443\n\nHello, world!\n</code></pre>"},{"location":"10%20Security/10.1_TLS/#_2","title":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430","text":"<pre><code>openssl x509 -in client1.crt -text -noout \n\nopenssl x509 -in client1.crt -subject -issuer -noout\n</code></pre>"},{"location":"10%20Security/10.1_TLS/#ca","title":"\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0447\u0442\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d CA","text":"<pre><code>openssl verify -CAfile cacert/ca.crt client1.crt\n\nclient1.crt: OK\n</code></pre>"},{"location":"10%20Security/10.1_TLS/#_3","title":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430\u0445 \u0432 \u0446\u0435\u043f\u043e\u0447\u043a\u0435","text":"<pre><code>openssl crl2pkcs7 -nocrl -certfile all_certs.crt | openssl pkcs7 -print_certs -text -noout | grep -E \"(Certificate:)|(Issuer:)|(Subject:)\"\n</code></pre>"},{"location":"20%20React/20.1_React/","title":"20.1 React","text":""},{"location":"20%20React/20.1_React/#_1","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u0430","text":"<pre><code>npm create vite@latest\n\nnpm i\n\nnpm run dev\n</code></pre>"},{"location":"20%20React/20.1_React/#_2","title":"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":"<ul> <li>React \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u0440\u043e\u0449\u0435 \u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u044b \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432</li> <li>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u044d\u0442\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 JSX</li> <li>JSX \u044d\u0442\u043e \u0441\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0441\u0430\u0445\u0430\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 React \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u0442 \u0432 JS</li> <li>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u043c\u043e\u0433\u0443\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435</li> </ul> <p>\u041f\u043b\u044e\u0441\u044b \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432</p> <ul> <li>\u041f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u043e\u0441\u0442\u044c</li> <li>\u0420\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u044c</li> <li>\u0423\u0434\u043e\u0431\u043d\u043e\u0435 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435</li> </ul>"},{"location":"20%20React/20.1_React/#props","title":"Props","text":"<ul> <li>Props \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438</li> <li>\u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e \u043f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b</li> </ul> <code>App.jsx</code> <code>JournalItem.jsx</code> <pre><code>import JournalItem from \"./JournalItem\";\n\nfunction App() {\n  const data = [\n    {\n      title: \"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0443\u0440\u0441\u043e\u0432\",\n      date: new Date(),\n      text: \"\u0413\u043e\u0440\u043d\u044b\u0435 \u043f\u043e\u0445\u043e\u0434\u044b \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u044e\u0442 \u0443\u0434\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0440\u043e\u0434\u043d\u044b\u0435 \u043b\u0430\u043d\u0434\u0448\u0430\u0444\u0442\u044b\",\n    },\n    {\n      title: \"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0443\u0440\u0441\u043e\u04322\",\n      date: new Date(),\n      text: \"\u0413\u043e\u0440\u043d\u044b\u0435 \u043f\u043e\u0445\u043e\u0434\u044b 222 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u044e\u0442 \u0443\u0434\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0440\u043e\u0434\u043d\u044b\u0435 \u043b\u0430\u043d\u0434\u0448\u0430\u0444\u0442\u044b\",\n    },\n  ];\n\n  return (\n    &lt;&gt;\n      &lt;JournalItem\n        title={data[0].title}\n        text={data[0].text}\n        date={data[0].date}\n      /&gt;\n    &lt;/&gt;\n  );\n}\n</code></pre> <pre><code>  function JournalItem({ title, text, date }) {\n  const formatedDate = new Intl.DateTimeFormat(\"ru-RU\").format(date);\n\n  return (\n    &lt;div className=\"journal-item\"&gt;\n      &lt;h2 className=\"journal-item__header\"&gt;{title}&lt;/h2&gt;\n      &lt;h2 className=\"journal-item__body\"&gt;\n        &lt;div className=\"journal-item__date\"&gt;{formatedDate}&lt;/div&gt;\n        &lt;div className=\"journal-item__text\"&gt;{text}&lt;/div&gt;\n      &lt;/h2&gt;\n    &lt;/div&gt;\n  );\n}\n\nexport default JournalItem;\n</code></pre>"},{"location":"20%20React/20.1_React/#_3","title":"\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u0439","text":"<pre><code>function Button({ children, onClick }) {\n    console.log('Button');\n    return (\n        &lt;button className='button accent' onClick={onClick}&gt;{children}&lt;/button&gt;\n    );\n}\n</code></pre>"},{"location":"20%20React/20.1_React/#usestate","title":"useState","text":"<ul> <li>\u042d\u0442\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043a\u043e\u0440\u0442\u0435\u0436 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f</li> <li>\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u043d\u0430 \u0441\u0440\u0430\u0437\u0443, \u0430 \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u043a \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044e react'\u043e\u043c</li> <li>\u041f\u0440\u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u043c \u0440\u0435\u043d\u0434\u0438\u0440\u0435\u043d\u0433\u0435 useState \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u0441\u0432\u0430\u0438\u0432\u0430\u0442\u044c \u0434\u0435\u0444\u043e\u043b\u0442\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435</li> </ul> <pre><code>  const [text, setText] = useState(\"Save\");\n\n  // \u0414\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \"\u0441\u0442\u0430\u0440\u043e\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f\"\n  setText(oldText =&gt; oldText + \"!\");\n</code></pre>"},{"location":"20%20React/20.1_React/#usereducer","title":"useReducer","text":"<ul> <li>useReducer() \u044d\u0442\u043e \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u0430 useState() \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0434\u0430\u0435\u0442 \u0431\u043e\u043b\u044c\u0448\u0438\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043d\u0430\u0434 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435\u043c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0438 \u0443\u043f\u0440\u043e\u0449\u0430\u0435\u0442 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435</li> <li>\u0412\u0441\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u044b \u043c\u043e\u0436\u043d\u043e \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0438 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e useState()</li> </ul> <pre><code>function reducer(state, action) {\n  switch (action.type) {\n    case 'ADD': return { count: state.count + 1 };\n    case 'SUB': return { count: state.count - 1 };\n    default: return state;\n  }\n}\n\nfunction Counter() {\n  const [state, dispatch] = React.useReducer(reducer, { count: 0 });\n  return (\n    &lt;&gt;\n      \u0418\u0442\u043e\u0433\u043e: {state.count}\n      &lt;button onClick={() =&gt; dispatch({type: 'ADD'})}&gt;\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c&lt;/button&gt;\n      &lt;button onClick={() =&gt; dispatch({type: 'SUB'})}&gt;\u0412\u044b\u0447\u0435\u0441\u0442\u044c&lt;/button&gt;\n    &lt;/&gt;\n  );\n}\n</code></pre>"},{"location":"20%20React/20.1_React/#usecontext","title":"useContext","text":"<ul> <li>\u041e\u0431\u044b\u0447\u043d\u043e \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f, \u0435\u0441\u043b\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u0434\u0430\u043d\u043d\u044b\u0445 \u0432\u043e \u043c\u043d\u043e\u0433\u0438\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u0445 \u043d\u0430 \u0440\u0430\u0437\u043d\u044b\u0445 \u0443\u0440\u043e\u0432\u043d\u044f\u0445 \u0432\u043b\u043e\u0436\u0435\u043d\u043d\u043e\u0441\u0442\u0438.</li> <li>\u041f\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0435\u0433\u043e, \u0442\u0430\u043a \u043a\u0430\u043a \u044d\u0442\u043e \u0443\u0441\u043b\u043e\u0436\u043d\u044f\u0435\u0442 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432.</li> <li>\u0427\u0442\u043e\u0431\u044b \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u044b \u0445\u043e\u0442\u0438\u043c \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c, \u043c\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u043d\u0430\u0447\u0430\u0442\u044c \u0441 \u043f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a\u0430 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 ().</li> <li>\u0417\u0430\u0442\u0435\u043c \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b\u044c \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 (), \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0437\u0430\u0445\u0432\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u044d\u0442\u0438 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0438\u0445 \u0442\u0430\u043c, \u0433\u0434\u0435 \u043e\u043d\u0438 \u0432\u044b\u0437\u044b\u0432\u0430\u044e\u0442\u0441\u044f.</li> </ul> <pre><code>const { userId } = UserContext(UserContext);\n</code></pre>"},{"location":"20%20React/20.1_React/#_4","title":"\u041f\u0440\u043e\u0441\u0442\u0430\u044f \u0434\u0435\u043a\u043e\u043c\u043f\u043e\u0437\u0438\u0446\u0438\u044f \u043d\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":"<code>App.jsx</code> <pre><code>function App() {\n    return (\n        &lt;div className='app'&gt;\n            &lt;LeftPanel&gt;\n                &lt;Header/&gt;\n                &lt;JournalAddButton/&gt;\n                &lt;JournalList/&gt;\n            &lt;/LeftPanel&gt;\n            &lt;Body&gt;\n                &lt;JournalForm/&gt;\n            &lt;/Body&gt;\n        &lt;/div&gt;\n    );\n}\n</code></pre>"},{"location":"20%20React/20.1_React/#_5","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0444\u043e\u0440\u043c\u0430\u043c\u0438","text":"<code>JournalForm.jsx</code> <pre><code>function JournalForm() {\n\n    const addJournalItem = (e) =&gt; {\n        e.preventDefault();\n        const formData = new FormData(e.target);\n        const formProps = Object.fromEntries(formData);\n        // \u041c\u0435\u0442\u043e\u0434 Object.fromEntries() static \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0430\u0440 \u043a\u043b\u044e\u0447-\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0432 \u043e\u0431\u044a\u0435\u043a\u0442.\n        console.log('submit');\n    };\n\n    return (\n        &lt;form className={styles['journal-form']} onSubmit={addJournalItem}&gt;\n            &lt;input type=\"text\" placeholder=\"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a\" onChange={inputChange}/&gt;\n            &lt;textarea&gt;&lt;/textarea&gt;\n            &lt;Button&gt;\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c&lt;/Button&gt;\n        &lt;/form&gt;\n    );\n}\n</code></pre>"},{"location":"20%20React/20.1_React/#_6","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441\u043e \u0441\u043f\u0438\u0441\u043a\u043e\u043c \u0434\u0430\u043d\u043d\u044b\u0445","text":"<code>App.jsx</code> <pre><code>function App() {\n    const data = [\n        {   \n            id : 1,\n            title: \"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0443\u0440\u0441\u043e\u0432\",\n            date: new Date(),\n            text: \"\u0413\u043e\u0440\u043d\u044b\u0435 \u043f\u043e\u0445\u043e\u0434\u044b \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u044e\u0442 \u0443\u0434\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0440\u043e\u0434\u043d\u044b\u0435 \u043b\u0430\u043d\u0434\u0448\u0430\u0444\u0442\u044b\",\n        },\n        {\n            id : 2,\n            title: \"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0443\u0440\u0441\u043e\u04322\",\n            date: new Date(),\n            text: \"\u0413\u043e\u0440\u043d\u044b\u0435 \u043f\u043e\u0445\u043e\u0434\u044b 222 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u044e\u0442 \u0443\u0434\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0440\u043e\u0434\u043d\u044b\u0435 \u043b\u0430\u043d\u0434\u0448\u0430\u0444\u0442\u044b\",\n        },\n        ];\n        return (\n        &lt;&gt;\n            {data.sort(sortItems).map(el =&gt; (\n                &lt;JournalItem key={el.id}\n                    title={el.title}\n                    text={el.text}\n                    date={el.date}\n                /&gt;\n            ))}\n        &lt;/&gt;\n    );\n}\n</code></pre> <p>Note</p> <p>key \u044d\u0442\u043e \u0432\u0430\u0436\u043d\u044b\u0439 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u0441\u043f\u0438\u0441\u043a\u0430 \u041a\u043b\u044e\u0447\u0438 \u043f\u043e\u043c\u043e\u0433\u0430\u044e\u0442 React \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0442\u044c, \u043a\u0430\u043a\u0438\u0435 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u0431\u044b\u043b\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u044b, \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0438\u043b\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u044b.</p>"},{"location":"20%20React/20.1_React/#jsx","title":"\u0423\u0441\u043b\u043e\u0432\u043d\u044b\u0439 \u0440\u0435\u043d\u0434\u0435\u0440 \u0432 JSX","text":"<pre><code>condition &amp;&amp; &lt;JSX /&gt; \u0440\u0435\u043d\u0434\u0435\u0440\u0438\u0442 &lt;JSX /&gt; \u0435\u0441\u043b\u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u0435 condition \u0432\u0435\u0440\u043d\u0435\u0442 true\ncondition ? &lt;JsxTrue /&gt; : &lt;JsxFalse /&gt; \u0440\u0435\u043d\u0434\u0435\u0440\u0438\u0442 &lt;JsxTrue /&gt; \u0438\u043b\u0438 &lt;JsxFalse&gt; \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0442\u043e\u0433\u043e, \u0447\u0442\u043e \u0432\u0435\u0440\u043d\u0435\u0442 \u0443\u0441\u043b\u043e\u0432\u0438\u0435 condition.\n\n{items.length === 0 &amp;&amp; &lt;p&gt;\u0417\u0430\u043f\u0438\u0441\u0435\u0439 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442&lt;/p&gt;}\n{items.length &gt; 0 &amp;&amp; items.map(el =&gt; ())}\n</code></pre>"},{"location":"20%20React/20.1_React/#css","title":"\u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430 \u0441 CSS \u043c\u043e\u0434\u0443\u043b\u044f\u043c\u0438","text":"<pre><code>import styles from './JournalItem.module.css';\n\n&lt;img className={styles.image}&gt;\n</code></pre> <p>\u0411\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430 classNames \u041e\u0441\u043d\u043e\u0432\u043d\u0438\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u0433\u0434\u0430 \u043d\u0443\u0436\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043b\u0430\u0441\u0441\u044b \u043f\u043e \u0443\u0441\u043b\u043e\u0432\u0438\u044e</p> <pre><code>import classNames from 'classnames';\n\nclassName={classNames(styles['image'], {[styles['image--small']]: ifSmall})}\n</code></pre>"},{"location":"20%20React/20.1_React/#useeffect","title":"useEffect","text":"<ul> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u044d\u0442\u043e\u0442 \u0445\u0443\u043a, \u0432\u044b \u0433\u043e\u0432\u043e\u0440\u0438\u0442\u0435 React \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0447\u0442\u043e-\u0442\u043e \u043f\u043e\u0441\u043b\u0435 \u0440\u0435\u043d\u0434\u0435\u0440\u0430.</li> <li>React \u0437\u0430\u043f\u043e\u043c\u043d\u0438\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u044e (\u0442\u043e \u0435\u0441\u0442\u044c \u00ab\u044d\u0444\u0444\u0435\u043a\u0442\u00bb), \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u0432\u044b \u043f\u0435\u0440\u0435\u0434\u0430\u043b\u0438 \u0438 \u0432\u044b\u0437\u043e\u0432\u0435\u0442 \u0435\u0451 \u043f\u043e\u0441\u043b\u0435 \u0442\u043e\u0433\u043e, \u043a\u0430\u043a \u0432\u043d\u0435\u0441\u0451\u0442 \u0432\u0441\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 DOM.</li> <li>useEffect \u0433\u043e\u0432\u043e\u0440\u0438\u0442 \u0447\u0442\u043e \u043c\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0432\u044b\u0437\u0432\u0430\u0442\u044c \u043a\u0430\u043a\u043e\u0439 \u044d\u0442\u043e \u044d\u0444\u0444\u0435\u043a\u0442 \u043f\u0440\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u043d\u0430\u0448\u0438\u0445 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439.</li> <li>\u0415\u0441\u043b\u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043f\u0443\u0441\u0442\u044b\u0435 \u0437\u043d\u0430\u0447\u0438\u0442 \u043e\u043d \u0431\u043e\u043b\u044c\u0448\u0435 \u043d\u0438\u043a\u043e\u0433\u0434\u0430 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0438\u0442\u044c\u0441\u044f.</li> </ul> <pre><code>const [items, setItems] = useState([]);\n\nconst data = JSON.parse(localStorage.getItem('data'));\n\nif (data) {\n    setItems(data);\n}\n</code></pre> <p>Warning</p> <p>\u0422\u0430\u043a\u0430\u044f \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f \u0432\u044b\u0437\u043e\u0432\u0435\u0442 \u0431\u0435\u0441\u043a\u043e\u043d\u0435\u0447\u043d\u044b\u0439 \u0440\u0435\u0440\u0435\u043d\u0434\u0438\u043d\u0433 \u0414\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u044d\u0442\u043e \u043d\u0435 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u043b\u043e, \u043d\u0443\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c useEffect</p> <pre><code>useEffect(() =&gt; {\n    console.log('useEffect');\n    }, [items]);\n</code></pre>"},{"location":"20%20React/20.1_React/#footer","title":"\u041f\u0440\u0438\u0436\u0430\u0442\u044b\u0439 footer","text":"<code>main.html</code> <code>main.css</code> <pre><code>&lt;html&gt;\n&lt;body&gt;\n\n&lt;div class=\"wrapper\"&gt;\n\n  &lt;div class=\"content\"&gt;&lt;/div&gt;\n\n  &lt;div class=\"footer\"&gt;&lt;/div&gt;\n\n&lt;/div&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <pre><code>html,\nbody {\n  height: 100%;\n}\n.wrapper {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n.content {\n  flex: 1 0 auto;\n}\n.footer {\n  flex: 0 0 auto;\n}\n</code></pre>"},{"location":"20%20React/20.2_useState/","title":"20.2 useState","text":""},{"location":"20%20React/20.2_useState/#usestate","title":"\u041a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 useState","text":"<p>\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0441\u0442\u0430\u0440\u0442\u0443\u0435\u0442 \u043e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0432 \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0442 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 (\u043f\u043e \u0441\u0443\u0442\u0438 js \u0444\u0443\u043d\u043a\u0446\u0438\u044e)</p> <p>\u0421\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u043e\u0431\u044a\u0435\u043a\u0442 saved \u0441 \u0444\u0443\u043d\u043a\u0446\u0438\u0435\u0439 \u0438 \u0434\u0430\u043d\u043d\u044b\u043c\u0438</p> <p>\u0414\u0430\u043b\u0435\u0435 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f fn</p> <p>\u041f\u0440\u0438 \u0432\u044b\u0437\u043e\u0432\u0435 \u0432\u043d\u0443\u0442\u0440\u0438 \u043d\u0435\u0451 \u0432\u0441\u0451 \u0435\u0449\u0451 \u0431\u0443\u0434\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a componentFn \u0438 saved, \u043f\u043e\u0441\u043a\u043e\u043b\u044c\u043a\u0443 \u043e\u043d\u0438 \u0431\u044b\u043b\u0438 \u0432 \u043e\u0431\u043b\u0430\u0441\u0442\u0438 \u0432\u0438\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 fn.</p> <p>connect.now: \u0445\u0440\u0430\u043d\u0438\u0442 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430, \u0447\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u043d\u0438\u044f \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0432\u044b\u0437\u043e\u0432\u0430\u043c\u0438.</p> <p>\u0418 \u0434\u0430\u043b\u0435\u0435 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0441\u0430\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442</p> <code>index.html</code> <code>index.html</code> <pre><code>    function connect (componentFn) {\n        const saved = {\n            fn () {\n                connect.now = Object.assign(saved, { context: this, args: arguments, slot: 0 });\n\n                const returnValue = componentFn.apply(this, arguments);\n\n                delete connect.now;\n\n                return returnValue;\n            },\n            data: []\n        };\n\n        return saved.fn;\n    }\n</code></pre> <pre><code>    function Example() {\n      // Declare a new state variable, which we'll call \"count\"\n      const [count1, setCount1] = useState(0);\n      const [count2, setCount2] = useState(0);\n\n      document.body.innerHTML = `\n        &lt;div&gt;\n          &lt;p&gt;You clicked ${count1} times&lt;/p&gt;\n          &lt;p&gt;You clicked ${count2} times&lt;/p&gt;\n          &lt;button id=\"bt1\"&gt;Click me1&lt;/button&gt;\n          &lt;button id=\"bt2\"&gt;Click me2&lt;/button&gt;\n        &lt;/div&gt;\n      `;\n\n      document.getElementById('bt1').onclick = () =&gt; setCount1(count1 + 1);\n      document.getElementById('bt2').onclick = () =&gt; setCount2(count2 + 1);\n    }\n</code></pre> <p>\u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0441 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\u043c \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e</p> <p>\u041e\u0431\u044a\u0435\u043a\u0442 saved \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0438\u0437 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0439 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0438\u0306</p> <p>\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0441\u043b\u043e\u0442\u0430 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043d\u0430 \u0442\u043e \u043a\u0430\u043a\u043e\u0439 \u0440\u0430\u0437 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f useState \u0432\u043d\u0443\u0442\u0440\u0438 \u044d\u0442\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430</p> <p>\u0421\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f setValue, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u0437\u044b\u0432\u0430\u0442\u044c\u0441\u044f \u043f\u0440\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f</p> <p>\u041a\u043e\u0433\u0434\u0430 \u043e\u043d\u0430 \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u0437\u0432\u0430\u043d\u0430 \u0443 \u043d\u0435\u0435 \u0431\u0443\u0434\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a saved \u0438 slot, \u043e\u043d\u0430 \u0438\u0437\u043c\u0435\u043d\u0438\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0438 \u0434\u0430\u043b\u044c\u0448\u0435 \u0432\u044b\u0437\u043e\u0432\u0435\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u044e fn \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0437\u0430\u043d\u043e\u0433\u043e \u043f\u0435\u0440\u0435\u0440\u0435\u043d\u0434\u0435\u0440\u0438\u0442 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442</p> <code>index.html</code> <pre><code>    function useState (value) {\n        const saved = connect.now;\n        const { slot } = Object(saved);\n\n        if (saved) {\n            ++saved.slot;\n\n            value = slot in saved.data\n                ? saved.data[slot]\n            : saved.data[slot] = value;\n        }\n\n        return [ value, setValue ];\n\n        function setValue (newValue) {\n            if (saved) {\n                saved.data[slot] = newValue;\n\n                saved.fn.apply(saved.context, saved.args);\n            }\n        }\n    }\n</code></pre> <p>\u0412\u044b\u0437\u043e\u0432 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u0438</p> <code>index.html</code> <pre><code>    connect(Example)();\n</code></pre> <p>Info</p> <pre><code>\u0415\u0441\u043b\u0438 \u043d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c this \u0442\u043e \u0432\u0441\u0435 \u0442\u0430\u043a \u0436\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0432 \u043c\u043e\u0435\u043c \u043f\u0440\u0438\u043c\u0435\u0440\u0435, \u0441\u043a\u043e\u0440\u0435\u0435 \u0432\u0441\u0435\u0433\u043e \n\u044d\u0442\u043e \u043d\u0443\u0436\u043d\u043e \u043a\u043e\u0433\u0434\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0432\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0438 \u0442.\u043f.\n</code></pre>"},{"location":"en/","title":"Index","text":"hey there  <p> About Me</p> <p>I am a DevOps engineer from Saint-Petersburg</p> <p>\u2705 Completed courses:</p> <ul> <li>KodeKloud - Certified Kubernetes Application Developer (CKAD)</li> <li>Yandex practicum - DevOps</li> <li>ITMO - DevOps engineer</li> <li>Yandex practicum - Algorithm and data structure</li> <li>MIPT - Deep Learning School</li> </ul> <p>\ud83d\udc36 Pet projects:</p> <ul> <li>Golang - telegrambot dockerization and grpc integration</li> <li> <p>Deep learning - deploy Convolutional neural network in Heroku</p> </li> <li> <p> How to reach me:  </p> </li> </ul> <p> Languages and Tools:</p>"},{"location":"","title":"Home","text":"hey there  <p> About Me</p> <p>I am a DevOps engineer from Saint-Petersburg</p> <p>\u2705 Completed courses:</p> <ul> <li>KodeKloud - Certified Kubernetes Application Developer (CKAD)</li> <li>Yandex practicum - DevOps</li> <li>ITMO - DevOps engineer</li> <li>Yandex practicum - Algorithm and data structure</li> <li>MIPT - Deep Learning School</li> </ul> <p>\ud83d\udc36 Pet projects:</p> <ul> <li>Golang - telegrambot dockerization and grpc integration</li> <li> <p>Deep learning - deploy Convolutional neural network in Heroku</p> </li> <li> <p> How to reach me:  </p> </li> </ul> <p> Languages and Tools:</p>"},{"location":"03%20IaC/3.1_YandexCloud/","title":"3.1 Yandex cloud","text":""},{"location":"03%20IaC/3.1_YandexCloud/#cli-yandex-cloud","title":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 CLI yandex cloud","text":"<p>\u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f</p> <pre><code>curl -sSL https://storage.yandexcloud.net/yandexcloud-yc/install.sh | bash\n\nyc init\n\nyc config list\n</code></pre>"},{"location":"03%20IaC/3.1_YandexCloud/#_1","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0435\u0442\u0438","text":"<pre><code># \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043a\u043e\u043c\u0430\u043d\u0434 CLI \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u043e\u0431\u043b\u0430\u0447\u043d\u044b\u043c\u0438 \u0441\u0435\u0442\u044f\u043c\u0438:\nyc vpc network --help\n\n# \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043e\u0431\u043b\u0430\u0447\u043d\u0443\u044e \u0441\u0435\u0442\u044c \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c \u0432 \u0432\u0430\u0448\u0435\u043c \u043f\u0440\u043e\u0444\u0438\u043b\u0435 CLI:\nyc vpc network create \\\n  --name my-yc-network \\\n  --labels my-label=my-value \\\n  --description \"my first network via yc\"\n\n# \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043f\u043e\u0434\u0441\u0435\u0442\u044c \u0432 \u043e\u0431\u043b\u0430\u0447\u043d\u043e\u0439 \u0441\u0435\u0442\u0438 my-yc-network\nyc vpc subnet create \\\n  --name my-yc-subnet-a \\\n  --zone ru-central1-a \\\n  --range 10.1.2.0/24 \\\n  --network-name my-yc-network \\\n  --description \"my first subnet via yc\"\n\n# \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u0435 \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u043e\u0431\u043b\u0430\u0447\u043d\u044b\u0445 \u0441\u0435\u0442\u0435\u0439 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c \u0432 \u0432\u0430\u0448\u0435\u043c \u043f\u0440\u043e\u0444\u0438\u043b\u0435 CLI\nyc vpc network list\n\nyc vpc network list --format yaml\n</code></pre>"},{"location":"03%20IaC/3.1_YandexCloud/#_2","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0412\u041c","text":"<pre><code># \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u0412\u041c Linux\nyc compute instance create \\\n  --name my-yc-instance \\\n  --network-interface subnet-name=my-yc-subnet-a,nat-ip-version=ipv4 \\\n  --zone ru-central1-a \\\n  --ssh-key ~/.ssh/id_ed25519.pub\n\n# \u0423\u0437\u043d\u0430\u0439\u0442\u0435 \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0439 IP-\u0430\u0434\u0440\u0435\u0441 \u0412\u041c. \u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0432\u0430\u0448\u0435\u0439 \u0412\u041c\nyc compute instance get my-yc-instance\n\n# \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f\nssh yc-user@xxx.xxx.xxx.xxx\n</code></pre>"},{"location":"03%20IaC/3.1_YandexCloud/#_3","title":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0412\u041c, \u0441\u0435\u0442\u044c \u0438 \u043f\u043e\u0434\u0441\u0435\u0442\u044c","text":"<pre><code>yc compute instance delete my-yc-instance\n\nyc vpc subnet delete my-yc-subnet-a\n\nyc vpc network delete my-yc-network\n</code></pre>"},{"location":"03%20IaC/3.1_YandexCloud/#_4","title":"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u0442\u043e\u043a\u0435\u043d","text":"<pre><code>export YC_TOKEN=\"$(yc iam create-token)\"\n</code></pre>"},{"location":"03%20IaC/3.1_YandexCloud/#gitlab-ci-pipeline","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0432 gitlab-ci pipeline","text":"<ul> <li>\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e YC_SERVICE_ACCOUNT_KEY_FILE</li> </ul>"},{"location":"03%20IaC/3.2_Terraform/","title":"3.2 Terraform","text":""},{"location":"03%20IaC/3.2_Terraform/#terraform","title":"\u0417\u043d\u0430\u043a\u043e\u043c\u0441\u0442\u0432\u043e \u0441 Terraform","text":"<ul> <li>\u0418\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442 \u0434\u043b\u044f \u0434\u0435\u043a\u043b\u0430\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b</li> <li>\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0445 .tf-\u0444\u0430\u0439\u043b\u0430\u0445</li> <li>State<ul> <li>\u0412\u0430\u0448\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u043d\u0435 \u0437\u043d\u0430\u044e\u0442 \u043e \u0442\u043e\u043c \u0447\u0442\u043e \u043e\u043d\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u044b \u0447\u0435\u0440\u0435\u0437 \u0442\u0435\u0440\u0440\u0430\u0444\u043e\u0440\u043c</li> <li>\u0422\u0435\u0440\u0440\u0430\u0444\u043e\u0440\u043c \u0431\u0435\u0437 state'a \u043d\u0435 \u0437\u043d\u0430\u0435\u0442 \u043d\u0438\u0447\u0435\u0433\u043e \u043e \u0432\u0430\u0448\u0435\u0439 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0435</li> </ul> </li> </ul> <pre><code>terraform -h\n\nterraform init\nterraform plan\nterraform apply\nterraform destroy\nterraform show\n</code></pre> <p>Note</p> <p>\u041f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440 \u044d\u0442\u043e \u0443\u0436\u0435 \u043a\u0435\u043c \u0442\u043e \u043d\u0430\u043f\u0438\u0441\u0430\u043d\u043d\u0430\u044f \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0430 \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u0430\u043c \u043d\u0430 \u044f\u0437\u044b\u043a\u0435 \u0422\u0435\u0440\u0440\u0430\u0444\u043e\u0440\u043c\u0430 \u043e\u0431\u0449\u0430\u0442\u044c\u0441\u044f \u0441 \u043a\u0430\u043a\u043e\u0439 \u0442\u043e \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 \u0433\u0434\u0435 \u0432\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0434\u0435\u043b\u0430\u0442\u044c \u0441\u0432\u043e\u044e \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443</p> <pre><code>provider \"name\" {\n    key = value\n}\n\nresource \"type\" \"name\" {\n    key = value\n}\n\nvariable \"name\" {\n    type = \"\"\n    default = \"\"\n}\n</code></pre>"},{"location":"03%20IaC/3.2_Terraform/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>terraform validate</li> <li>terraform console</li> <li>TF_LOG=\"DEBUG\"</li> <li>TF_LOG_FILE</li> </ul>"},{"location":"03%20IaC/3.2_Terraform/#_1","title":"\u041c\u0435\u0442\u0430 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b","text":"<p>\u0423 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430 \u0441\u0432\u043e\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u0438 \u0443 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u0430 \u0441\u0432\u043e\u0439 \u043d\u0430\u0431\u043e\u0440 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432</p> <p>\u041d\u043e \u0435\u0441\u0442\u044c \u043e\u0431\u0449\u0438\u0435 \u043c\u0435\u0442\u0430 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b</p> <ul> <li>provisioner (\u0437\u0430\u043f\u0443\u0441\u043a \u0447\u0435\u0433\u043e \u0442\u043e \u0441\u0440\u0430\u0437\u0443 \u043f\u043e\u0441\u043b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 ansible (\u043b\u0443\u0447\u0448\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c cloud init))</li> <li>depends_on (\u043d\u0435\u044f\u0432\u043d\u044b\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432)</li> <li>count (\u0441\u0447\u0435\u0442\u0447\u0438\u043a \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432)</li> <li>for_each (\u0446\u0438\u043a\u043b\u044b \u0441 \u0440\u0430\u0437\u043d\u044b\u043c\u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u043c\u0438)</li> <li>provider</li> <li>lifecycle (\u0412\u043d\u0443\u0442\u0440\u0438 \u0431\u043b\u043e\u043a\u0430 lifecycle \u0438\u043c\u0435\u044e\u0442\u0441\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b create_before_destroy, prevent_destroy, ignore_changes, \u0438 replace_triggered_by.)</li> </ul>"},{"location":"03%20IaC/3.2_Terraform/#_2","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0412\u041c \u043d\u0430 \u042f\u043d\u0434\u0435\u043a\u0441 \u041e\u0431\u043b\u0430\u043a\u0435","text":"<pre><code>export YC_TOKEN=\"$(yc iam create-token)\"\n</code></pre> <code>main.tf</code> <code>terraform.tfvars</code> <code>variables.tf</code> <pre><code>terraform {\n  required_providers {\n    yandex = {\n      source = \"yandex-cloud/yandex\"\n    }\n  }\n}\n\nprovider \"yandex\" {\n  cloud_id = var.cloud_id\n  folder_id = var.folder_id\n  zone = var.zone\n  # token = var.yc_token\n}\n\nresource \"yandex_compute_instance\" \"vm-1\" {\n  name = \"terraform1\"\n\n  resources {\n    cores = 2\n    memory = 2\n  }\n\n  boot_disk {\n    initialize_params {\n      image_id = var.image_id\n    }\n  }\n\n  network_interface {\n    subnet_id = yandex_vpc_subnet.subnet-1.0.id\n    nat = true # \u0447\u0442\u043e\u0431\u044b \u043c\u0430\u0448\u0438\u043d\u0435 \u0431\u044b\u043b \u0432\u044b\u0434\u0430\u043d \u0432\u043d\u0435\u0448\u043d\u0438\u0439 IP-\u0430\u0434\u0440\u0435\u0441\n  }\n\n  metadata = {\n    ssh-keys = \"ubuntu:${file(\"~/.ssh/id_rsa.pub\")}\"\n  }\n\n  lifecycle {\n    prevent_destroy = true\n    ignore_changes = [boot_disk]\n  }\n\n}\n\nresource \"yandex_vpc_network\" \"network-1\" {\n  name = \"network1\"\n}\n\nresource \"yandex_vpc_subnet\" \"subnet-1\" {\n  count = 3\n  name = \"subnet-${count.index}\"\n  zone = \"ru-central1-a\"\n  network_id = yandex_vpc_network.network-1.id\n  v4_cidr_blocks = [\"192.168.${count.index+10}.0/24\"]\n}\n\noutput \"internal_ip_address_vm_1\" {\n  value = yandex_compute_instance.vm-1.network_interface.0.ip_address\n}\n\noutput \"external_ip_address_vm_1\" {\n  value = yandex_compute_instance.vm-1.network_interface.0.nat_ip_address\n}\n</code></pre> <pre><code>zone = \"ru-central1-a\"\nfolder_id = \"xxxxxx\"\ncloud_id = \"xxxxxx\"\nimage_id = \"fd8tkfhqgbht3sigr37c\"\n</code></pre> <pre><code>variable \"zone\"{\n  type = string\n}\n\nvariable \"cloud_id\"{\n  type = string\n}\n\nvariable \"folder_id\"{\n  type = string\n}\n\nvariable \"image_id\"{\n  type = string\n}\n\n# variable \"yc_token\"{\n  # type = string\n# }\n</code></pre>"},{"location":"03%20IaC/3.2_Terraform/#_3","title":"\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b","text":"<ul> <li>local</li> <li>random</li> <li>null</li> </ul> main.tf<pre><code>resource \"random_password\" \"rnd\" {\n  length = 16\n}\n\noutput \"password\" {\n  value = random_password.rnd.result\n  sensitive = true\n}\n</code></pre>"},{"location":"03%20IaC/3.2_Terraform/#_4","title":"\u0421\u0442\u0440\u043e\u043a\u043e\u0432\u044b\u0435 \u0448\u0430\u0431\u043b\u043e\u043d\u044b","text":"<p>\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u043c\u043e\u0436\u043d\u043e \u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u043d\u0432\u0435\u043d\u0442\u043e\u0440\u0438 \u0434\u043b\u044f \u0430\u043d\u0441\u0438\u0431\u043b\u0430</p> <code>hosts.tpl</code> <code>variables.tf</code> <code>main.tf</code> <pre><code>[lbs]\n%{ for i in range(length(names)) ~}\n%{ if names[i] ==  \"lb\" ~}\n${names[i]} ansible_host=${addrs[i]} ansible_user=${user}\n%{ endif ~}\n%{ endfor ~}\n\n[apps]\n%{ for i in range(length(names)) ~}\n%{ if split(\"-\", names[i])[0] ==  \"app\" ~}\n${names[i]} ansible_host=${addrs[i]} ansible_user=${user}\n%{ endif ~}\n%{ endfor ~}\n</code></pre> <pre><code>variable \"instances\" {\n  type = list(string)\n  default = [\n    \"app-1\",\n    \"app-2\",\n    \"lb\"\n  ]\n}\n\nvariable \"user\" {\n  type    = string\n  default = \"ubuntu\"\n}\n</code></pre> <pre><code>resource \"yandex_compute_instance\" \"vm-app\" {\n  for_each = toset(var.instances)\n  name     = each.key\n\n  allow_stopping_for_update = true\n  scheduling_policy {\n    preemptible = true\n  }\n\n  resources {\n    core_fraction = 5\n    cores         = 2\n    memory        = 4\n  }\n\n  boot_disk {\n    initialize_params {\n      image_id = var.image_id\n    }\n  }\n\n  network_interface {\n    subnet_id = var.subnet_id\n    nat       = true\n  }\n\n  metadata = {\n    ssh-keys = \"ubuntu:${file(\"~/.ssh/id_rsa.pub\")}\"\n  }\n\n  connection {\n    type        = \"ssh\"\n    host        = self.network_interface.0.nat_ip_address\n    user        = \"ubuntu\"\n    agent       = false\n    private_key = file(\"~/.ssh/id_rsa\")\n  }\n}\n\nlocals {\n  names = values(yandex_compute_instance.vm-app)[*].name\n  ips   = values(yandex_compute_instance.vm-app)[*].network_interface.0.nat_ip_address\n}\n\nresource \"local_file\" \"ansible_inventory\" {\n  content = templatefile(\"hosts.tpl\", {\n      names = local.names,\n      addrs = local.ips,\n      user = var.user\n  })\n  filename = \"inventory\"\n}\n</code></pre>"},{"location":"03%20IaC/3.2_Terraform/#_5","title":"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0442\u0435\u0439\u0442\u043e\u043c","text":"<ul> <li>\u0425\u0440\u0430\u043d\u0435\u043d\u0438\u0435 state \u0432 s3</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438 \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043f\u0435\u0440\u0435\u0437\u0430\u0442\u0438\u0440\u0430\u043d\u0438\u044f</li> <li>\u041c\u043e\u0436\u043d\u043e \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c remote state \u043a\u0430\u043a data source</li> </ul>"},{"location":"03%20IaC/3.2_Terraform/#data-sources","title":"Data-sources","text":"<ul> <li>\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0434\u0440\u0443\u0433\u0438\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u0445 \u0432 \u043e\u0431\u043b\u0430\u043a\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0435 \u043d\u0430\u043c\u0438</li> </ul> <code>prod/main.tf</code> <pre><code>data \"yandex_vpc_network\" \"default\" {\n    name = var.network_name\n}\n</code></pre>"},{"location":"03%20IaC/3.2_Terraform/#_6","title":"\u041c\u043e\u0434\u0443\u043b\u0438","text":"<code>modules/app/main.tf</code> <code>prod/main.tf</code> <pre><code>resource \"google_compute_instance\" \"app\" {\n    name = \"example-instance-${count.index + 1}\"\n    machine_type = \"f1-micro\"\n    count = var.instances_count\n    boot_disk {\n        initialize_params {\n            image = var.app_image\n        }\n    }\n    network_interface {\n        network = \"default\"\n        access_config {}\n    }\n}\n</code></pre> <pre><code>module \"app\" {\n    source = \"../modules/app/main.tf\"\n    instances_count = 2\n    app_image = \"myapp-centos-8\"\n}\n</code></pre>"},{"location":"03%20IaC/3.2_Terraform/#depends_on","title":"depends_on","text":"<ul> <li>\u0421\u043f\u0438\u0441\u043e\u043a \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0438 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 \u043e\u0442 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0440\u0435\u0441\u0443\u0440\u0441 \u0438\u043b\u0438 \u043c\u043e\u0434\u0443\u043b\u044c</li> <li>\u0423\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0435\u0441\u043b\u0438 \u043d\u0435\u043b\u044c\u0437\u044f \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0430\u0433\u0440\u0443\u043c\u0435\u043d\u0442 \u0437\u0430\u0432\u0438\u0441\u044f\u0449\u0438\u0439 \u043e\u0442 \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u0430</li> </ul>"},{"location":"03%20IaC/3.2_Terraform/#lifecycle","title":"lifecycle","text":"<ul> <li>create_before_destroy</li> <li>prevent_destroy (\u0437\u0430\u043f\u0440\u0435\u0442\u0438\u0442\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435)</li> <li>ignore_changes</li> </ul>"},{"location":"03%20IaC/3.2_Terraform/#provisioner","title":"provisioner","text":"<ul> <li>\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u0432\u044b\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0437\u0430 \u0440\u0430\u043c\u043a\u0438 \u0430\u043f\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432</li> <li>\u0422\u0430\u043a\u0436\u0435 \u0434\u043b\u044f \u043c\u043d\u043e\u0433\u0438\u0445 \u043e\u0431\u043b\u0430\u043a\u043e\u0432 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442 userdata, metadata</li> </ul> <code>prod/main.tf</code> <pre><code>resource \"aws_instance\" \"web\" {\n# ...\n\n  provisioner \"file\" {\n    source      = \"script.sh\"\n    destination = \"/tmp/script.sh\"\n  }\n\n  provisioner \"remote-exec\" {\n    inline = [\n      \"chmod +x /tmp/script.sh\",\n      \"/tmp/script.sh args\",\n    ]\n  }\n}\n</code></pre>"},{"location":"03%20IaC/3.3_Terragrunt/","title":"3.3 Terragrunt","text":""},{"location":"03%20IaC/3.3_Terragrunt/#_1","title":"\u041f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430","text":"<ul> <li>\u041e\u043d \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u043c\u043d\u043e\u0433\u043e\u0443\u0440\u043e\u0432\u043d\u0435\u0432\u044b\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438</li> <li>\u0420\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0442\u0435\u0440\u0440\u0430\u0444\u043e\u0440\u043c\u0430</li> <li>\u0421\u043b\u0435\u0434\u0443\u0435\u0442 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u0443 DRY (Don't Repeat Yourself)</li> </ul>"},{"location":"03%20IaC/3.3_Terragrunt/#_2","title":"\u041f\u0440\u0438\u043c\u0435\u0440","text":"<code>terraform.hcl</code> <code>yandex/terragrunt.hcl</code> <pre><code>locals {\n  servers = {\n    \"master\" = {\n      memory         = 4\n      cores          = 2\n      zone           = \"ru-central1-a\"\n      boot_disk_size = 20\n      boot_disk_type = \"network-ssd\"\n    }\n    \"slave\" = {\n      memory         = 4\n      cores          = 2\n      zone           = \"ru-central1-a\"\n      boot_disk_size = 20\n      boot_disk_type = \"network-ssd\"\n    }\n  }\n  s3_access_key = get_env(\"AWS_ACCESS_KEY_ID\")\n  s3_secret_key = get_env(\"AWS_SECRET_ACCESS_KEY\")\n  s3_bucket     = \"otus-tfstate\"\n  s3_region     = \"ru-central1\"\n\n  yc_token = get_env(\"YC_TOKEN\")\n  yc_cloud_id  = \"b1ga9aooiodscmmouobm\"\n  yc_folder_dev_id = \"b1g416evp4dl2eef88nt\"\n  yc_folder_test_id = \"b1gms5goflgecu065agg\"\n  yc_zone      = \"ru-central1-a\"\n\n}\n\ngenerate \"provider\" {\n  path      = \"provider_gen.tf\"\n  if_exists = \"overwrite\"\n  contents  = &lt;&lt;EOF\nprovider \"yandex\" {\n  token     = \"${local.yc_token}\"\n  cloud_id  = \"${local.yc_cloud_id}\"\n  folder_id = \"${local.yc_folder_dev_id}\"\n  zone      = \"${local.yc_zone}\"\n}\nprovider \"yandex\" {\n  alias     = \"test\"\n  token     = \"${local.yc_token}\"\n  cloud_id  = \"${local.yc_cloud_id}\"\n  folder_id = \"${local.yc_folder_test_id}\"\n  zone      = \"${local.yc_zone}\"\n}\nEOF\n}\n\ngenerate \"backend\" {\n  path      = \"backend_gen.tf\"\n  if_exists = \"overwrite\"\n  contents  = &lt;&lt;EOF\nterraform {\n  backend \"s3\" {\n    endpoint                    = \"storage.yandexcloud.net\"\n    bucket                      = \"${local.s3_bucket}\"\n    region                      = \"${local.s3_region}\"\n    key                         = \"${path_relative_to_include()}/terraform.tfstate\"\n    access_key                  = \"${local.s3_access_key}\"\n    secret_key                  = \"${local.s3_secret_key}\"\n    dynamodb_endpoint           = \"${local.dynamodb_endpoint}\"\n    dynamodb_table              = \"tfstate\"\n\n    skip_region_validation      = true\n    skip_credentials_validation = true\n  }\n}\nEOF\n}\n</code></pre> <pre><code>terraform {\n  source = \"../../../terraform/modules/yandex\"\n}\n\ninclude \"root\" {\n  path = find_in_parent_folders()\n  expose = true\n}\n\ndependency \"vpc\" {\n  config_path = \"../vpc\"\n  mock_outputs = {\n    vpc_id = \"dummy_vpc\"\n  }\n\n  mock_outputs_allowed_terraform_commands = [\"init\", \"validate\", \"plan\"]\n}\n\ninputs = {\n  servers      = include.root.locals.servers\n  vpc_id       = dependency.vpc.outputs.vpc_id\n  cidr_blocks  = [\"10.51.21.0/24\"]\n  network_name = \"test_network\"\n}\n</code></pre>"},{"location":"03%20IaC/3.4_Ansible/","title":"3.4 Ansible","text":""},{"location":"03%20IaC/3.4_Ansible/#ansible","title":"\u0417\u043d\u0430\u043a\u043e\u043c\u0441\u0442\u0432\u043e \u0441 Ansible","text":""},{"location":"03%20IaC/3.4_Ansible/#ansible_1","title":"\u0421\u0432\u043e\u0439\u0441\u0442\u0432\u0430 Ansible","text":"<ul> <li>\u0414\u0435\u043a\u043b\u0430\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c</li> <li>\u0418\u0434\u0435\u043c\u043f\u043e\u0442\u0435\u043d\u0442\u043d\u043e\u0441\u0442\u044c (\u043f\u0440\u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u043c \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u0434\u0430\u0432\u0430\u0442\u044c \u0442\u043e\u0442 \u0436\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442)</li> <li>\u041d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0430\u0433\u0435\u043d\u0442</li> </ul>"},{"location":"03%20IaC/3.4_Ansible/#ansible_2","title":"\u0417\u0430\u0434\u0430\u0447\u0438 Ansible","text":"<ul> <li>\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0441\u043e\u0444\u0442\u0430</li> <li>\u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u0438</li> <li>\u041c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u0443\u0435\u043c\u043e\u0441\u0442\u044c</li> </ul>"},{"location":"03%20IaC/3.4_Ansible/#4-ansible","title":"4 \u043a\u043e\u043d\u0446\u0435\u043f\u0446\u0438\u0438 Ansible","text":"<ul> <li>Inventory - \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043c\u0430\u0448\u0438\u043d\u0430\u0445 \u0432 \u0441\u0435\u0442\u0438</li> <li>Modules - \u043d\u0435\u043f\u043e\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u0447\u0442\u043e \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f</li> <li>Plugins - \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u044e\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0430\u043c\u043e\u0433\u043e Ansible (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 ssh)</li> <li>Api - \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f</li> </ul>"},{"location":"03%20IaC/3.4_Ansible/#_1","title":"\u041f\u0440\u043e\u0441\u0442\u044b\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430","text":"<p>\u0417\u0430\u043f\u0443\u0441\u043a \u043c\u043e\u0434\u0443\u043b\u044f \u043d\u0430 \u0432\u0441\u0435\u0445 \u0445\u043e\u0441\u0442\u0430\u0445 <pre><code>ansible all -i hosts.ini -m ping\n</code></pre> \u0417\u0430\u043f\u0443\u0441\u043a playbook <pre><code>ansible-playbook playbook.yml -i hosts.ini\n\nansible-playbook playbook.yml -i hosts.ini -K\n</code></pre></p>"},{"location":"03%20IaC/3.4_Ansible/#hostsini","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f hosts.ini","text":"<pre><code># \u0432\u0441\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043d\u0438\u0436\u0435 \u0432\u0445\u043e\u0434\u044f\u0442 \u0432 \u0433\u0440\u0443\u043f\u043f\u0443 all\n192.168.0.12\n192.168.0.14\n\n[debi_servers]\ndebi ansible_host=192.168.0.20 ansible_user=debiuser ansible_ssh_private_key_file=/home/debuser/.ssh/id_ed25519\ndebi2 ansible_host=192.168.0.32 ansible_user=debiuser ansible_ssh_private_key_file=/home/debuser/.ssh/id_ed25519\n\n# \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0439 \u043f\u0440\u0435\u0434 \u043f\u0440\u043e\u0434 \u0441\u0435\u0440\u0432\u0435\u0440 \u0431\u0430\u0437\n[staging_DB]\n192.168.0.1\n192.168.0.2\n\n# \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0439 \u043f\u0440\u0435\u0434 \u043f\u0440\u043e\u0434 \u0441\u0435\u0440\u0432\u0435\u0440 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439\n[staging_APP]\n192.168.0.5\n192.168.0.6\n\n# \u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u043c \u0433\u0440\u0443\u043f\u043f\u044b \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u0432 \u043e\u0434\u043d\u0443 \u0431\u043e\u043b\u0435\u0435 \u043a\u0440\u0443\u043f\u043d\u0443\u044e\n[staging_ALL:children]\nstaging_DB\nstaging_APP\n</code></pre>"},{"location":"03%20IaC/3.4_Ansible/#_2","title":"\u0412\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u0437\u0430\u0434\u0430\u043d\u0438\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445","text":"<code>host.ini</code> <code>playbook.yaml</code> <pre><code>192.168.0.1 test=123 testvar=['11', '22']\n\u0438\u043b\u0438\n[centos]\n192.168.0.1\n192.168.0.2\n[centos:vars]\ntest=123\n</code></pre> <pre><code>- name: Basic group\n  hosts: testvm\n  become: true\n  roles:\n    - testrole\n  vars:\n    test_var: test\n    version: 7.0\n\n  tasks:\n  - name: \"Test vars\"\n    ansible.builtin.debug:\n      msg: \"Variable is set to {{ test_var }} {{ ansible_date_time }}\"tasks\n</code></pre> <p>\u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0432\u043d\u0443\u0442\u0440\u0438 \u0440\u043e\u043b\u0438 \u043f\u0435\u0440\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043f\u043b\u0435\u0439\u0431\u0443\u043a\u0430</p> <ul> <li>\u041e\u0434\u043d\u0430 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f \u0432 \u043e\u0434\u043d\u043e\u043c \u043c\u0435\u0441\u0442\u0435</li> <li>\u041d\u0430\u0437\u044b\u0432\u0430\u0435\u043c \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0440\u043e\u043b\u0438/\u043f\u0430\u043a\u0435\u0442\u044b \u0432 \u0438\u043c\u044f</li> <li>\u0418\u0437\u0431\u0435\u0433\u0430\u0435\u043c \u043f\u0440\u043e\u0441\u0442\u044b\u0445 \u0438\u043c\u0451\u043d (server, host)</li> <li>ansible_facts - \u0444\u0430\u043a\u0442\u044b \u043e \u043c\u0430\u0448\u0438\u043d\u0430\u0445, \u043f\u0435\u0440\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e</li> </ul> \u0420\u0430\u0437\u0443\u043c\u043d\u0430\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u0430 \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u043e\u0432 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 <p>\u041f\u0440\u0438\u043c\u0435\u0440\u043d\u043e \u0442\u0430\u043a\u0430\u044f \u0436\u0435, \u043a\u0430\u043a\u00a0\u0442\u0443\u0442, \u043d\u043e \u0431\u0435\u0437 WTF'\u043e\u0432.</p> <ol> <li>Vars set on the command line -e foo=set_on_cmd_line</li> <li>Vars set in the vars_files: block in the play</li> <li>Vars set in the vars: block in the play</li> <li>Vars set in host_vars/</li> <li>Vars set in group_vars/</li> <li>Role default vars roles/.../defaults/main.yml</li> </ol>"},{"location":"03%20IaC/3.4_Ansible/#ping","title":"\u041f\u0440\u0438\u043c\u0435\u0440 ping","text":"<p>\u0418\u0437 \u043a\u043e\u043c\u0430\u043d\u0434\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 <pre><code>ansible all -i hosts.ini -m ping\n\nansible all -i hosts.ini --ask-pass -m ping\n</code></pre></p> <p>\u0421 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043f\u043b\u0435\u0439\u0431\u0443\u043a\u0430 playbook.yaml<pre><code>---\n- hosts: \"all\"\n  tasks:\n  - name: \"ping hosts\"\n    ansible.builtin.ping:\n</code></pre></p>"},{"location":"03%20IaC/3.4_Ansible/#lamp","title":"\u041f\u0440\u0438\u043c\u0435\u0440\u044b \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 LAMP \u0441\u0442\u0435\u043a\u0430","text":"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430 <code>hosts.ini</code> <code>ansible.cfg</code> <code>playbook.yml</code> <code>roles/nginx/tasks/main.yml</code> <code>roles/mysql/tasks/main.yml</code> <pre><code>\u251c\u2500\u2500 ansible.cfg\n\u251c\u2500\u2500 group_vars\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 all.yml\n\u251c\u2500\u2500 host_vars\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 testhost1\n\u251c\u2500\u2500 hosts.ini\n\u251c\u2500\u2500 playbook.yml\n\u251c\u2500\u2500 requirements.yml\n\u2514\u2500\u2500 roles\n    \u251c\u2500\u2500 mysql\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 tasks\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 main.yml\n    \u251c\u2500\u2500 nginx\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 files\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 html\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 index.html\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 tasks\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 main.yml\n    \u251c\u2500\u2500 php\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 files\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 test-php\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 nginx.conf\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 php-test\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u251c\u2500\u2500 index.php\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u2514\u2500\u2500 test-connection.php\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 tasks\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 main.yml\n    \u2514\u2500\u2500 testrole\n        \u251c\u2500\u2500 defaults\n        \u2502\u00a0\u00a0 \u2514\u2500\u2500 main.yml\n        \u2514\u2500\u2500 tasks\n            \u2514\u2500\u2500 main.yml\n</code></pre> <pre><code>[testvm]\ntesthost1 ansible_host=192.168.0.15 ansible_user=pk ansible_password=password\n\n[testansible]\ntesthost2 ansible_host=192.168.0.188 ansible_user=pk \n</code></pre> <pre><code>[default]\ninventory=./hosts.ini\n</code></pre> <pre><code>---\n- hosts: \"testansible\"\n  become: true\n  roles:\n    - nginx\n    - mysql\n    - php\n\n  tasks:\n    - name: \"Reload nginx\"\n      ansible.builtin.service:\n        name: \"nginx\"\n        state: \"reloaded\"\n</code></pre> <pre><code>---\n- name: \"Install nginx via apt\"\n  ansible.builtin.apt:\n    name: \"nginx\"\n    state: \"latest\"\n    update_cache: true\n\n- name: \"Delete /var/www/html folder\"\n  ansible.builtin.file:\n    path: \"/var/www/html\"\n    state: \"absent\"\n\n- name: \"Copy our landing to /var/www/html folder\"\n  ansible.builtin.copy:\n    src: \"files/html\"\n    dest: \"/var/www\"\n    owner: \"pk\"\n    group: \"pk\"\n    mode: \"0644\"\n</code></pre> <pre><code>---\n- name: \"Install mysql via apt\"\n  ansible.builtin.apt:\n    name: \"mysql-server\"\n    state: \"latest\"\n    update_cache: true\n\n- name: \"Install pymysql via apt\"\n  ansible.builtin.apt:\n    name: \"python3-pymysql\"\n    state: \"latest\"\n    update_cache: true\n\n- name: \"Set up root user\"\n  community.mysql.mysql_user:\n    name: \"root\"\n    password: \"password\"\n    login_user: \"root\"\n    login_password: \"password\"\n    check_implicit_admin: true\n    login_unix_socket: \"/var/run/mysqld/mysqld.sock\"\n\n- name: \"Remove anonymous users\"\n  community.mysql.mysql_user:\n    name: \"\"\n    state: \"absent\"\n    login_user: \"root\"\n    login_password: \"password\"\n\n- name: \"Remove test database\"\n  community.mysql.mysql_db:\n    name: \"test\"\n    state: \"absent\"\n    login_user: \"root\"\n    login_password: \"password\"\n</code></pre>"},{"location":"03%20IaC/3.4_Ansible/#_3","title":"\u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u0430\u044f \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0438 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435","text":"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0430\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u043e\u0432 <pre><code>\u2500\u2500 inventories \n\u2502    \u251c\u2500\u2500 AWS \n\u2502    \u2502     \u251c\u2500\u2500 group_vars\n\u2502    \u2502     \u2502    \u251c\u2500\u2500 all \n\u2502    \u2502     \u2502    \u2514\u2500\u2500 web-servers\n\u2502    \u2502     \u251c\u2500\u2500 hosts\n\u2502    \u2502     \u2514\u2500\u2500 host_vars\n\u2502    \u2502           \u251c\u2500\u2500 hostname1\n\u2502    \u2502           \u2514\u2500\u2500 hostname2\n\u2502    \u2514\u2500\u2500 Local\n\u2502          \u251c\u2500\u2500 group_vars\n\u2502          \u251c\u2500\u2500 hosts\n\u2502          \u2514\u2500\u2500 host_vars\n\u251c\u2500\u2500 roles \n\u2502    \u251c\u2500\u2500 nginx\n|    |    \u251c\u2500\u2500  tasks/\n|    |    \u251c\u2500\u2500  handlers/\n|    |    |--- files/\n|    |    |--- templates/\n|    |    |--- vars/\n|    |    |--- defaults/\n|    |    |--- meta/\n\u2502    \u251c\u2500\u2500 grafana\n\u2502    \u2514\u2500\u2500 common\n\u251c\u2500\u2500 ansible.cfg\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 grafana.yml\n\u2514\u2500\u2500 web-server.yml\n</code></pre> <ul> <li>inventories<ul> <li>host, group_vars, host_vars<ul> <li>hosts - \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u0444\u0430\u0439\u043b, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0445\u043e\u0441\u0442\u044b \u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a \u0445\u043e\u0441\u0442\u0430\u043c</li> <li>group_vars - \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u044b \u043a \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u0435 \u0445\u043e\u0441\u0442\u043e\u0432</li> <li>host_vars - \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0445\u043e\u0441\u0442\u0430</li> </ul> </li> </ul> </li> <li>roles - \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0441 \u0440\u043e\u043b\u044f\u043c\u0438, \u043f\u0440\u0438\u043c\u0435\u0440 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0440\u043e\u043b\u0435\u0439 nginx, php<ul> <li>\u0420\u043e\u043b\u044c \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u0433\u0440\u0443\u043f\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0437\u0430\u0434\u0430\u0447 \u0432 \u043e\u0434\u0438\u043d \u043a\u043e\u043d\u0432\u0435\u0439\u0435\u0440</li> <li>tasks/main.yml \u2013 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0441\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u0434\u0430\u0447 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u0440\u043e\u043b\u044c</li> <li>handlers/main.yml \u2013 \u0441\u043f\u0438\u0441\u043a\u0438 \u0437\u0430\u0434\u0430\u0447 (\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432), \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u044b notify</li> <li>defaults/main.yml \u2013 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0441 \u043e\u0447\u0435\u043d\u044c \u043d\u0438\u0437\u043a\u0438\u043c \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u043e\u043c</li> <li>vars/main.yml \u2013 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0441 \u0431\u043e\u043b\u044c\u0448\u0438\u043c \u043f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442\u043e\u043c</li> <li>files \u2013 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0441 \u0444\u0430\u0439\u043b\u0430\u043c\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0432 \u0440\u043e\u043b\u0438</li> <li>templates\u00a0\u2013\u00a0\u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0441 \u0448\u0430\u0431\u043b\u043e\u043d\u0430\u043c\u0438\u00a0Jinja2</li> <li>meta/main.yml\u00a0\u2013\u00a0\u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044f \u0441 \u043c\u0435\u0442\u0430\u0434\u0430\u0442\u0430\u0439 \u043e\u0431 \u0430\u0432\u0442\u043e\u0440\u0435, \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044f\u0445 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0440\u043e\u043b\u044c</li> </ul> </li> <li>ansible.cfg - \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u044e\u0442\u0441\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e</li> <li>playbook.yml - \u0444\u0430\u0439\u043b \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043c\u044b \u0441\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u043c \u0445\u043e\u0441\u0442\u044b \u0438 \u0440\u043e\u043b\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0443\u0436\u043d\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c</li> </ul>"},{"location":"03%20IaC/3.4_Ansible/#ansible-galaxy","title":"Ansible galaxy","text":"<p>\u041a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u0438 \u0432 Ansible \u2014 \u0444\u043e\u0440\u043c\u0430\u0442 \u0440\u0430\u0441\u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043d\u0430\u0431\u043e\u0440\u0430 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 \u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432. \u0421\u043a\u0430\u0447\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0438 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0432 ~/.ansible/collections</p> <p>requirements.yml<pre><code>roles:\n- src: geerlinguy.postgresql\n\n- name: green.mongodb\n  src: https://github.com/UnderGreen/ansible-role-mongodb\n\ncollections:\n- name: community.postgresql\n</code></pre> \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0440\u043e\u043b\u0435\u0439 \u0438\u0437 \u044d\u0442\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430 <pre><code>ansible-galaxy collection install -r requirements.yml\nansible-galaxy install -r requirements.yml\n</code></pre> \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0432\u043e\u0435\u0439 \u0440\u043e\u043b\u0438 <pre><code>ansible-galaxy role init test_galaxy\n</code></pre> \u0421\u043f\u0438\u0441\u043e\u043a \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u0439 (\u041a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u044f\u00a0ansible.builtin\u00a0\u0437\u0434\u0435\u0441\u044c \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u0430, \u0442\u0430\u043a \u043a\u0430\u043a \u044d\u0442\u043e \u0435\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u0430\u044f \u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u044f \u043c\u043e\u0434\u0443\u043b\u0435\u0439, \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u0430\u044f \u043f\u0440\u044f\u043c\u043e \u0432 \u044f\u0434\u0440\u043e Ansible) <pre><code>ansible-galaxy collection list\n</code></pre> \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0434\u043b\u044f \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0438 \u0442.\u043f. \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043f\u0430\u0440\u043e\u043b\u044c sudo \u0427\u0442\u043e\u0431\u044b \u0435\u0433\u043e \u043d\u0435 \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u043b\u043e \u043c\u043e\u0436\u043d\u043e \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u0432 \u0444\u0430\u0439\u043b\u0435 /etc/sudoers \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c sudo visudo /etc/sudoers</p> <pre><code>`myuser ALL=(ALL) NOPASSWD: ALL`\u00a0for a single user, or\n`%sudo  ALL=(ALL) NOPASSWD: ALL`\u00a0for a group.\n</code></pre> <p>Info</p> <p>Yandex cloud \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0438\u0437 \u043e\u0431\u0440\u0430\u0437\u0430 \u0441\u0440\u0430\u0437\u0443 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u044d\u0442\u0443 \u0441\u0442\u0440\u043e\u043a\u0443 \u0432 /etc/sudoers.d/cloud_init</p>"},{"location":"03%20IaC/3.4_Ansible/#jinja","title":"Jinja \u0448\u0430\u0431\u043b\u043e\u043d\u044b","text":"<code>mongo.conf.j2</code> <code>main.yml</code> <pre><code># network interfaces\nnet:\n port: 27017\n bindIp: {{ mongodb_listen_ip }} # &lt;-- \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445\n# Replication params\n{% if mongodb_replication_replset -%} # &lt;-- \u0423\u0441\u043b\u043e\u0432\u043d\u044b\u0439 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435\n\u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445\nreplication:\n replSetName: {{ mongodb_replication_replset }}\n{% endif %}\n</code></pre> <pre><code>- name: Create mongod.conf file for MongoDB\n template:\n src: templates/mongodb/mongod.conf.j2\n dest: /etc/mongod.conf\n</code></pre>"},{"location":"03%20IaC/3.4_Ansible/#notify-and-handler","title":"Notify and Handler","text":"<ul> <li>Notify \u044d\u0442\u043e \u0442\u0440\u0438\u0433\u0433\u0435\u0440 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u0435\u0441\u043b\u0438 \u0444\u0430\u0439\u043b \u0438\u0437\u043c\u0435\u043d\u0438\u043b\u0441\u044f \u0442\u043e \u043d\u0443\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c nginx)</li> <li>\u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0435\u0441\u043b\u0438 task \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u043e \u0441\u0442\u0430\u0442\u0443\u0441 change (\u0442.\u0435. \u0441\u0434\u0435\u043b\u0430\u043b\u043e \u043a\u0430\u043a\u0438\u0435 \u0442\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f)</li> <li>\u0415\u0441\u043b\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0445 notify \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c\u0441\u044f \u0432\u0441\u0451 \u0440\u0430\u0432\u043d\u043e \u043e\u0434\u0438\u043d handler</li> <li>Handler \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0432 \u043a\u043e\u043d\u0446\u0435 \u043a\u0430\u0436\u0434\u043e\u0433\u043e play\u2019a (Play \u2014 \u0441\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u0440\u043e\u043b\u0435\u0439 \u0438 \u0442\u0430\u0441\u043a\u043e\u0432 \u0441 \u0441\u043f\u0438\u0441\u043a\u043e\u043c \u0445\u043e\u0441\u0442\u043e\u0432 )</li> <li>Notify \u043e\u0434\u043d\u043e\u0439 \u0440\u043e\u043b\u0438 \u043c\u043e\u0436\u0435\u0442 \u0432\u044b\u0437\u0432\u0430\u0442\u044c handler \u0438\u0437 \u0434\u0440\u0443\u0433\u043e\u0439</li> <li>\u0415\u0441\u043b\u0438 \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u0442\u043e handler \u0432\u044b\u0437\u0432\u0430\u043d \u043d\u0435 \u0431\u0443\u0434\u0435\u0442</li> </ul> playbook.yml<pre><code>handlers:\n- name: reload mongodb # &lt;-- \u0418\u043c\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u043e\u0442\u043e\u043c \u0437\u0430\u0434\u0430\u0435\u043c \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u0438\u0432\u0435 notify\n service:\n name: mongod\n state: reloaded\n\ntasks:\n- name: Create mongod.conf file for MongoDB\n template:\n src: templates/mongodb/mongod.conf\n dest: /etc/mongod.conf\n notify:\n - reload mongodb # &lt;-- \u0412\u044b\u0437\u043e\u0432\u0435\u043c \u044d\u0442\u0443 \u0437\u0430\u0434\u0430\u0447\u0443, \u0435\u0441\u043b\u0438 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u0441\u044f\n</code></pre>"},{"location":"03%20IaC/3.4_Ansible/#dinamic-inventory","title":"Dinamic inventory","text":"<ul> <li>\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441 inventory \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u043c \u0438\u0437 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432</li> <li>\u0420\u0435\u0448\u0430\u0435\u0442 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0443 \u0434\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u043d\u0438\u044f \u0445\u043e\u0441\u0442\u043e\u0432</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u0441\u043a\u0440\u0438\u043f\u0442\u043e\u0432 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u0432\u043d\u0435\u0448\u043d\u0438\u0445 \u0441\u0438\u0441\u0442\u0435\u043c</li> </ul> <pre><code>ansible -i $HOME/test_inventroy.py -m ping all\n</code></pre>"},{"location":"03%20IaC/3.4_Ansible/#ansible-vault","title":"Ansible Vault \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u0435","text":"<ul> <li>\u041a\u043e\u043d\u0441\u043e\u043b\u044c\u043d\u0430\u044f \u0443\u0442\u0438\u043b\u0438\u0442\u0430 \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0441\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u043c\u0438</li> <li>\u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c \u0447\u0435\u0440\u0435\u0437 vars_files</li> <li>\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0432 \u043e\u0431\u0449\u0438\u0445 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f\u0445 \u0444\u0430\u0439\u043b\u0430\u0445, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442\u0441\u044f \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f</li> <li>\u0414\u043b\u044f \u0431\u043e\u043b\u0435\u0435 \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u0441\u043b\u0443\u0447\u0430\u0435\u0432 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f Hashicorp Vault</li> </ul> <p><pre><code>vars_files:\n    - secrets.yml\n</code></pre> <pre><code>secret_pass: password\n</code></pre> \u0427\u0442\u043e\u0431\u044b \u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u0442\u044c \u0444\u0430\u0439\u043b <pre><code>ansible-vault --vault-id dev@prompt encrypt --encrypt-vault-id dev secrets.yml\n</code></pre> \u0417\u0430\u043f\u0443\u0441\u043a \u0441 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u043c \u043f\u0430\u0440\u043e\u043b\u044f \u043e\u0442 \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u044f <pre><code>ansible-playbook myplaybook.yml --ask-vault-pass\n</code></pre></p>"},{"location":"03%20IaC/3.4_Ansible/#_4","title":"\u041e\u0442\u043b\u0430\u0434\u043a\u0430","text":"<ul> <li>-vvvv - \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434</li> <li>\u041f\u043e\u0448\u0430\u0433\u043e\u0432\u043e\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 --step</li> <li>Ansible-console</li> <li>debugger (break point \u0432\u043d\u0443\u0442\u0440\u0438 task)<ul> <li>p task.vars</li> <li>p task.args</li> </ul> </li> </ul>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/","title":"4.1 Docker","text":""},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#linux","title":"\u0422\u0438\u043f\u044b \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432 \u0438\u043c\u0435\u043d Linux","text":"<p>\u0412 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u043e\u0439 \u0432\u0435\u0440\u0441\u0438\u0438 \u044f\u0434\u0440\u0430 \u0435\u0441\u0442\u044c \u0441\u0435\u043c\u044c \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432 \u0438\u043c\u0435\u043d:</p> <ul> <li>PID: \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f \u0434\u0435\u0440\u0435\u0432\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432;</li> <li>NET: \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0441\u0442\u0435\u043a\u0430 \u0445\u043e\u0441\u0442\u0430;</li> <li>MNT: \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f \u0442\u043e\u0447\u0435\u043a \u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0445\u043e\u0441\u0442\u0430;</li> <li>UTS: \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f \u0438\u043c\u0435\u043d\u0438 \u0445\u043e\u0441\u0442\u0430;</li> <li>IPC: \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f \u0443\u0442\u0438\u043b\u0438\u0442 \u043c\u0435\u0436\u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043d\u043e\u0433\u043e \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f (\u0441\u0435\u0433\u043c\u0435\u043d\u0442\u044b \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u043c\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438, \u0441\u0435\u043c\u0430\u0444\u043e\u0440\u044b);</li> <li>USER: \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u044f ID \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b;</li> </ul> <p>\u041a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u043d\u0435 \u0441\u043e\u043f\u0435\u0440\u043d\u0438\u0447\u0430\u0435\u0442 \u0441 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0435\u0439 - \u044d\u0442\u043e \u0434\u0432\u0430 \u0440\u0430\u0437\u043d\u044b\u0445 \u043f\u043e\u0434\u0445\u043e\u0434\u0430.</p> <p>\u0420\u0430\u0437\u043b\u0438\u0447\u0438\u044f \u0412\u041c \u043e\u0442 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430</p> <ul> <li>\u041a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u044f\u0434\u0440\u043e \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b</li> <li>\u0415\u0441\u043b\u0438 \u0443\u044f\u0437\u0432\u0438\u043c\u043e\u0441\u0442\u044c \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u0430 \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435 \u0442\u043e \u043f\u043e \u0441\u0443\u0442\u0438 \u043e\u043d\u0430 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u0430 \u043d\u0430 \u0445\u043e\u0441\u0442\u0435!</li> <li>\u0412 \u0412\u041c \u043c\u043e\u0436\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u043b\u044e\u0431\u0430\u044f \u041e\u0421, \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435 \u2013 \u043d\u0435 \u043b\u044e\u0431\u0430\u044f</li> <li>\u0412\u041c \u0445\u043e\u0440\u043e\u0448\u043e \u0438\u0437\u043e\u043b\u0438\u0440\u0443\u0435\u0442\u0441\u044f, \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 - \u0445\u0443\u0436\u0435</li> </ul>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#docker","title":"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0438 \u0441\u0443\u0449\u043d\u043e\u0441\u0442\u0438 Docker","text":"<p>Docker daemon - c\u0435\u0440\u0432\u0435\u0440\u043d\u0430\u044f \u0447\u0430\u0441\u0442\u044c</p> <ul> <li>\u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0441\u0431\u043e\u0440\u043a\u0443 \u0438 \u0437\u0430\u043f\u0443\u0441\u043a \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432</li> <li>\u0421\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u0440\u0430\u0437\u043e\u0432</li> <li>\u0421\u043e\u0431\u0438\u0440\u0430\u0435\u0442 \u043b\u043e\u0433\u0438</li> <li>\u0421\u0432\u044f\u0437\u044b\u0432\u0430\u0435\u0442 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u044b \u043f\u043e \u0441\u0435\u0442\u0438</li> <li>\u0418 \u0442.\u043f.</li> </ul> <p>Docker CLI - \u043a\u043b\u0438\u0435\u043d\u0441\u043a\u0430\u044f \u0447\u0430\u0441\u0442\u044c (\u043c\u043e\u0436\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e \u0438 \u043f\u043e \u0441\u0435\u0442\u0438)</p> <ul> <li>\u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 Docker daemon</li> </ul> <p>Dockerfile - \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f \u043f\u043e \u0441\u0431\u043e\u0440\u043a\u0435 docker-image</p> <ul> <li>\u041f\u0440\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043a\u0430\u0436\u0434\u0430\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u043d\u043e\u0432\u044b\u0439 \u0441\u043b\u043e\u0439</li> </ul> <p>Docker image - \u043e\u0431\u0440\u0430\u0437, \u043f\u043e \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u043f\u0443\u0449\u0435\u043d \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440</p> <ul> <li>\u0423\u043f\u0430\u043a\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435</li> <li>\u0425\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u0432 registry</li> <li>\u0421\u043e\u0441\u0442\u043e\u0438\u0442 \u0438\u0437 \u0441\u043b\u043e\u0435\u0432</li> </ul> <p>Docker container - \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0439 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f</p> <p>Docker registry - \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439 \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0441\u043e\u0431\u0440\u0430\u043d\u043d\u044b\u0445 docker image</p>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#_1","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b","text":"<pre><code>docker pull mongo\n\ndocker images\n\ndocker run -p 27017:27017 --name mydb mongo\n\ndocker ps\n\ndocker exec -it mydb /bin/bash\n\ndocker stop mydb\n\ndocker rm mydb\n\ndocker rmi mongo\n</code></pre> <p>Docker volumes</p> <pre><code>docker run -v /home/mount/data:/var/lib/mysql/data\n</code></pre>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#docker_1","title":"\u0421\u0435\u0442\u0435\u0432\u043e\u0435 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 Docker \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432","text":"<p>Docker Network Drivers</p> <p>Network Drivers</p> <ul> <li>None (\u041e\u0442\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u0432\u0441\u0435 \u0441\u0435\u0442\u0438)</li> <li>Bridge (\u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u044b \u043c\u043e\u0433\u0443\u0442 \u043e\u0431\u0449\u0430\u0442\u044c\u0441\u044f \u0434\u0440\u0443\u0433 \u0441 \u0434\u0440\u0443\u0433\u043e\u043c)<ul> <li>\u041d\u0435\u043b\u044c\u0437\u044f \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0442\u044c ip \u0430\u0434\u0440\u0435\u0441\u0430</li> <li>\u041d\u0435\u0442 service discovery</li> </ul> </li> <li>Host (\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u0441\u0435\u0442\u0438)</li> <li>Overlay (\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u0435\u0442 \u0441\u0435\u0442\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432 \u043d\u0430 \u0440\u0430\u0437\u043d\u044b\u0445 \u0434\u043e\u043a\u0435\u0440 \u0445\u043e\u0441\u0442\u0430\u0445)</li> <li>Macvlan (\u041f\u0440\u0438\u0441\u0432\u0430\u0438\u0432\u0430\u0435\u0442 \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0443 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0439 MAC-\u0430\u0434\u0440\u0435\u0441)</li> </ul> <p>Bridge </p> <p>Note</p> <p>\u0412\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 DNS \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0434\u043b\u044f default bridge</p> <pre><code>docker network ls\n\ndocker network inspect net_default\n</code></pre>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#docker-compose","title":"Docker compose","text":"<pre><code>docker-compose up\n\ndocker-compose up -d --build\n\ndocker-compose down\n</code></pre>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#docker_2","title":"Docker \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c","text":"<ul> <li>\u041d\u0435 \u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430</li> <li>Capabilietes \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u043d\u0430 \u0432\u044b\u0437\u043e\u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0445 \u0444\u0443\u043d\u043a\u0446\u0438\u0439 \u044f\u0434\u0440\u0430 (\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0442\u0443\u0442)</li> <li>\u0412\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u043c\u043e\u0434\u0443\u043b\u0438 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u041e\u0421 (Apparmor, SELinux)</li> <li>\u041d\u0435 \u0437\u0430\u0431\u044b\u0432\u0430\u0435\u043c \u043f\u0440\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u044b</li> <li>\u041f\u0440\u0438\u0432\u044b\u043a\u0430\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432</li> <li>\u041d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043e\u0431\u0440\u0430\u0437\u044b \u043e\u0442 \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439</li> <li>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 auditctl \u0434\u043b\u044f \u0444\u0430\u0439\u043b\u043e\u0432 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0441 docker</li> <li>\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a docker daemon (tcp, unix socket)</li> <li>\u0421\u0442\u0430\u0440\u0430\u0435\u043c\u0441\u044f \u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u0440\u0432\u0438\u0441\u044b \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u043d\u0430 \u043d\u0443\u0436\u043d\u043e\u043c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435</li> </ul> <pre><code>docker scan ubuntu\n\ndocker scan --severity=high ubuntu\n</code></pre> <p>\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0433\u0434\u0435 \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u043b\u043e\u0433 \u0444\u0430\u0439\u043b <pre><code>docker inspect test | grep \"LogPath\"\n</code></pre></p>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#_2","title":"\u0422\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435","text":"<p>\u0427\u0442\u043e \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c?</p> <ul> <li>\u0421\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u043e\u0431\u0440\u0430\u0437\u0430<ul> <li>goss - \u0443\u0442\u0438\u043b\u0438\u0442\u0430 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b</li> <li>dgoss - \u043e\u0431\u0435\u0440\u0442\u043a\u0430 \u043d\u0430 bash, \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u044e\u0449\u0430\u044f \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0438\u0437 \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043e\u0431\u0440\u0430\u0437\u0430 \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0449\u0430\u044f \u0442\u0435\u0441\u0442\u044b</li> </ul> </li> <li>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0435 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435</li> <li>Security<ul> <li>\u041a\u0430\u043a \u043d\u0430\u043f\u0438\u0441\u0430\u043d\u043e Dockerfile</li> <li>\u041a\u0430\u043a \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u044b \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u044b</li> <li>\u0427\u0442\u043e \u0432\u043d\u0443\u0442\u0440\u0438 \u043e\u0431\u0440\u0430\u0437\u043e\u0432</li> <li>docker-bench-security</li> </ul> </li> </ul> <code>goss.yaml</code> <pre><code>command:\n mongod --version | head -n1:\n exit-status: 0\n stdout:\n - db version v3.2.17\nprocess:\n mongod:\n running: true\naddr:\n tcp://localhost:27017:\n reachable: true\n timeout: 500\n</code></pre> healtcheck<pre><code>healthcheck:\n test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:5000/healthcheck\"]\n interval: 1m30s\n timeout: 10s\n retries: 3\n</code></pre>"},{"location":"04%20DevOps%20and%20CICD/4.1_Docker/#_3","title":"\u041e\u0440\u043a\u0435\u0441\u0442\u0440\u0430\u0446\u0438\u044f","text":"<p>\u041f\u0440\u043e\u0431\u043b\u0435\u043c\u044b</p> <ul> <li>\u0420\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u043f\u043e\u0442\u0440\u0435\u0431\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0441\u043b\u043e\u0436\u043d\u043e</li> <li>\u0420\u0443\u0447\u043d\u043e\u0435 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439 \u043f\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430\u043c \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u0441\u043b\u043e\u0436\u043d\u043e\u0439</li> <li>\u0414\u0435\u043f\u043b\u043e\u0439 \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u0440\u0443\u0442\u0438\u043d\u043e\u0439</li> </ul> <p>\u041e\u0440\u043a\u0435\u0441\u0442\u0440\u0430\u0442\u043e\u0440</p> <ul> <li>\u0423\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u043e\u043c \u0445\u043e\u0441\u0442\u043e\u0432</li> <li>\u041f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447 </li> <li>\u0413\u0438\u0431\u043a\u043e\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0431\u043e\u043b\u044c\u0448\u0438\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e\u043c \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432</li> <li>\u041d\u0443\u0436\u0435\u043d \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043d\u0430\u0434 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435\u043c \u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043c\u0438</li> </ul> <p>Kubernetes. \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430</p> <ul> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 YAML \u0438 JSON \u0444\u043e\u0440\u043c\u0430\u0442\u043e\u0432</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u043c\u043e\u0449\u043d\u043e\u0433\u043e \u0448\u0430\u0431\u043b\u043e\u043d\u0438\u0437\u0430\u0442\u043e\u0440\u0430 HELM</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430 CNI-\u043f\u043b\u0430\u0433\u0438\u043d\u043e\u0432</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 rolling update, blue-green \u0438 canary \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439, \u0441 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435\u043c \u0438\u0441\u0442\u043e\u0440\u0438\u0438</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u0430\u0432\u0442\u043e\u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, HPA, VPA</li> <li>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0441\u0438\u0441\u0442\u0435\u043c \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430, \u0442\u0440\u0430\u0441\u0441\u0438\u0440\u043e\u0432\u043a\u0438, \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u043f\u0440\u043e\u0447.</li> <li>\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 service-discovering \u0437\u0430 \u0441\u0447\u0435\u0442 \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u043e\u0433\u043e DNS-\u0441\u0435\u0440\u0432\u0438\u0441\u0430</li> <li>\u0412\u044b\u0441\u043e\u043a\u0438\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438, \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u043d\u044b\u0439 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u043c\u0438 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438 \u0441 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c\u044e \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f</li> </ul>"},{"location":"04%20DevOps%20and%20CICD/4.2_CICD/","title":"4.2 \u0422\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u044f \u043d\u0435\u043f\u0440\u0435\u0440\u044b\u0432\u043d\u043e\u0439 \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u041f\u041e","text":""},{"location":"04%20DevOps%20and%20CICD/4.2_CICD/#cicd","title":"\u041f\u0440\u043e\u0446\u0435\u0441\u0441\u044b CI/CD","text":"<ul> <li>\u0421\u0431\u043e\u0440\u043a\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f</li> <li>\u041a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430</li> <li>\u041f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442\u043e\u0432 \u0441\u0431\u043e\u0440\u043a\u0438 \u0432 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435</li> <li>\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f / \u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0431\u043e\u043b\u0435\u0435 \u043d\u0435 \u043d\u0443\u0436\u043d\u043e\u0433\u043e \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f</li> <li>\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u0434\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f, \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u043e\u0433\u043e \u0432 \u0432\u0438\u0434\u0435 \u043a\u043e\u0434\u0430</li> <li>\u0412\u044b\u043a\u0430\u0442\u043a\u0430 \u043d\u043e\u0432\u043e\u0439 \u0432\u0435\u0440\u0441\u0438\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f / \u041e\u0442\u043a\u0430\u0442 \u0434\u043e \u043f\u0440\u043e\u0448\u043b\u043e\u0439 \u0432\u0435\u0440\u0441\u0438\u0438</li> <li>\u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u043a \u0431\u0430\u0437\u0430\u043c \u0434\u0430\u043d\u043d\u044b\u0445 \u044d\u0442\u043e\u0433\u043e \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f</li> </ul>"},{"location":"04%20DevOps%20and%20CICD/4.2_CICD/#cicd_1","title":"\u041f\u0440\u0438\u043d\u0446\u0438\u043f\u044b CICD","text":"<ul> <li>\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u043c\u044b\u0439 \u0438 \u043d\u0430\u0434\u0435\u0436\u043d\u044b\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u041f\u041e</li> <li>\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0441\u0435, \u0447\u0442\u043e \u043c\u043e\u0436\u043d\u043e. \u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0441 \u043a\u043d\u043e\u043f\u043a\u0430\u043c\u0438</li> <li>\u0425\u0440\u0430\u043d\u0438\u0442\u044c \u0432\u0441\u0435 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044f \u0432\u0435\u0440\u0441\u0438\u0439</li> <li>\u041f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u0440\u0430\u043d\u043d\u044e\u044e \u043e\u0431\u0440\u0430\u0442\u043d\u0443\u044e \u0441\u0432\u044f\u0437\u044c</li> <li>\u0421\u043e\u0432\u0435\u0440\u0448\u0435\u043d\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u044f</li> <li>\u0412\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430</li> <li>\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e, \u0437\u043d\u0430\u0447\u0438\u0442 \u0437\u0430\u0440\u0435\u043b\u0438\u0437\u0438\u043b\u043e\u0441\u044c</li> <li>\u0420\u0435\u043b\u0438\u0437\u0438\u043c \u0438\u043c\u0435\u043d\u043d\u043e \u0442\u043e, \u0447\u0442\u043e \u0431\u044b\u043b\u043e \u043f\u0440\u043e\u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043e</li> <li>\u041a\u0430\u0436\u0434\u044b\u0439 \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u041f\u041e</li> </ul>"},{"location":"04%20DevOps%20and%20CICD/4.2_CICD/#_1","title":"\u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438","text":"<ul> <li>Mean Lead Time \u2013 \u0432\u0440\u0435\u043c\u044f \u043d\u0430 \u0431\u0438\u043b\u0434, \u0442\u0435\u0441\u0442\u044b, \u0434\u0435\u043f\u043b\u043e\u0439</li> <li>Daily Change Rate \u2013 \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0445 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u0432 \u0434\u0435\u043d\u044c</li> <li>Mean Time To Environment \u2013 \u0432\u0440\u0435\u043c\u044f \u043d\u0430 \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0443 \u043d\u043e\u0432\u043e\u0433\u043e \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f</li> <li>Mean Time To Detect \u2013 \u043a\u0430\u043a \u0434\u043e\u043b\u0433\u043e \u0431\u0430\u0433 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043d\u0435\u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u043c</li> </ul>"},{"location":"04%20DevOps%20and%20CICD/4.2_CICD/#_2","title":"\u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430","text":"<ul> <li>Build Failure Rate \u2013 \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u043d\u0435\u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0445 \u0441\u0431\u043e\u0440\u043e\u043a</li> <li>Deployment Failure Rate \u2013 \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u043d\u0435\u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0445 \u0432\u044b\u043a\u0430\u0442\u043e\u043a</li> <li>Infra-Related Failure Rate \u2013 \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u043d\u0435\u0443\u0441\u043f\u0435\u0449\u043d\u044b\u0445 \u0432\u044b\u043a\u0430\u0442\u043e\u043a / \u0441\u0431\u043e\u0440\u043e\u043a \u0438\u0437 -\u0437\u0430 \u043f\u0440\u043e\u0431\u043b\u0435\u043c \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b</li> <li>Automated Detection Rate \u2013 \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u043f\u0440\u043e\u0431\u043b\u0435\u043c, \u0432\u044b\u044f\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043d\u0430 \u044d\u0442\u0430\u043f\u0430\u0445 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f</li> </ul>"},{"location":"05%20Kubernetes/5.1_Kubernetes/","title":"5.1 \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b k8s","text":""},{"location":"05%20Kubernetes/5.1_Kubernetes/#k8s-","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b k8s-\u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430:","text":"<ul> <li>etcd \u2013 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438</li> <li>api-server \u2013 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 API</li> <li>controller-manager \u2013 \u0437\u0430\u043f\u0443\u0441\u043a \u043d\u0430\u0431\u043e\u0440\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u043e\u0432 \u0438 \u0441\u0431\u043e\u0440\u043a\u0430 \u043c\u0443\u0441\u043e\u0440\u0430</li> <li>scheduler \u2013 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u043e\u0432 \u043d\u0430 \u043d\u043e\u0434\u044b \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430 \u0444\u0430\u043a\u0442\u043e\u0440\u043e\u0432</li> </ul> <p>Etcd \u2013 key/value \u0431\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430</p> <ul> <li>\u0420\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043f\u043e \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0443 raft (\u043e\u043d \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u043d\u0430\u0434\u0435\u0436\u043d\u043e\u0441\u0442\u044c \u0437\u0430 \u0441\u0447\u0435\u0442 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438 \u043a\u0432\u043e\u0440\u0443\u043c\u0430)</li> <li>\u0415\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u0430\u044f \u0431\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 k8s</li> <li>\u0415\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 stateful-\u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 (\u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0445\u0440\u0430\u043d\u0438\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435)</li> <li>\u041d\u0430 \u043a\u0430\u0436\u0434\u0443\u044e master-\u043d\u043e\u0434\u0443 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u043e \u043d\u043e\u0434\u0435 etcd</li> </ul> <p>raft \u2013 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0441\u0435\u043d\u0441\u0443\u0441\u0430 \u0432 \u0441\u0435\u0442\u0438 \u043d\u0430\u0434\u0435\u0436\u043d\u044b\u0445 \u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0439 \u041a\u0430\u0436\u0434\u0430\u044f \u043d\u043e\u0434\u0430 \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c\u0441\u044f \u0432 \u043e\u0434\u043d\u043e\u043c \u0438\u0437 3-\u0445 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0439:</p> <ul> <li>\u041b\u0438\u0434\u0435\u0440 (Leader)</li> <li>\u041a\u0430\u043d\u0434\u0438\u0434\u0430\u0442 (Candidate)</li> <li>\u0412\u0435\u0434\u043e\u043c\u044b\u0439 (Follower)</li> </ul> <p>Api-server \u2013 \u0446\u0435\u043d\u0442\u0440\u0430\u043b\u044c\u043d\u044b\u0439, \u0433\u043b\u0430\u0432\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 k8s</p> <ul> <li>Stateless (\u0432 \u043e\u0442\u043b\u0438\u0447\u0438\u0438 \u043e\u0442 etcd)</li> <li>\u0412\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 kubectl (\u043d\u043e \u043c\u043e\u0436\u043d\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0438 \u043f\u0440\u043e\u0441\u0442\u043e curl\u2019\u043e\u043c)</li> <li>\u0415\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0431\u0449\u0430\u0435\u0442\u0441\u044f \u0441 etcd</li> <li>\u0420\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043f\u043e REST API</li> <li>\u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e \u0438 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044e (\u0440\u0430\u0437\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u043f\u0440\u0430\u0432 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0434\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u043c\u0443 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430)</li> </ul> <p>Controller-manager \u2013 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u043d\u0430\u0431\u043e\u0440\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u043e\u0432</p> <p>\u041a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u044b \u043f\u0440\u0438\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u0430 \u0435\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0439 \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u0438</p> <p>\u0412 \u0441\u043e\u0441\u0442\u0430\u0432 controller-manager\u2019\u0430 \u0432\u0445\u043e\u0434\u044f\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u044b:</p> <ul> <li>node controller - \u0434\u0435\u0440\u0436\u0438\u0442 \u0441\u0432\u044f\u0437\u044c \u0441 \u043d\u043e\u0434\u0430\u043c\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u0435\u0441\u043b\u0438 \u043d\u043e\u0434\u0430 \u043d\u0435 \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442, \u043f\u0435\u0440\u0435\u043d\u043e\u0441\u0438\u0442 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043d\u0430 \u0434\u0440\u0443\u0433\u0438\u0435 \u043d\u043e\u0434\u0443<ul> <li>kubelet \u043e\u0431\u0449\u0430\u0435\u0442\u0441\u044f \u0441 api server, \u043e\u043d \u0441 controller manager'\u043e\u043c, \u0430 \u0443\u0436\u0435 \u043e\u043d \u043e\u0431\u0449\u0430\u0435\u0442\u0441\u044f \u0441 node controller'\u043e\u043c</li> </ul> </li> <li>replicaset controller - \u0441\u043c\u043e\u0442\u0440\u0438\u0442 \u0432 api-server \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u0432\u0438\u0434\u0438\u0442 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0435 replicaset\u2019\u044b, \u0440\u0435\u0430\u043b\u0438\u0437\u0443\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u0443 \u0438\u0445 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f</li> <li>endpoints controller - \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u043e\u0432 \u0434\u043b\u044f \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 (\u0441\u0432\u044f\u0437\u044c \u043c\u0435\u0436\u0434\u0443 \u043f\u043e\u0434\u043e\u043c \u0438 \u0435\u0433\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u043c)</li> <li>account controller - \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0445 \u0443\u0447\u0435\u0442\u043d\u044b\u0445 \u0437\u0430\u043f\u0438\u0441\u0435\u0439</li> <li>token controller - \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0442\u043e\u043a\u0435\u043d\u043e\u0432 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 API</li> </ul> <p>Info</p> <p>\u041e\u0431\u044b\u0447\u043d\u043e, \u043d\u0430 \u043a\u0430\u0436\u0434\u0443\u044e \u043c\u0430\u0441\u0442\u0435\u0440-\u043d\u043e\u0434\u0443 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u044e\u0442 \u043f\u043e \u043e\u0434\u043d\u043e\u043c\u0443 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0443 controller-manager. \u041d\u043e, \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e \u043c\u043e\u0436\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0434\u0438\u043d \u043b\u0438\u0434\u0438\u0440\u0443\u044e\u0449\u0438\u0439 controller-manager, \u0438 \u0432\u044b\u0431\u043e\u0440 \u043b\u0438\u0434\u0435\u0440\u0430 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u043f\u043e \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0443 lease \u0421\u0443\u0442\u044c \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430 lease \u043e\u0447\u0435\u043d\u044c \u043f\u0440\u043e\u0441\u0442\u0430 \u2013 \u0442\u043e\u0442, \u043a\u0442\u043e \u043f\u0435\u0440\u0432\u044b\u043c \u0443\u0441\u043f\u0435\u0435\u0442 \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0441\u0435\u0431\u044f \u043b\u0438\u0434\u0435\u0440\u043e\u043c \u0432 api-server \u0442\u043e\u0442 \u0438 \u043b\u0438\u0434\u0435\u0440 \u0415\u0441\u043b\u0438 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043b\u0438\u0434\u0435\u0440 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u0432\u0435\u0447\u0430\u0442\u044c \u043d\u0443\u0436\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f, \u0431\u043e\u0440\u044c\u0431\u0430 \u0437\u0430 \u043b\u0438\u0434\u0435\u0440\u0441\u0442\u0432\u043e \u0432\u043e\u0437\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u043f\u043e \u0442\u043e\u043c\u0443 \u0436\u0435 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u0443</p> <p>Scheduler \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u0442 \u043f\u043e\u0434\u044b \u043d\u0430 \u043d\u043e\u0434\u044b \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430 \u0444\u0430\u043a\u0442\u043e\u0440\u043e\u0432</p> <p>controller-manager \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u0442 \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u044b \u043f\u043e\u0434\u043e\u0432, \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 api-server, \u0430 scheduler \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u0442 \u0438\u0445 \u043d\u0430 \u043d\u043e\u0434\u044b, \u043d\u043e \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u0442 \u0432\u0430\u0436\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b:</p> <ul> <li>QoS (quality of service)</li> <li>Affinity \u0438 Anti-affinity</li> <li>Requests \u0438 Limits</li> <li>Priority Class (preemption)</li> </ul>"},{"location":"05%20Kubernetes/5.1_Kubernetes/#k8s","title":"\u0412\u0441\u043f\u043e\u043c\u043e\u0433\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b k8s","text":"<p>\u041f\u043e\u043c\u0438\u043c\u043e \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432, \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043d\u0430 \u043c\u0430\u0441\u0442\u0435\u0440-\u043d\u043e\u0434\u0430\u0445, \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u043d\u0430 \u0432\u0441\u0435\u0445 \u043d\u043e\u0434\u0430\u0445 (\u043c\u0430\u0441\u0442\u0435\u0440\u044b \u0438 \u0432\u043e\u0440\u043a\u0435\u0440\u044b):</p> <p>kubelet \u2013 \u0430\u0433\u0435\u043d\u0442, \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0439 \u043d\u0430 \u0443\u0437\u043b\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430</p> <ul> <li>\u0420\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043d\u0430 \u043a\u0430\u0436\u0434\u043e\u0439 \u043d\u043e\u0434\u0435 (\u0438 \u043c\u0430\u0441\u0442\u0435\u0440\u044b \u0438 \u0432\u043e\u0440\u043a\u0435\u0440\u044b)</li> <li>\u041d\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0432 \u0434\u043e\u043a\u0435\u0440\u0435, \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043a\u0430\u043a \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043d\u0430 \u0445\u043e\u0441\u0442\u0435 (systemctl status kubelet)</li> <li>\u041e\u0442\u0434\u0430\u0435\u0442 \u043a\u043e\u043c\u0430\u043d\u0434\u044b docker daemon \u0447\u0435\u0440\u0435\u0437 docker api (docker run, \u043d\u0430\u043f\u0440.)</li> <li>\u0424\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0440\u0435\u0430\u043b\u0438\u0437\u0443\u0435\u0442 \u0437\u0430\u043f\u0443\u0441\u043a \u043f\u043e\u0434\u043e\u0432 \u043d\u0430 \u0443\u0437\u043b\u0435</li> <li>\u041e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 liveness probe, readiness probe, startup probe</li> </ul> <p>Startup probe \u2013 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438, \u0447\u0442\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435 \u0431\u044b\u043b\u043e \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043e. \u0415\u0441\u043b\u0438 \u043f\u0440\u043e\u0431\u0430 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u0430, \u0442\u043e liveness \u0438 readiness \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0431\u043b\u043e\u043a\u0438\u0440\u0443\u0435\u0442\u0441\u044f, \u0434\u043e \u0442\u043e\u0433\u043e \u043a\u0430\u043a \u043f\u0440\u043e\u0431\u0430 \u043f\u0440\u043e\u0439\u0434\u0435\u0442 \u0443\u0441\u043f\u0435\u0448\u043d\u043e (\u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0432 \u0441\u0442\u0430\u0442\u0443\u0441e running)</p> <p>Readiness probe \u2013 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438, \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u043b\u0438 \u043c\u043e\u0434\u0443\u043b\u044c \u0432 \u0442\u0435\u0447\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u0433\u043e \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u0446\u0438\u043a\u043b\u0430. \u0412 \u043e\u0442\u043b\u0438\u0447\u0438\u0435 \u043e\u0442 liveness probe, \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0441\u0431\u043e\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u043e\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0440\u0430\u0444\u0438\u043a \u043a \u043c\u043e\u0434\u0443\u043b\u044e, \u043d\u043e \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043d\u0435 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442  (\u0441\u0430\u043c\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0433\u043e\u0442\u043e\u0432\u043e \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f)</p> <p>Liveness probe \u2013 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f, \u043a\u043e\u0433\u0434\u0430 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c  (\u043a\u043e\u0433\u0434\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0443\u0436\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442, \u0440\u0430\u0437 \u0432 \u043a\u0430\u043a\u043e\u0435 \u0442\u043e \u0432\u0440\u0435\u043c\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0435\u0433\u043e)</p> <p>kube-proxy - \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u043f\u0440\u043e\u043a\u0441\u0438, \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0439 \u043d\u0430 \u043a\u0430\u0436\u0434\u043e\u043c \u0443\u0437\u043b\u0435 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435</p> <ul> <li>\u0412\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u0435\u0442 \u0441 api-server</li> <li>\u0423\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u0432\u0441\u0435\u0445 \u043d\u043e\u0434\u0430\u0445</li> <li>\u0423\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u0435\u0442\u0435\u0432\u044b\u043c\u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u0430\u043c\u0438 \u043d\u0430 \u043d\u043e\u0434\u0430\u0445</li> <li>\u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0432 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0435</li> </ul> <p>\u0412\u0442\u043e\u0440\u043e\u0441\u0442\u0435\u043f\u0435\u043d\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b, \u0441 \u043a\u043e\u0442\u043e\u0440\u044b\u043c\u0438 \u0432\u044b \u0441\u0442\u043e\u043b\u043a\u043d\u0435\u0442\u0435\u0441\u044c \u043f\u0440\u0438 \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u043e\u043c k8s:</p> <ul> <li>cri (\u0434\u0432\u0438\u0436\u043e\u043a \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0438\u0437\u0430\u0446\u0438\u0438)</li> <li>cni (\u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u043f\u043b\u0430\u0433\u0438\u043d\u044b)</li> <li>dns (k8s-\u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u044b\u0435 dns-\u0441\u0435\u0440\u0432\u0435\u0440\u044b)</li> <li>ccm (controller-manager \u0434\u043b\u044f \u043e\u0431\u043b\u0430\u0447\u043d\u044b\u0445 \u0440\u0435\u0448\u0435\u043d\u0438\u0439)</li> </ul>"},{"location":"05%20Kubernetes/5.2_Kubernetes/","title":"5.2 \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 K8s","text":""},{"location":"05%20Kubernetes/5.2_Kubernetes/#deployment-replicaset-pod","title":"Deployment, ReplicaSet, Pod","text":"<p>\u041a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f (deployment controller) \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b \u0434\u0435\u043a\u043b\u0430\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0447\u0438\u0445 \u043d\u0430\u0433\u0440\u0443\u0437\u043e\u043a</p> <p>\u0412 \u0441\u0432\u043e\u0435\u0439 \u0440\u0430\u0431\u043e\u0442\u0435 Deployment \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u043a\u043e\u043d\u0446\u0435\u043f\u0446\u0438\u044e \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0441\u0435\u0442\u043e\u0432 (ReplicaSet), \u0437\u0430\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044f replicaset controller</p> <p></p> <p>\u0424\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b \u0434\u0435\u043f\u043b\u043e\u0439\u043c\u0435\u043d\u0442\u0430 \u0442\u0435\u0441\u043d\u043e \u0441\u0432\u044f\u0437\u0430\u043d \u0441 \u0441\u0443\u0449\u043d\u043e\u0441\u0442\u044c\u044e replicaset</p> <p>\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0437\u0430\u0434\u0430\u0447\u0430 ReplicaSet - \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0430\u043d\u0438\u0435 \u0441\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u043e\u0433\u043e \u043d\u0430\u0431\u043e\u0440\u0430 \u0440\u0435\u043f\u043b\u0438\u043a\u0430\u0446\u0438\u0439 \u043f\u043e\u0434\u043e\u0432, \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0449\u0438\u0445 \u0432 \u043e\u0434\u0438\u043d \u043c\u043e\u043c\u0435\u043d\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 ReplicaSet \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u0443\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0438\u0434\u0435\u043d\u0442\u0438\u0447\u043d\u044b\u0445 \u043f\u043e\u0434\u043e\u0432</p> <p>\u0417\u0430 \u0441\u0447\u0435\u0442 \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0430\u043d\u0438\u0101 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0438\u0434\u0435\u043d\u0442\u0438\u0447\u043d\u044b\u0445 \u043f\u043e\u0434\u043e\u0432, ReplicaSet \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435:</p> <ul> <li>\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 (rolling update)</li> <li>\u041f\u0440\u043e\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0442\u0435\u043a\u0443\u0449\u0435\u043c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 (rollout status)</li> <li>\u041e\u0442\u043a\u0430\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f (rollout undo)</li> <li>\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0440\u0435\u0432\u0438\u0437\u0438\u0439 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 (rollout history)</li> <li>\u041e\u0442\u043a\u0430\u0442 (\u0440\u043e\u043b\u043b\u0431\u0443\u043a) \u0434\u043e \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u0440\u0435\u0432\u0438\u0437\u0438\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f (rollout undo to revision)</li> <li>\u0421\u043a\u0430\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u0430\u0431\u043e\u0447\u0438\u0445 \u043d\u0430\u0433\u0440\u0443\u0437\u043e\u043a (scaling)</li> </ul> <pre><code>kubectl create ns mobsf\n\nkubectl create deployment mobsf --image=opensecurity/mobile-security-framework-mobsf:v3.1.1 -n mobsf\n\nkubectl expose deployment mobsf --port=8000 --type=NodePort -n mobsf\n\nkubectl get svc -n mobsf\n\nkubectl get pods -n mobsf\n\nkubectl desctibe replicaset -n mobsf\n\n# \u0421\u0442\u0430\u0442\u0443\u0441 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f\nkubectl rollout status deployment/mobsf -n mobsf\n\n# \u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435\nkubectl rollout undo deployment/mobsf -n mobsf\n\n# \u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0438\u0441\u0442\u043e\u0440\u0438\u0438\nkubectl rollout history deployment/mobsf -n mobsf\n\n# \u041e\u0442\u043a\u0430\u0442 \u043d\u0430 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u0443\u044e \u0432\u0435\u0440\u0441\u0438\u044e\nkubectl rollout undo deployment/mobsf -n mobsf --to-revision=3\n\nkubectl scale deployment/mobsf --replicas=3 -n mobsf\n</code></pre>"},{"location":"05%20Kubernetes/5.2_Kubernetes/#kubernetes","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u0432 Kubernetes","text":"<p>PersistentVolume (PV) - \u043d\u0435\u043f\u043e\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 (\u0440\u0430\u0437\u0434\u0435\u043b \u043d\u0430 \u0436\u0435\u0441\u0442\u043a\u043e\u043c \u0434\u0438\u0441\u043a\u0435)</p> <p>\u0421 \u0442\u043e\u0447\u043a\u0438 \u0437\u0440\u0435\u043d\u0438\u044f \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, Persistent Volume \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0442\u0430\u043a\u0438\u043c \u0436\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u043c, \u043a\u0430\u043a, \u043a \u043f\u0440\u0438\u043c\u0435\u0440\u0443, Worker Node</p> <p>\u0420\u0430\u0431\u043e\u0442\u0430\u0442\u0430\u0442\u044c \u0441 PV (\u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c/\u0447\u0438\u0442\u0430\u0442\u044c/\u0438\u0437\u043c\u0435\u043d\u044f\u0442\u044c/\u0443\u0434\u0430\u043b\u044f\u0442\u044c) \u043c\u043e\u0436\u043d\u043e \u0447\u0435\u0440\u0435\u0437 \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442</p> <p>PersistentVolumeClaim (PVC) - \u044d\u0442\u043e \u0437\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0435 PersistentVolume (PV)</p> <p>\u0421 \u043f\u043e\u043c\u043e\u0449\u044c\u044e PVC \u043c\u043e\u0436\u043d\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435\u043c \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043f\u0443\u0442\u0435\u043c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u043f\u043e\u0434\u0430\u043c \u0434\u0438\u0441\u043a\u043e\u0432 \u0441 \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0430\u043c\u0438</p> <p>PVC \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u043a \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0435\u043c\u0443 PV, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0441\u043e\u0437\u0434\u0430\u043d \u0438\u0437 \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u0430, \u0438\u043b\u0438 \u0441\u043e\u0437\u0434\u0430\u043d \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u043e\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u043e\u043c \u043f\u0440\u043e\u0432\u0438\u0436\u0438\u043d\u0438\u043d\u0433\u0430</p> <p>\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 PVC \u0440\u0430\u0441\u043f\u043e\u043b\u0430\u0433\u0430\u0435\u0442\u0441\u044f \u0432 \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u0435 \u0434\u0435\u043f\u043b\u043e\u0439\u043c\u0435\u043d\u0442\u0430 \u0432\u0430\u0448\u0435\u0439 \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438</p> <ul> <li>Deployment \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0437\u0430\u043f\u0438\u0441\u044c \u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f PVC</li> <li>PVC \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f \u043a \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0443 (PV)</li> <li>PV \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u0438\u043b\u0438 \u043f\u0440\u043e\u0432\u0438\u0436\u0438\u043d\u0438\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435</li> </ul>"},{"location":"05%20Kubernetes/5.3_Kubernetes/","title":"5.3 Services and Ingress","text":"<ul> <li>\u0421\u0435\u0440\u0432\u0438\u0441 \u044d\u0442\u043e \u043e\u0431\u044a\u0435\u043a\u0442 kubernetes, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0435\u0434\u0438\u043d\u0443\u044e \u0442\u043e\u0447\u043a\u0443 \u0432\u0445\u043e\u0434\u0430 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043f\u043e\u0434\u0430\u043c \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u0445 \u043e\u0434\u043d\u043e \u0438 \u0442\u043e\u0436\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435</li> <li>\u0421\u0435\u0440\u0432\u0438\u0441 (Service) \u0432 Kubernetes \u2014 \u044d\u0442\u043e \u0430\u0431\u0441\u0442\u0440\u0430\u043a\u0442\u043d\u044b\u0439 \u043e\u0431\u044a\u0435\u043a\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043d\u0430\u0431\u043e\u0440 \u043f\u043e\u0434\u043e\u0432 \u0438 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0443 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043d\u0438\u043c.</li> <li>\u0421\u0435\u0440\u0432\u0438\u0441\u044b \u0441\u043e\u0437\u0434\u0430\u044e\u0442 \u0441\u043b\u0430\u0431\u0443\u044e \u0441\u0432\u044f\u0437\u044c \u043c\u0435\u0436\u0434\u0443 \u043f\u043e\u0434\u0430\u043c\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u0442 \u043d\u0438\u0445 \u0437\u0430\u0432\u0438\u0441\u044f\u0442. </li> </ul> <p>Note</p> <p>\u041f\u043e\u0434\u044b \u2013 \u044d\u0442\u043e \u043d\u0435 \u043f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u044b\u0435 \u0441\u0443\u0449\u043d\u043e\u0441\u0442\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430. \u0412 \u043b\u044e\u0431\u043e\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u043f\u043e\u0434 \u0438\u043b\u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043d\u0435 \u043d\u0443\u0436\u043d\u044b\u0439. \u041f\u0440\u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0438 \u043f\u043e\u0434\u0430 \u043c\u0435\u0436\u0434\u0443 \u043d\u043e\u0434\u0430\u043c\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430, \u043f\u043e\u0434 \u0441\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043d\u043e\u0432\u043e\u0439 \u043d\u043e\u0434\u0435 \u0438 \u0443\u0434\u0430\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430 \u0441\u0442\u0430\u0440\u043e\u0439. \u041f\u0440\u0438 \u044d\u0442\u043e\u043c \u0443 \u043f\u043e\u0434\u0430 \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f IP \u0430\u0434\u0440\u0435\u0441. \u0418\u043c\u0435\u043d\u043d\u043e \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043d\u0435 \u0441\u0442\u043e\u0438\u0442 \u043e\u0431\u0440\u0430\u0449\u0430\u0442\u044c\u0441\u044f \u043a \u043f\u043e\u0434\u0443 \u043f\u043e ip \u0430\u0434\u0440\u0435\u0441\u0443.</p> <pre><code>kubectl create -f svc.yaml\n\nkubectl get services\n\nkubectl get svc\n\n# \u041f\u0440\u0438\u043c\u0435\u0440: \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c curl \u0432\u043d\u0443\u0442\u0440\u0438 \u043f\u043e\u0434\u0430 \u043d\u0430 \u0441\u0435\u0440\u0432\u0438\u0441\n# -- \u043e\u0437\u043d\u0430\u0447\u0430\u0435\u0442 \u0434\u043b\u044f kubectl \u043e\u0431 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u0438 \u0432\u0432\u043e\u0434\u0430 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432\n# \u0435\u0441\u043b\u0438 \u0431\u044b \u043c\u044b \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0438 -- \u0442\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 -s \u043f\u043e\u043f\u044b\u0442\u0430\u043b\u0441\u044f \u0431\u044b \u043e\u0442\u043d\u0435\u0441\u0442\u0438 \u043a kubectl\nkubectl exec kubia-9g -- curl -s http://10.105.77.0\n</code></pre> <p>Info</p> <p>ping \u0434\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u0430 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u043d\u0435 \u0431\u0443\u0434\u0435\u0442, \u0442.\u043a. service \u0430\u0441\u043e\u0446\u0438\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0441 ip \u0438 port</p>"},{"location":"05%20Kubernetes/5.3_Kubernetes/#4","title":"4 \u0442\u0438\u043f\u0430 \u0441\u0435\u0440\u0432\u0438\u0441\u0430","text":"<ul> <li>ClusterIP (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e) \u2014 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0441\u0435\u0440\u0432\u0438\u0441\u0443 \u043f\u043e \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0435\u043c\u0443 IP-\u0430\u0434\u0440\u0435\u0441\u0443 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435. \u042d\u0442\u043e\u0442 \u0442\u0438\u043f \u0434\u0435\u043b\u0430\u0435\u0442 \u0441\u0435\u0440\u0432\u0438\u0441 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430;</li> <li>NodePort \u2014 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0441\u0435\u0440\u0432\u0438\u0441 \u043d\u0430 \u0442\u043e\u043c \u0436\u0435 \u043f\u043e\u0440\u0442\u0443 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0443\u0437\u043b\u0430 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e NAT. \u0414\u0435\u043b\u0430\u0435\u0442 \u0441\u0435\u0440\u0432\u0438\u0441 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u043c \u0432\u043d\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0447\u0435\u0440\u0435\u0437 :. \u042f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430\u0434\u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u043e\u043c ClusterIP. <li>LoadBalancer \u2014 \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0432\u043d\u0435\u0448\u043d\u0438\u0439 \u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0449\u0438\u043a \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u043c \u043e\u0431\u043b\u0430\u043a\u0435 (\u0435\u0441\u043b\u0438 \u044d\u0442\u043e \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f) \u0438 \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u0442 \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0432\u043d\u0435\u0448\u043d\u0438\u0439 IP-\u0430\u0434\u0440\u0435\u0441 \u0434\u043b\u044f \u0441\u0435\u0440\u0432\u0438\u0441\u0430. \u042f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430\u0434\u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u043e\u043c NodePort.</li> <li>ExternalName \u2014 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0441\u0435\u0440\u0432\u0438\u0441\u0443 \u043f\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u043c\u0443 \u043f\u043e\u043b\u044f externalName (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, foo.bar.example.com), \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u044f \u0437\u0430\u043f\u0438\u0441\u044c CNAME \u0441 \u0435\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\u043c. \u041f\u0440\u0438 \u044d\u0442\u043e\u043c \u043f\u0440\u043e\u043a\u0441\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f.</li>"},{"location":"05%20Kubernetes/5.3_Kubernetes/#ingress","title":"Ingress","text":"<ul> <li>\u0420\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043d\u0430 OSI \u0443\u0440\u043e\u0432\u043d\u0435 7</li> <li>\u041e\u043f\u0435\u0440\u0438\u0440\u0443\u0435\u0442 \u043d\u0430 \u0443\u0440\u043e\u0432\u043d\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0441\u0442\u0435\u043a\u0430</li> <li>\u041c\u043e\u0436\u0435\u0442 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430 \u0442\u0430\u043a\u043e\u0439 \u043a\u0430\u043a \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0441\u0435\u0441\u0441\u0438\u0438</li> </ul>"},{"location":"05%20Kubernetes/5.4_Helm/","title":"5.4 Helm","text":"<p>Helm \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u043e\u043c \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0434\u043b\u044f Kubernetes, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0443\u043f\u0440\u043e\u0449\u0430\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f\u043c\u0438 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430\u0445 Kubernetes. \u041e\u043d \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u043e\u0431\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0443, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430\u043c \u0443\u043f\u0430\u043a\u043e\u0432\u044b\u0432\u0430\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0432 \u0435\u0434\u0438\u043d\u044b\u0435 \u043f\u0430\u043a\u0435\u0442\u044b, \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0435 \u043a\u0430\u043a \u0447\u0430\u0440\u0442\u044b (charts), \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u043b\u0435\u0433\u043a\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b, \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u044b \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 Kubernetes.</p> <p>\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430 Helm \u0432\u043a\u043b\u044e\u0447\u0430\u044e\u0442:</p> <ul> <li>\u0423\u043f\u0440\u043e\u0449\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439: Helm \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043a\u0430\u043a \u043d\u0430\u0431\u043e\u0440 \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 Kubernetes \u0441 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u043c\u0438 \u0432\u0435\u0440\u0441\u0438\u044f\u043c\u0438, \u0447\u0442\u043e \u0441\u043e\u043a\u0440\u0430\u0449\u0430\u0435\u0442 \u0443\u0441\u0438\u043b\u0438\u044f \u0438 \u0443\u043f\u0440\u043e\u0449\u0430\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f.</li> <li>\u0411\u043e\u0433\u0430\u0442\u0430\u044f \u044d\u043a\u043e\u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0447\u0430\u0440\u0442\u043e\u0432: Helm \u0434\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043e\u0431\u0448\u0438\u0440\u043d\u043e\u0439 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0435 \u0447\u0430\u0440\u0442\u043e\u0432, \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u043e\u043c, \u0447\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043b\u0435\u0433\u043a\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c \u0433\u043e\u0442\u043e\u0432\u044b\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439 \u0438 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432.</li> <li>\u041f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u044c \u0438 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u0438\u0437\u0430\u0446\u0438\u044f: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0447\u0430\u0440\u0442\u043e\u0432 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u044c \u0438 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u0438\u0437\u0430\u0446\u0438\u044e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439, \u0447\u0442\u043e \u0432\u0430\u0436\u043d\u043e \u0434\u043b\u044f \u043d\u0435\u043f\u0440\u0435\u0440\u044b\u0432\u043d\u043e\u0439 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u0438 \u043d\u0435\u043f\u0440\u0435\u0440\u044b\u0432\u043d\u043e\u0439 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438 (CI/CD).</li> <li>\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0440\u0435\u043b\u0438\u0437\u0430\u043c\u0438: Helm \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043b\u0435\u0433\u043a\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u043c\u0438 \u0432\u0435\u0440\u0441\u0438\u044f\u043c\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439, \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0442\u044c \u0438\u0445 \u0438 \u043e\u0442\u043a\u0430\u0442\u044b\u0432\u0430\u0442\u044c \u043a \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u043c \u0432\u0435\u0440\u0441\u0438\u044f\u043c \u043f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438.</li> </ul>"},{"location":"05%20Kubernetes/5.4_Helm/#_1","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b","text":"<pre><code>helm template my-nginx bitnami/nginx\n\nhelm install my-nginx bitnami/nginx\n\nhelm upgrade my-nginx bitnami/nginx --set replicaCount=2\n\nhelm upgrade my-nginx bitnami/nginx -f stage.yaml\n\nhelm uninstall my-nginx\n</code></pre>"},{"location":"05%20Kubernetes/5.4_Helm/#_2","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0440\u0435\u043b\u0438\u0437\u0430\u043c\u0438","text":"<ul> <li>RELEASE - \u044d\u0442\u043e \u0438\u043c\u044f \u0440\u0435\u043b\u0438\u0437\u0430, \u043a \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0442\u043a\u0430\u0442.</li> <li>[REVISION] - \u044d\u0442\u043e \u043d\u043e\u043c\u0435\u0440 \u0440\u0435\u0432\u0438\u0437\u0438\u0438, \u043a \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0442\u043a\u0430\u0442\u0438\u0442\u044c\u0441\u044f. \u0415\u0441\u043b\u0438 \u044d\u0442\u043e\u0442 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442 \u043e\u043f\u0443\u0449\u0435\u043d \u0438\u043b\u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u043d\u0430 0, \u043a\u043e\u043c\u0430\u043d\u0434\u0430 \u043e\u0442\u043a\u0430\u0442\u0438\u0442 \u0440\u0435\u043b\u0438\u0437 \u043a \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u043c\u0443 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044e.</li> <li>[flags] - \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0444\u043b\u0430\u0433\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0441 \u043a\u043e\u043c\u0430\u043d\u0434\u043e\u0439, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 --dry-run \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u0431\u0435\u0437 \u0438\u0445 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f.</li> </ul> <pre><code>helm rollback &lt;RELEASE&gt; [REVISION] [flags]\n\nhelm rollback my-nginx\n\nhelm history my-nginx\n\nhelm rollback my-nginx 1\n</code></pre>"},{"location":"05%20Kubernetes/5.4_Helm/#_3","title":"\u0428\u0430\u0431\u043b\u043e\u043d\u0438\u0437\u0430\u0442\u043e\u0440","text":"<p>\u0428\u0430\u0431\u043b\u043e\u043d\u0438\u0437\u0430\u0442\u043e\u0440 Helm \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 Go \u0448\u0430\u0431\u043b\u043e\u043d\u044b \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u043e\u0432 Kubernetes \u0438\u0437 \u0447\u0430\u0440\u0442\u043e\u0432. \u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430\u043c \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0438 \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u043c\u044b\u0435 \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u044b \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0439, \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 \u0432 values.yaml \u0444\u0430\u0439\u043b\u0435 \u0447\u0430\u0440\u0442\u0430. \u0428\u0430\u0431\u043b\u043e\u043d\u0438\u0437\u0430\u0442\u043e\u0440 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0442\u0430\u043a\u0438\u0435 \u043a\u0430\u043a \u0446\u0438\u043a\u043b\u044b, \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435, \u0447\u0442\u043e \u0434\u0435\u043b\u0430\u0435\u0442 \u0435\u0433\u043e \u043c\u043e\u0449\u043d\u044b\u043c \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u043c \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u043e\u0432.</p> <p>\u0412\u0441\u0442\u0430\u0432\u043a\u0430 <pre><code>labels:\n  {{- include \"grafana.labels\" . | nindent 4 }}\n  {{- with .Values.labels }}\n  {{- toYaml . | nindent 4 }}\n  {{- end }}\n</code></pre> \u0423\u0441\u043b\u043e\u0432\u0438\u0435 <pre><code>{{- if .Values.dashboards }}\nchecksum/dashboards-json-config: {{ include (print $.Template.BasePath \"/dashboards-json-configmap.yaml\") . | sha256sum }}\n{{- end }}\n</code></pre> \u0426\u0438\u043a\u043b <pre><code>{{- range $key, $value := .Values.imageRenderer.envValueFrom }}\n  - name: {{ $key | quote }}\n    valueFrom:\n      {{- tpl (toYaml $value) $ | nindent 16 }}\n{{- end }}\n</code></pre></p>"},{"location":"05%20Kubernetes/5.4_Helm/#helm-chart","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0432\u043e\u0435\u0433\u043e helm chart","text":"<pre><code>mychart/\n Chart.yaml\n values.yaml\n templates/\n    deployment.yaml\n    service.yaml\n    _helpers.tpl\n charts/\n    mydependency/\n .helmignore\n README.md\n requirements.yaml\n NOTES.txt\n</code></pre> <p>\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0432 Helm \u0447\u0430\u0440\u0442\u0435 \u0438 \u0438\u0445 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0432\u043a\u043b\u044e\u0447\u0430\u044e\u0442:</p> <ul> <li>Chart.yaml: \u042d\u0442\u043e\u0442 \u0444\u0430\u0439\u043b \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0447\u0430\u0440\u0442\u0435, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0435\u0433\u043e \u0432\u0435\u0440\u0441\u0438\u044e, \u0438\u043c\u044f, \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435.</li> <li>values.yaml: \u042d\u0442\u043e\u0442 \u0444\u0430\u0439\u043b \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0445 \u0432 \u0448\u0430\u0431\u043b\u043e\u043d\u0430\u0445 \u0447\u0430\u0440\u0442\u0430.</li> <li>templates/: \u0412 \u044d\u0442\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u044b Kubernetes.</li> <li>charts/: \u0415\u0441\u043b\u0438 \u0432\u0430\u0448 \u0447\u0430\u0440\u0442 \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u0434\u0440\u0443\u0433\u0438\u0445 \u0447\u0430\u0440\u0442\u043e\u0432, \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u044d\u0442\u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u0432 \u044d\u0442\u043e\u0439 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0438.</li> <li>NOTES.txt: \u0432 Helm \u0447\u0430\u0440\u0442\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043f\u043e\u0441\u043b\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0433\u043e \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f \u0447\u0430\u0440\u0442\u0430. \u042d\u0442\u043e\u0442 \u0444\u0430\u0439\u043b \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043f\u043e\u043b\u0435\u0437\u043d\u044b\u0435 \u0441\u0432\u0435\u0434\u0435\u043d\u0438\u044f, \u0442\u0430\u043a\u0438\u0435 \u043a\u0430\u043a \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 URL-\u0430\u0434\u0440\u0435\u0441\u0430, \u0443\u0447\u0435\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430, \u0448\u0430\u0433\u0438 \u0434\u043b\u044f \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0439 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0438\u043b\u0438 \u043b\u044e\u0431\u0443\u044e \u0434\u0440\u0443\u0433\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u043c\u043e\u0447\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c \u0432 \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044b\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435\u043c \u0438\u043b\u0438 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u043c.</li> </ul> <pre><code>helm create new-app\n\nhelm lint new-app\n</code></pre> <p>\u0424\u0430\u0439\u043b _helpers.tpl \u043f\u043e\u043c\u043e\u0433\u0430\u0435\u0442 \u0443\u043f\u0440\u043e\u0441\u0442\u0438\u0442\u044c \u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u0434 \u0432 \u0448\u0430\u0431\u043b\u043e\u043d\u0430\u0445 \u0447\u0430\u0440\u0442\u0430, \u0434\u0435\u043b\u0430\u044f \u0438\u0445 \u0431\u043e\u043b\u0435\u0435 \u0447\u0438\u0442\u0430\u0435\u043c\u044b\u043c\u0438 \u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u043c\u0438.</p> <code>_helpers.tpl</code> <code>pod.yaml</code> <pre><code>{{- define \"mychart.labels\" }}\napp.kubernetes.io/name: {{ include \"mychart.name\" . }}\napp.kubernetes.io/instance: {{ .Release.Name }}\napp.kubernetes.io/version: {{ .Chart.AppVersion | quote }}\napp.kubernetes.io/managed-by: {{ .Release.Service }}\n{{- end }}\n</code></pre> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n name: {{ include \"mychart.fullname\" . }}\n labels:\n    {{- include \"mychart.labels\" . | nindent 4 }}\n</code></pre>"},{"location":"05%20Kubernetes/5.4_Helm/#loki","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0447\u0430\u0440\u0442\u0430 loki","text":"<pre><code>helm repo add grafana https://grafana.github.io/helm-charts\n\nhelm pull grafana/loki-stack --untar\n\n$ vim value.yaml\ngrafana:\n  enabled: true\n\nhelm upgrade --install loki --namespace=monitoring --values values.yaml grafana/loki-stack\n\nkubectl get secret loki-grafana -n monitoring -o json\n\nkubectl port-forward svc/loki-grafana 3000:3000\n</code></pre>"},{"location":"05%20Kubernetes/5.7_Security/","title":"5.7 \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0432 K8s","text":"<p>\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c k8s \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0445 \u044d\u0442\u0430\u043f\u0430\u0445: - \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c docker image - Admission controllers   * \u044d\u0442\u043e \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u043b\u0430\u0433\u0438\u043d\u044b k8s, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0435\u0440\u0435\u0445\u0432\u0430\u0442\u044b\u0432\u0430\u044e\u0442 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 API Kubernetes \u0434\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u0430, \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u043f\u043e\u0434\u043b\u0438\u043d\u043d\u043e\u0441\u0442\u0438 \u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 - \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0445\u043e\u0441\u0442\u0430 (node) - \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0432 \u0440\u0430\u043d\u0442\u0430\u0439\u043c\u0435 (pod security admisson) - Network security - Application security</p>"},{"location":"05%20Kubernetes/5.7_Security/#docker","title":"\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c docker","text":"<p>\u0411\u0430\u0437\u043e\u0432\u044b\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u043f\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 docker:</p> <ul> <li>\u0420\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u043e \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0439\u0442\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f</li> <li>\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0439\u0442\u0435 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0441\u043e\u043a\u0435\u0442\u0443 docker \u0438 \u043d\u0435 \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0439\u0442\u0435 \u0435\u0433\u043e \u0431\u0435\u0437 \u0437\u0430\u0449\u0438\u0442\u044b</li> <li>\u0421\u043e\u0437\u0434\u0430\u0432\u0430\u0439\u0442\u0435 \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043d\u0435\u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430</li> <li>\u041d\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0439\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u0441 \u043f\u043e\u0432\u044b\u0448\u0435\u043d\u043d\u044b\u043c\u0438 \u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u044f\u043c\u0438</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043f\u0440\u043e\u0444\u0438\u043b\u044c\u043d\u044b\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 docker \u043e\u0431\u0440\u0430\u0437\u043e\u0432 \u043d\u0430 \u043f\u0440\u0435\u0434\u043c\u0435\u0442 \u0443\u044f\u0437\u0432\u0438\u043c\u043e\u0441\u0442\u0435\u0439</li> <li>\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0439\u0442\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430 \u0438 \u0435\u0433\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u044b</li> <li>\u041f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0430\u0439\u0442\u0435 \u043f\u043e\u0432\u044b\u0449\u0435\u043d\u0438\u0435 \u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u0439 \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430</li> <li>\u041e\u0442\u043a\u043b\u044e\u0447\u0430\u0439\u0442\u0435 \u043c\u0435\u0436\u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043d\u043e\u0435 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043c\u043e\u0434\u0443\u043b\u0438 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 Linux</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 readonly \u0424\u0421 \u0438 docker volumes</li> </ul> <p>\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u043f\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 docker:</p> <ul> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043b\u0435\u0433\u043a\u043e\u0432\u0435\u0441\u043d\u044b\u0435 \u043e\u0431\u0440\u0430\u0437\u044b \u041e\u0421</li> <li>\u041f\u043e\u0434\u043f\u0438\u0441\u044b\u0432\u0430\u0439\u0442\u0435 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0439\u0442\u0435 docker-\u043e\u0431\u0440\u0430\u0437\u044b \u0434\u043b\u044f \u043c\u0438\u0442\u0438\u0433\u0430\u0446\u0438\u0438 \u0430\u0442\u0430\u043a MITM</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0434\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u044b\u0435 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442\u043e\u0432</li> <li>\u041f\u0440\u0438\u043c\u0435\u043d\u044f\u0439\u0442\u0435 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u043c\u043d\u043e\u0433\u043e\u044d\u0442\u0430\u043f\u043d\u043e\u0439 \u0441\u0431\u043e\u0440\u043a\u0438 (multistaging)</li> <li>\u041d\u0435 \u0434\u043e\u043f\u0443\u0441\u043a\u0430\u0439\u0442\u0435 \u0443\u0442\u0435\u0447\u043a\u0438 \u0441\u0435\u043d\u0441\u0435\u0442\u0438\u0432\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u0432 Dockerfile</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0442\u0435\u0433\u0438 \u0432\u0435\u0440\u0441\u0438\u0439 \u043e\u0431\u0440\u0430\u0437\u043e\u0432</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044e COPY \u0432\u043c\u0435\u0441\u0442\u043e ADD</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043b\u0438\u043d\u0442\u0435\u0440\u044b \u043f\u0440\u0438 \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 Dockerfile</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043f\u043e\u043b\u043d\u043e\u0446\u0435\u043d\u043d\u044b\u0439 DevSecOps-\u043a\u043e\u043d\u0432\u0435\u0439\u0435\u0440</li> </ul> <p>\u0411\u0430\u0437\u043e\u0432\u044b\u0435 \u043f\u0440\u0438\u043d\u0446\u0438\u043f\u044b \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0445\u043e\u0441\u0442\u0430</p> <ul> <li>\u0420\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u043e \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0439\u0442\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f (\u041e\u0421, \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438, \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438)</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u0441\u043a\u0430\u043d\u0435\u0440\u044b (nessus, openvas greenbone, xspider)</li> <li>\u041f\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438, \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 public-ip (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0435 \u0441\u0435\u0442\u0438 \u0438\u043b\u0438 VPN)</li> </ul> <p>Sysdig Falco \u2014 opensource-\u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442 \u0434\u043b\u044f \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u0430\u043d\u043e\u043c\u0430\u043b\u0438\u0439 \u0438 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0435.</p>"},{"location":"05%20Kubernetes/5.7_Security/#network-security","title":"Network security","text":"<p>\u0412 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 k8s \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u043d\u0430\u0431\u043b\u044e\u0434\u0430\u0435\u0442\u0441\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0441 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c\u044e:</p> <ul> <li>\u0442\u0440\u0430\u0444\u0438\u043a \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0440\u0430\u0437\u0440\u0435\u0449\u0435\u043d \u0438 \u043d\u0438\u043a\u0430\u043a \u043d\u0435 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u0438\u0440\u0443\u0435\u0442\u0441\u044f (\u0435\u0441\u043b\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f, \u043a \u043f\u0440\u0438\u043c\u0435\u0440\u0443, service mesh)</li> <li>\u0430\u0434\u0440\u0435\u0441\u0430 \u043f\u043e\u0434\u043e\u0432 \u0447\u0430\u0441\u0442\u043e \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f</li> <li>\u0442\u0440\u0430\u0444\u0438\u043a \u043d\u0435 \u0449\u0438\u0444\u0440\u0443\u0435\u0442\u0441\u044f (\u0435\u0441\u043b\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0441\u0440\u0435\u0434\u0441\u0442\u0432, service mesh \u0432 \u0442\u043e\u043c \u0447\u0438\u0441\u043b\u0435)</li> </ul> <p>\u0414\u043b\u044f \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u043e\u0432 \u0434\u043b\u0101 \u0436\u0435\u043b\u0430\u0435\u043c\u044b\u0445 Network Policy \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442 cilium editor (cni cilium) - https://editor.cilium.io/</p> <p>Service mesh</p> <p>\u0412 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u0438 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0441\u0435\u0442\u0435\u0439 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 \u0432\u0430\u043c \u0442\u0430\u043a\u0436\u0435 \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u043c\u043e\u0447\u044c \u0441\u0435\u0440\u0432\u0438\u0441\u043d\u0430\u044f \u0441\u0435\u0442\u043a\u0430 (service mesh)</p> <p>\u0421\u0435\u0440\u0432\u0438\u0441\u043d\u0430\u044f \u0441\u0435\u0442\u043a\u0430 \u2013 \u044d\u0442\u043e \u043d\u0430\u0431\u043e\u0440 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0438\u0445 \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u0442\u044c \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043c\u0435\u0436\u0434\u0443 \u043c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0441\u0445\u0435\u043c\u0443 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0438 \u043a\u043e\u0434\u044b HTTP-\u0441\u0442\u0430\u0442\u0443\u0441\u043e\u0432 \u043c\u0435\u0436\u0434\u0443 \u043d\u0438\u043c\u0438.</p> <p>\u041f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430 \u0441\u0435\u0440\u0432\u0438\u0441\u043d\u043e\u0439 \u0441\u0435\u0442\u043a\u0438 (service mesh) \u043d\u0430 \u0431\u0430\u0437\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u0430 Istio:</p> <ul> <li>Istio \u2013 \u0432\u043c\u0435\u0448\u0430\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u043e \u0432 \u0441\u0435\u0442\u0435\u0432\u043e\u0435 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435</li> <li>\u041e\u0442\u043a\u0430\u0437\u043e\u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u043e\u0441\u0442\u044c: \u0440\u0435\u0442\u0440\u0430\u0439 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043f\u0440\u0438 \u0441\u0431\u043e\u0435 (\u0431\u043b\u0430\u0433\u043e\u0434\u0430\u0440\u044f \u043a\u043e\u0434\u0443 \u043e\u0442\u0432\u0435\u0442\u0430)</li> <li>\u041a\u0430\u043d\u0430\u0440\u0435\u0435\u0447\u043d\u044b\u0435 \u0432\u044b\u043a\u0430\u0442\u044b: \u0440\u0435\u0433\u0443\u043b\u0438\u0440\u0443\u0435\u0442 \u043f\u0440\u043e\u0446\u0435\u043d\u0442 \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0442\u0440\u0430\u0444\u0438\u043a\u0430 \u043d\u0430 \u043d\u043e\u0432\u043e\u0439 \u0432\u0435\u0440\u0441\u0438\u0438 \u0441\u0435\u0440\u0432\u0438\u0441\u0430</li> <li>\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0440\u0430\u0444\u0438\u043a\u043e\u043c (\u0442\u0430\u0439\u043c\u0430\u0443\u0442\u044b, \u0440\u0435\u0442\u0440\u0430\u0438, \u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u043a\u0430)</li> <li>\u041d\u0430\u0431\u043b\u044e\u0434\u0430\u0435\u043c\u043e\u0441\u0442\u044c: \u0436\u0443\u0440\u043d\u0430\u043b\u044b, \u043c\u0435\u0442\u0440\u0438\u043a\u0438, \u0442\u0440\u0430\u0441\u0441\u0438\u0440\u043e\u0432\u043a\u0438</li> <li>\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c: \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f, \u0440\u0430\u0431\u043e\u0442\u0430 \u0441 \u0442\u043e\u043a\u0435\u043d\u0430\u043c\u0438, \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u0442\u0440\u0430\u0444\u0438\u043a\u0430</li> </ul>"},{"location":"05%20Kubernetes/5.7_Security/#app-security","title":"App security","text":"<p>\u0414\u043b\u044f \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044b\u0445 \u0432 \u0432\u0430\u0448\u0435\u043c \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0435 k8s \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439 \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c\u0438 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u044f\u043c\u0438:</p> <ul> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 k8s secrets (\u0438\u043b\u0438 HashiCorp Vault \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u044b)</li> <li>\u041f\u0440\u0438\u043c\u0435\u043d\u044f\u0439\u0442\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438 devsecops (SAST, SCA, DAST, IAST, RASP)</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u043d\u0443\u044e \u0441\u0435\u0442\u043a\u0443 (service mesh) \u0434\u043b\u044f \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044f \u0437\u0430 \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u043c\u0438 \u043f\u043e\u0442\u043e\u043a\u0430\u043c\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439, \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u043d\u044b\u043c\u0438 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044f\u043c\u0438 \u0434\u0435\u043f\u043b\u043e\u044f \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f)</li> <li>\u041f\u0440\u043e\u0432\u043e\u0434\u0438\u0442\u0435 \u0430\u0443\u0434\u0438\u0442 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043f\u0440\u043e\u0444\u0438\u043b\u044c\u043d\u00fd\u0445 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438: kube-hunter, kube-audit, chaos-monkey \u0438 \u043f\u0440\u043e\u0447.</li> </ul>"},{"location":"05%20Kubernetes/5.7_Security/#kubernetes-system-admin","title":"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u0432 Kubernetes system-admin","text":"<p>\u0418\u0437 kube/conf \u0431\u0435\u0440\u0435\u043c \u043f\u043e\u043b\u0435 client-certificate-data \u0438 \u0434\u0435\u043a\u043e\u0434\u0438\u0440\u0443\u0435\u043c, \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 pem</p> <p><pre><code>echo \"client-certificate-data\" | base64 -d &gt; cert.pem\n</code></pre> \u0414\u0430\u043b\u0435\u0435 \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u044b\u0432\u0430\u0435\u043c \u0441\u0430\u043c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 <pre><code>openssl x509 -in cert.pem -text -noout\n</code></pre> \u0412 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d Subject, Public-Key, Signature <pre><code>---\nCertificate:\n    Data:\n        Subject: O = system:masters, CN = system:admin\n        Public-Key\n        Signature Value\n</code></pre> \u041d\u0430\u0439\u0434\u0435\u043c \u0432\u0441\u0435 \u043f\u0440\u0430\u0432\u0430 \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u043b\u0438 \u0433\u0440\u0443\u043f\u043f\u044b <pre><code>kubectl get rolebinding,clusterrolebinding --all-namespaces -o yaml | grep system:masters -B 20\n\n---\n- apiVersion: rbac.authorization.k8s.io/v1\n  kind: ClusterRoleBinding\n  metadata:\n    annotations:\n      rbac.authorization.kubernetes.io/autoupdate: \"true\"\n    creationTimestamp: \"2024-01-16T09:35:53Z\"\n    labels:\n      kubernetes.io/bootstrapping: rbac-defaults\n    name: cluster-admin\n    resourceVersion: \"139\"\n    uid: 652339e7-38c8-4009-8ddf-adc61b7154c4\n  roleRef:\n    apiGroup: rbac.authorization.k8s.io\n    kind: ClusterRole\n    name: cluster-admin\n  subjects:\n  - apiGroup: rbac.authorization.k8s.io\n    kind: Group\n    name: system:masters\n</code></pre> \u0418 \u0442\u0435\u043f\u0435\u0440\u044c \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0441\u0430\u043c\u0443 \u0440\u043e\u043b\u044c <pre><code>kubectl get clusterrole/cluster-admin -o yaml\n</code></pre> <pre><code>---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  annotations:\n    rbac.authorization.kubernetes.io/autoupdate: \"true\"\n  creationTimestamp: \"2024-01-16T09:35:53Z\"\n  labels:\n    kubernetes.io/bootstrapping: rbac-defaults\n  name: cluster-admin\n  resourceVersion: \"77\"\n  uid: 7a87ee32-c6bf-409b-bca6-5abe5c833c30\nrules:\n- apiGroups:\n  - '*'\n  resources:\n  - '*'\n  verbs:\n  - '*'\n- nonResourceURLs:\n  - '*'\n  verbs:\n  - '*'\n</code></pre></p> <pre><code>kubectl auth can-i list pods --as jean\n</code></pre>"},{"location":"05%20Kubernetes/5.7_Security/#x509","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0438 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0445 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 X.509","text":"<p><pre><code>openssl genrsa -out pavel.key 2048\nopenssl req -new -key pavel.key \\\\n-out pavel.csr \\\\n-subj \"/CN=pavel\"\ncat pavel.csr | base64\nnvim csr.yaml\n</code></pre> <pre><code>apiVersion: certificates.k8s.io/v1\nkind: CertificateSigningRequest\nmetadata:\n  name: pavel\nspec:\n  request: LS0tLS1CRULS0tLQo=\n  signerName: kubernetes.io/kube-apiserver-client\n  expirationSeconds: 86400  # one day\n  usages:\n  - client auth\n</code></pre> <pre><code>kubectl apply -f csr.yaml\nkubectl get csr\nkubectl certificate approve pavel\nkubectl get csr pavel -o jsonpath='{.status.certificate}'| base64 -d &gt; pavel.crt\nkubectl config --kubeconfig pavel-kubeconfig set-credentials pavel --client-key=pavel.key --client-certificate=pavel.crt --embed-certs=true\nkubectl config --kubeconfig pavel-kubeconfig set-context pavel --user=pavel\nkubectl config --kubeconfig pavel-kubeconfig get-contexts\nkubectl get pods\n</code></pre> <pre><code>---\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n namespace: default\n name: pod-reader\nrules:\n- apiGroups: [\"\"]\n  resources: [\"pods\"]\n  verbs: [\"get\", \"watch\", \"list\"]\n\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n name: pod-reader-binding\n namespace: default\nsubjects:\n- kind: User\n  name: pavel\n  apiGroup: rbac.authorization.k8s.io\nroleRef:\n kind: Role\n name: pod-reader\n apiGroup: rbac.authorization.k8s.io\n</code></pre> <pre><code>kubectl apply -f prr.yaml\nkubectl get pods\nexport KUBECONFIG=~/Documents/pavel-kubeconfig\nkubectl get pods\n</code></pre></p>"},{"location":"05%20Kubernetes/5.8_CKAD/","title":"5.8 KodeKloud CKAD","text":""},{"location":"05%20Kubernetes/5.8_CKAD/#core-commands","title":"Core commands","text":"<p>Pods</p> <pre><code>kubectl get pods\n\nkubectl get pods --namepace=test\n\nkubectl run webapp --image=nginx\n\nkubectl run redis --image=redis:alpine --dry-run=client -o=yaml &gt; redis-pod.yaml\n\nkubectl describe pod webapp\n\nkubectl get pods -o wide\n\nkubectl delete pod webapp\n</code></pre> <p>ReplicaSets</p> <pre><code>kubectl get replicaset\n\nkubectl get rs\n\nkubectl describe rs new-replica-set\n\nkubectl edit rs new-replica-set\n\nkubectl replace --force -f /tmp/kubectl-edit.yaml\n\nkubectl scale rs new-replica-set --replicas=5\n</code></pre> <p>Deployments</p> <pre><code>kubectl create deployment nginx --image=nginx --replicas=4\n\n# \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 \u043f\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u0443\nkubectl explain deployment\n\n# \u0421\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432\nkubectl api-resources\n\n# \u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f\nkubectl rollout history deployment/my-app\n\n# \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f\nkubectl rollout status deployment/my-app\n\n# \u041e\u0442\u043a\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u043a \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u043c\u0443 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044e\nkubectl rollout undo deployment/my-app\n\n# \u041e\u0442\u043a\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u043a 3 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044e\nkubectl rollout undo deployment/my-app --to-revision=3\n\n# \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0432 \u0444\u0430\u0439\u043b\nkubectl get deploy/my-deployment -o yaml &gt; my-deploy.yaml\n\n# Set a deployment's nginx container image to nginx:1.9.1\nkubectl set image deployment/nginx nginx=nginx:1.9.1\n\n# Update image of all containers of daemonset abc to nginx:1.9.1\nkubectl set image daemonset abc *=nginx:1.9.1\n</code></pre> <p>Service</p> <pre><code>kubectl get svc\n\nkubectl expose pod redis --port=6379 --name redis-service\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#service","title":"Service","text":"<p>\u0424\u043e\u0440\u043c\u0430\u0442 \u0434\u043e\u043c\u0435\u043d\u043d\u043e\u0433\u043e \u0438\u043c\u0435\u043d\u0438 \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043a \u0442\u0430\u043a\u043e\u043c\u0443 \u0441\u0435\u0440\u0432\u0438\u0441\u0443 \u0438\u0437\u043d\u0443\u0442\u0440\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 Kubernetes \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439:</p> <pre><code>&lt;service-name&gt;.&lt;namespace&gt;.svc.cluster.local\n</code></pre> <pre><code>---\napiVersion: v1\nkind: Service\nmetadata:\n  name: my-service\nspec:\n  type: NodePort\n  selector:\n    app.kubernetes.io/name: MyApp\n  ports:\n    - port: 80\n      targetPort: 80\n      # will allocate a port from a range (default: 30000-32767)\n      nodePort: 30007\n</code></pre> <p>Headless \u0441\u0435\u0440\u0432\u0438\u0441\u044b \u0432 Kubernetes \u2014 \u044d\u0442\u043e \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u0442\u0438\u043f \u0441\u0435\u0440\u0432\u0438\u0441\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u043d\u044b\u0439 IP-\u0430\u0434\u0440\u0435\u0441.</p> <p>\u0424\u043e\u0440\u043c\u0430\u0442 DNS-\u0437\u0430\u043f\u0438\u0441\u0438 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043e\u0434\u0430 \u0431\u0443\u0434\u0435\u0442  <pre><code>&lt;pod-name&gt;.&lt;headless-service-name&gt;.&lt;namespace&gt;.svc.cluster.local\n</code></pre></p> <pre><code>---\napiVersion: v1\nkind: Service\nmetadata:\n  name: my-service\nspec:\n  clusterIP: None\n  selector:\n    app: my-app\n  ports:\n  - protocol: TCP\n    port:  80\n    targetPort:  9376\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#configmap","title":"ConfigMap","text":"<pre><code>kubectl create configmap  webapp-config-map --from-literal=APP_COLOR=darkblue\n</code></pre> <pre><code>---\napiVersion: v1\nkind: ConfigMap\ndata:\n  testkey: hello\n  testkey2: hello2\n\n---\n  containers:\n    - name: test-container\n      image: registry.k8s.io/busybox\n      command: [ \"/bin/sh\", \"-c\", \"env\" ]\n      envFrom:\n      - configMapRef:\n          name: special-config\n\n---\n  containers:\n    - name: test-container\n      image: registry.k8s.io/busybox\n      command: [ \"/bin/sh\", \"-c\", \"env\" ]\n      env:\n        - name: SPECIAL_LEVEL_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: special-config\n              key: special.how\n\n---\n  containers:\n  - name: mypod\n    image: nginx\n    volumeMounts:\n    - name: config-volume\n      mountPath: /etc/config\n  volumes:\n  - name: config-volume\n    configMap:\n      name: my-configmap\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#secret","title":"Secret","text":"<pre><code>kubectl create secret generic db-secret --from-literal=DB_Host=sql01 --from-literal=DB_User=root\n</code></pre> <pre><code>---\napiVersion: v1\nkind: Secret\nmetadata:\n  name: mysecret\ntype: Opaque\ndata:\n  username: YWRtaW4=\n  password: MWYyZDFlMmU2N2Rm\n\n---\napiVersion: v1\nkind: Pod\nmetadata:\n  name: envfrom-secret\nspec:\n  containers:\n  - name: envars-test-container\n    image: nginx\n    envFrom:\n    - secretRef:\n        name: test-secret\n\n---\n  containers:\n  - name: envars-test-container\n    image: nginx\n    env:\n    - name: BACKEND_USERNAME\n      valueFrom:\n        secretKeyRef:\n          name: backend-user\n          key: backend-username\n\n---\n  containers:\n  - name: mypod\n    image: myimage\n    volumeMounts:\n    - name: mysecret\n      mountPath: \"/etc/mysecret\"\n      readOnly: true\n  volumes:\n  - name: mysecret\n    secret:\n      secretName: mysecret\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#persistent-volume","title":"Persistent Volume","text":"<pre><code>---\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: pv-log\nspec:\n  persistentVolumeReclaimPolicy: Retain\n  accessModes:\n    - ReadWriteMany\n  capacity:\n    storage: 100Mi\n  hostPath:\n    path: /pv/log\n\n---\nkind: PersistentVolumeClaim\napiVersion: v1\nmetadata:\n  name: claim-log-1\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 50Mi\n\n---\napiVersion: v1\nkind: Pod\nmetadata:\n  name: webapp\nspec:\n  containers:\n  - name: event-simulator\n    image: kodekloud/event-simulator\n    env:\n    - name: LOG_HANDLERS\n      value: file\n    volumeMounts:\n    - mountPath: /log\n      name: log-volume\n\n  volumes:\n  - name: log-volume\n    persistentVolumeClaim:\n      claimName: claim-log-1\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#network-policies","title":"Network Policies","text":"<pre><code>---\napiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: test-network-policy\n  namespace: default\nspec:\n  podSelector:\n    matchLabels:\n      role: db\n  policyTypes:\n  - Ingress\n  - Egress\n  ingress:\n  - from:\n    - ipBlock:\n        cidr: 172.17.0.0/16\n        except:\n        - 172.17.1.0/24\n    - namespaceSelector:\n        matchLabels:\n          project: myproject\n    - podSelector:\n        matchLabels:\n          role: frontend\n    ports:\n    - protocol: TCP\n      port: 6379\n  egress:\n  - to:\n    - ipBlock:\n        cidr: 10.0.0.0/24\n    - namespaceSelector:\n        matchExpressions:\n        - key: namespace\n          operator: In\n          values: [\"frontend\", \"backend\"]\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#node-affinity","title":"Node Affinity","text":"<pre><code>kubectl label node node01 color=blue\n</code></pre> <pre><code>---\nspec:\n  affinity:\n    nodeAffinity:\n      requiredDuringSchedulingIgnoredDuringExecution:\n        nodeSelectorTerms:\n        - matchExpressions:\n          - key: topology.kubernetes.io/zone\n            operator: In\n            values:\n            - antarctica-east1\n            - antarctica-west1\n      preferredDuringSchedulingIgnoredDuringExecution:\n      - weight: 1\n        preference:\n          matchExpressions:\n          - key: another-node-label-key\n            operator: In\n            values:\n            - another-node-label-value\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#pod-anti-affinity","title":"Pod Anti Affinity","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n name: my-pod\n labels:\n    app: myapp\nspec:\n affinity:\n    podAntiAffinity:\n      requiredDuringSchedulingIgnoredDuringExecution:\n      - labelSelector:\n          matchExpressions:\n          - key: app\n            operator: In\n            values:\n            - myapp\n        topologyKey: \"kubernetes.io/hostname\"\n containers:\n - name: my-container\n    image: myapp-image\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#pod-distruption-budgets","title":"Pod Distruption Budgets","text":"<pre><code>apiVersion: policy/v1beta1\nkind: PodDisruptionBudget\nmetadata:\n name: nginx-pdb\nspec:\n minAvailable: 1\n selector:\n   matchLabels:\n     app: nginx\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#taints-and-toleration","title":"Taints and Toleration","text":"<p>Taints \u044d\u0442\u043e \u0437\u0430\u043f\u0440\u0435\u0442, \u0440\u0430\u0437\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u044e\u0449\u0438\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u0442\u0430\u043a \u0447\u0442\u043e \u043f\u043e\u043f\u0430\u0441\u0442\u044c \u0442\u0443\u0434\u0430 \u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f\u043c. Tolerations \u2013 \u044d\u0442\u043e \u043a\u0430\u043a \u0440\u0430\u0437 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0432\u0445\u043e\u0434\u0430.</p> <pre><code>kubectl taint nodes node01 spray=mortein:NoSchedule\n</code></pre> <pre><code>---\napiVersion: v1\nkind: Pod\nmetadata:\n  name: bee\nspec:\n  containers:\n  - image: nginx\n    name: bee\n  tolerations:\n  - key: spray\n    value: mortein\n    effect: NoSchedule\n    operator: Equal\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#serviceaccount-role-binding","title":"ServiceAccount, Role, Binding","text":"<pre><code>kubectl create sa dashboard-sa\n\nkubectl create token dashboard-sa\n\nkubectl set serviceaccount deploy/web-dashboard dashboard-sa\n</code></pre> <pre><code>kubectl create clusterrole --help\n\nkubectl create clusterrole storage-admin --resource=persistentvolume,storageclasses --verb=list,create,get,watch\n\nkubectl create clusterrolebinding admin --user=admin --clusterrole=storage-admin\n</code></pre> <pre><code>---\nkind: Role\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  namespace: default\n  name: pod-reader\nrules:\n- apiGroups:\n  - ''\n  resourceNames:\n  - my-pod\n  resources:\n  - pods\n  verbs:\n  - get\n  - watch\n  - list\n\n---\nkind: RoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: read-pods\n  namespace: default\nsubjects:\n- kind: ServiceAccount\n  name: dashboard-sa # Name is case sensitive\n  namespace: default\nroleRef:\n  kind: Role #this must be Role or ClusterRole\n  name: pod-reader # this must match the name of the Role or ClusterRole you wish to bind to\n  apiGroup: rbac.authorization.k8s.io\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#lightning-lab-1","title":"Lightning Lab 1","text":""},{"location":"05%20Kubernetes/5.8_CKAD/#task-1","title":"Task 1","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c PV, PVC, POD</p> <pre><code>---\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: log-volume\nspec:\n  storageClassName: manual\n  capacity:\n    storage: 1Gi\n  accessModes:\n    - ReadWriteMany\n  hostPath:\n    path: /opt/volume/nginx\n\n---\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: log-claim\nspec:\n  accessModes:\n    - ReadWriteMany\n  volumeMode: Filesystem\n  resources:\n    requests:\n      storage: 200Mi\n  storageClassName: manual\n</code></pre> <p><pre><code>kubectl run logger --image=nginx:alpine --dry-run=client -oyaml &gt; logger.yaml\n</code></pre> <pre><code>volumes:\n  - name: log\n    persistentVolumeClaim:\n      claimName: log-claim\ncontainers:\n  - image: nginx:alpine\n    name: logger\n    volumeMounts:\n      - name: log\n        mountPath: /var/www/nginx\n</code></pre></p>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-2","title":"Task 2","text":"<p>Troubleshoot \u043f\u043e\u0447\u0435\u043c\u0443 \u043e\u0434\u0438\u043d \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043d\u0435 \u0432\u0438\u0434\u0438\u0442 \u0434\u0440\u0443\u0433\u043e\u0439</p> <p><pre><code>kubectl get svc\n\nkubectl get pods\n\nkubectl exec -it webapp-color -- sh\n\nnc -v -z -w 2 secure-service 80\n\nOperation timed out\n</code></pre> \u041a\u043e\u043c\u0430\u043d\u0434\u0430 nc -v -z -w 2 secure-service 80 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0443\u0442\u0438\u043b\u0438\u0442\u0443 netcat (\u0438\u043b\u0438 nc) \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u043f\u043e\u0440\u0442\u0430 80 \u043d\u0430 \u0445\u043e\u0441\u0442\u0435 secure-service. \u0412\u043e\u0442 \u0447\u0442\u043e \u043e\u0437\u043d\u0430\u0447\u0430\u044e\u0442 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b: - v (verbose) \u2014 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0439 \u0432\u044b\u0432\u043e\u0434. - z \u2014 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u0440\u0442\u0430 \u0431\u0435\u0437 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445, \u043f\u0440\u043e\u0441\u0442\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0440\u0442\u0430. - w 2 \u2014 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u0442\u0430\u0439\u043c\u0430\u0443\u0442 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0432 2 \u0441\u0435\u043a\u0443\u043d\u0434\u044b. \u042d\u0442\u043e \u0437\u043d\u0430\u0447\u0438\u0442, \u0447\u0442\u043e netcat \u0431\u0443\u0434\u0435\u0442 \u0436\u0434\u0430\u0442\u044c \u043e\u0442\u0432\u0435\u0442\u0430 \u043e\u0442 secure-service \u043d\u0430 \u043f\u043e\u0440\u0442 80 \u0432 \u0442\u0435\u0447\u0435\u043d\u0438\u0435 2 \u0441\u0435\u043a\u0443\u043d\u0434.</p> <p><pre><code>kubectl get netpol\n\nkubectl describe netpol\n\nkubectl get pod --show-labels\n\nkubectl get netpol default-deny -oyaml &gt; netpol.yaml\n</code></pre> <pre><code>spec:\npodSelector:\n  matchLabels:\n    run: secure-pod\npolicyTypes:\n- Ingress\ningress:\n  - from:\n    - podSelector:\n        matchLabels:\n          name: webapp-color\n    ports:\n    - protocol: TCP\n      port: 80\n</code></pre></p>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-3","title":"Task 3","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c Pod, ConfigMap, Volume</p> <pre><code>kubectl create ns dvl1987\nkubectl create cm time-config -n dvl1987 --from-literal=TIME_FREQ=10\nkubectl get cm -n dvl1987\nkubectl run time-check --image=busybox --dry-run=client -oyaml &gt; time-check.yaml\n</code></pre> <pre><code>volumeMounts:\n  - name: log-volume\n    mountPath: /opt/time\nenv:\n  - name: TIME_FREQ\n    valueFrom:\n      configMapKeyRef:\n        name: time-config\n        key: TIME_FREQ\n\nvolumes:\n  - name: log-volume\n    emptyDir: {}\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-4","title":"Task 4","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c Deployment</p> <pre><code>kubectl create deploy nginx-deploy --image=nginx:1.16 --replicas=4 --dry-run=client -oyaml &gt; deploy.yaml\n</code></pre> <pre><code>strategy:\n  rollingUpdate:\n    maxSurge: 1\n    maxUnavailable: 2\n</code></pre> <pre><code>kubectl set image deployment nginx-deploy nginx=nginx:1.17\n\nkubectl get pod\n\nkubectl rollout undo deployment nginx-deploy\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-5","title":"Task 5","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c Deployment \u0441 configmap \u0438 \u043b\u0438\u043c\u0438\u0442\u0430\u043c\u0438</p> <pre><code>volumes:\n  - name: redis-config\n    configMap:\n      name: redis-config\n\ncontainers:\n- image: redis:alpine\n  name: redis\n    resources:\n      requests:\n        cpu: \"0.2\"\n  volumeMounts:\n    - name: redis-config\n      mountPath: /redis-master\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#lightning-lab-2","title":"Lightning Lab 2","text":""},{"location":"05%20Kubernetes/5.8_CKAD/#task-1_1","title":"Task 1","text":"<p>Troubleshooting pods \u0432 \u0441\u0442\u0430\u0442\u0443\u0441 != Ready, \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c liveness probe</p> <p><pre><code>kubectl describe pod nginx1401 -n dev\n</code></pre> \u041e\u0448\u0438\u0431\u043a\u0430 Readless probe, \u043d\u0430\u0434\u043e \u043f\u043e\u043c\u0435\u043d\u044f\u0442\u044c \u043f\u043e\u0440\u0442</p> <pre><code>livenessProbe:\n  exec:\n    command:\n    - ls\n    - /var/www/html/file_check\n  initialDelaySeconds: 10\n  periodSeconds: 60\n</code></pre> <pre><code>kubectl replace -f nginx.yaml --force\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-2_1","title":"Task 2","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c cronejob</p> <pre><code>completions: 1\nbackoffLimit: 25\nactiveDeadlineSeconds: 20\n\nrestartPolicy: Never\n</code></pre> <ul> <li>completions: \u042d\u0442\u043e\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0445 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0439 \u0437\u0430\u0434\u0430\u0447\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b.</li> <li>backoffLimit: \u042d\u0442\u043e\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442, \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0440\u0430\u0437 Kubernetes \u043f\u043e\u043f\u044b\u0442\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443.</li> <li>activeDeadlineSeconds: \u042d\u0442\u043e\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0437\u0430\u0434\u0430\u0435\u0442 \u0432\u0440\u0435\u043c\u044f \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f \u0434\u043b\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445. \u0415\u0441\u043b\u0438 \u0437\u0430\u0434\u0430\u0447\u0430 \u043d\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0441\u044f \u0432 \u0442\u0435\u0447\u0435\u043d\u0438\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438, \u043e\u043d\u0430 \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0435\u0440\u0432\u0430\u043d\u0430 \u0438 \u0441\u0447\u0438\u0442\u0430\u0442\u044c\u0441\u044f \u043d\u0435\u0443\u0434\u0430\u0447\u043d\u043e\u0439.</li> </ul>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-3_1","title":"Task 3","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0435\u043a\u0440\u0435\u0442\u044b</p> <pre><code>volumes:\n - name: secret-volume\n   secret:\n     secretName: dotfile-secret\n\n\ncontainers:\n  volumeMounts:\n    - name: secret-volume\n      readOnly: true\n      mountPath: /etc/secret-name\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-4_1","title":"Task 4","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c ingress</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: ingress-vh-routing\n  annotations:\n    nginx.ingress.kubernetes.io/rewrite-target: /\nspec:\n  ingressClassName: nginx-example\n  rules:\n   - host: watch-store.com:30093\n     http:\n      paths:\n      - path: /video\n        pathType: Prefix\n        backend:\n          service:\n            name: video-service\n            port:\n              number: 8080\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-5_1","title":"Task 5","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0442\u044c pod \u0438 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043b\u043e\u0433\u0438</p> <p><pre><code>kubectl logs dev-pod-dind -c log-x\n\nkubectl logs dev-pod-dind -c log-x | grep WARNING &gt; /opt/dind_logs.txt\n</code></pre> \u0412 \u0434\u0430\u043d\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, -c log-x \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043d\u0430 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 log-x \u0432 \u043f\u043e\u0434\u0435 dev-pod-dind, \u0438\u0437 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u043d\u0443\u0436\u043d\u043e \u0438\u0437\u0432\u043b\u0435\u0447\u044c \u043b\u043e\u0433\u0438.</p>"},{"location":"05%20Kubernetes/5.8_CKAD/#mock-exam-1","title":"Mock Exam 1","text":""},{"location":"05%20Kubernetes/5.8_CKAD/#task-1_2","title":"Task 1","text":"<pre><code>kubectl run nignx-44889 --image=nginx:alpine\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-2_2","title":"Task 2","text":"<pre><code>kubectl create ns apx-z9938\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-3_2","title":"Task 3","text":"<pre><code>kubectl create deployment httpd-front --image=httpd:2.4-apline --replicas=3\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-4_2","title":"Task 4","text":"<pre><code>kubectl run messagins --image=redis:apline -l tier=msg\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-5_2","title":"Task 5","text":"<pre><code>kubectl get rs\n\nkubectl describe rs rs-d3393\n\nkubectl edit rs rs-d3393\n\nkubectl delete -l name=busybox-pod\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-6","title":"Task 6","text":"<p>\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u0430 <pre><code>kubectl expose deploy redis --port=6379 --name messaging-service\n</code></pre></p>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-7","title":"Task 7","text":"<pre><code>kubectl get pod webapp-color -oyaml &gt; pod.yaml\n\nchange env\n\nkubectl replace -f pod.yaml\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-8","title":"Task 8","text":"<pre><code>kubectl create configmap cm-3928 --from-literal=DB_NAME=SQL3322 --from-literal=DB_HOST=sql322.com\nkubectl describe cm cm-3928\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-9","title":"Task 9","text":"<pre><code>kubectl create secret generic db-secret --from-literal=DB_HOST=sql01 --from-literal=DB_USER=root\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-10","title":"Task 10","text":"<pre><code>kubectl get pod\n\nkubectl get pod app-sec -o yaml &gt; app-sec.yaml\n</code></pre> <pre><code>containers:\n  securityContext:\n    capabilities:\n      add: [\"SYS_TIME\"]\n\nsecurityContext:\n  runAsUser: 0\n</code></pre> <pre><code>kubectl replace -f app-sec.yaml --froce\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-11","title":"Task 11","text":"<pre><code>kubectl get ns\n\nkubectl get pod e-com -n e-commerce\n\nkubectl logs e-com --namespace=e-commerce &gt; /opt/log.txt\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-12","title":"Task 12","text":"<pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: pv-analytics\nspec:\n  volumeMode: Filesystem\n  persistentVolumeReclaimPolicy: Retain\n  accessModes:\n    - ReadWriteMany\n  capacity:\n    storage: 100Mi\n  hostPath:\n    path: /pv/data-analitycs\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-13","title":"Task 13","text":"<pre><code>kubectl create deployment redis --image=redis --replicas=1\n\nkubectl expose deployment redis --name=redis --port=6379 --target-port=6379\n</code></pre> <pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: redis-access\n  namespace: default\nspec:\n  podSelector:\n    matchLabels:\n      app: redis\n  policyTypes:\n  - Ingress\n  ingress:\n  - from:\n    - podSelector:\n        matchLabels:\n          access: redis\n    ports:\n    - protocol: TCP\n      port: 6379\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-14","title":"Task 14","text":"<pre><code>---\napiVersion: v1\nkind: Pod\nmetadata:\n  name: sega\nspec:\n  containers:\n  - name: tails\n    image: busybox\n    command:\n    - sleep\n    - \"3600\"\n  - name: sonic\n    image: nginx\n    env:\n      - name: NGINX_PORT\n        value: \"8080\"\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#mock-exam-2","title":"Mock Exam 2","text":""},{"location":"05%20Kubernetes/5.8_CKAD/#task-1_3","title":"Task 1","text":"<pre><code>kubectl create deployment my-webapp --image=nginx --replicas=2 --dry-run=client -oyaml &gt; webapp.yaml\n\nkubectl expose deploymeny my-webapp --name front-end-service --type NodePort --port 80\n</code></pre> <pre><code>NodePort: 30083\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-2_3","title":"Task 2","text":"<pre><code>kubectl get node\n\nkubectl tain node node01 app_type=alpha:NoSchedule\n\nkubectl run redis --image=redis\n</code></pre> <pre><code>tolerations:\n  - effect: NoSchedule\n    key: app_type\n    value: alpha\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-3_3","title":"Task 3","text":"<pre><code>kubectl label node controlplane app_type=beta\n\nkubectl get node controlplane --show-labels\n\nkubectl create deploy beta-apps --image=nginx --replicas=3 --dry-run=clien\n</code></pre> <pre><code>spec:\n  affinity:\n    nodeAffinity:\n      requiredDuringSchedulingIgnoredDuringExecution:\n        nodeSelectorTerms:\n        - matchExpressions:\n          - key: app_type\n            operator: In\n            values: [\"beta\"]\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-4_3","title":"Task 4","text":"<pre><code>kubect get svc\n\nkubectl create ingress ingress --rule=\"ckad-mock.com/video*=my-video-service:8080\" --dry-run=client\n</code></pre> <pre><code>spec:\n  rules:\n    - host: ckad-mock.com\n      http:\n        paths:\n        - backend:\n            service:\n              name: my-video-service\n              port:\n                number: 8080\n          path: /video\n          pathType: Prefix\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-5_3","title":"Task 5","text":"<pre><code>kubectl get pod pod-with-rprobe -oyaml\n</code></pre> <pre><code>readinessProbe:\n  httpGet:\n    path: /ready\n    port: 8080\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-6_1","title":"Task 6","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx1401\n  namespace: default\nspec:\n  containers:\n    - name: nginx1401\n      image: nginx\n      livenessProbe:\n        exec:\n          command: [\"ls /var/www/html/probe\"]\n        initialDelaySeconds: 10\n        periodSeconds: 60\n</code></pre> <ul> <li>initialDelaySeconds: \u042d\u0442\u043e\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0435\u043a\u0443\u043d\u0434, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 Kubernetes \u0434\u043e\u043b\u0436\u0435\u043d \u043f\u043e\u0434\u043e\u0436\u0434\u0430\u0442\u044c \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u0430, \u043f\u0440\u0435\u0436\u0434\u0435 \u0447\u0435\u043c \u043d\u0430\u0447\u0430\u0442\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0431.</li> <li>periodSeconds: \u042d\u0442\u043e\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442, \u043a\u0430\u043a \u0447\u0430\u0441\u0442\u043e (\u0432 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u0445) Kubernetes \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u043f\u0440\u043e\u0431\u044b.</li> </ul>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-7_1","title":"Task 7","text":"<pre><code>kubectl create job --image=docker/whalesay whalesay --dry-run\n</code></pre> <pre><code>completions: 10\nbackoffLimit: 6\n\nspec:\n  containers:\n    - image: docker/whalesay\n      command:\n        - sh\n        - -c\n        - \"cowsay I am going to ace CKAD!\"\n  restartPolicy: Never\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-8_1","title":"Task 8","text":"<pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: multi-pod\nspec:\n  containers:\n    - name: jupiter\n      image: nginx\n      env:\n        - name: type\n          value: planet\n    - name: europa\n      image: busybox\n      command: [\"/bin/sh\", \"-c\", \"sleep 4800\"]\n      env:\n        - name: type\n          value: moon\n</code></pre>"},{"location":"05%20Kubernetes/5.8_CKAD/#task-9_1","title":"Task 9","text":"<pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: custom-volume\nspec:\n  capacity:\n    storage: 50Mi\n  accessModes:\n    - ReadWriteMany\n  persistentVolumeReclaimPolicy: Retain\n  hostPath:\n    path: /opt/data\n</code></pre>"},{"location":"06%20ServiceMesh/6.1_ServiceMesh/","title":"6.1 \u041c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441\u043d\u0430\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430","text":""},{"location":"06%20ServiceMesh/6.1_ServiceMesh/#_1","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u043c\u0438\u043a\u0440\u043e\u0441\u0435\u0440\u0432\u0438\u0441\u043d\u043e\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b","text":"<ul> <li>\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u043d\u0430\u0434\u0435\u0436\u043d\u043e\u0439 \u0438 \u043e\u0442\u043a\u0430\u0437\u043e\u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u044b \u0432\u0441\u0435\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0438\u0437-\u0437\u0430 \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430 \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f</li> <li>\u0414\u043e\u043b\u0433\u0438\u0439 \u043f\u043e\u0438\u0441\u043a \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0439 \u043f\u0440\u0438\u0447\u0438\u043d\u044b \u0434\u0435\u0433\u0440\u0430\u0434\u0430\u0446\u0438\u0438</li> <li>\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0433\u043e \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\u0438</li> <li>\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0435 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u043e\u0432 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043d\u0430 \u0447\u0430\u0441\u0442\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439</li> </ul>"},{"location":"06%20ServiceMesh/6.1_ServiceMesh/#service-mesh","title":"Service mesh","text":"<ul> <li>\u0414\u0430\u0451\u0442 \u0431\u043e\u043b\u044c\u0448\u0443\u044e \u043d\u0430\u0434\u0435\u0436\u043d\u043e\u0441\u0442\u044c \u043d\u043e \u0443\u0441\u043b\u043e\u0436\u043d\u044f\u0435\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0443</li> <li>\u041f\u043e\u0442\u0440\u0435\u0431\u043b\u044f\u0435\u0442 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b</li> <li>\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u044c \u043d\u0430\u043b\u0438\u0447\u0438\u044f \u044d\u043a\u0441\u043f\u0435\u0440\u0442\u0438\u0437\u044b \u0434\u043b\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0439 \u044d\u043a\u0441\u043f\u043b\u0443\u0430\u0442\u0430\u0446\u0438\u0438 (\u043d\u0430 \u0443\u0440\u043e\u0432\u0435\u043d\u044c -1)</li> </ul>"},{"location":"06%20ServiceMesh/6.2_Istio/","title":"6.2 Istio","text":""},{"location":"06%20ServiceMesh/6.2_Istio/#envoy-proxy","title":"Envoy proxy","text":"<ul> <li>\u0421\u0430\u043c\u044b\u0439 \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0439 proxy \u0434\u043b\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 service mesh </li> <li>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0432 runtime \u0447\u0435\u0440\u0435\u0437 API</li> <li>\u041c\u043e\u0449\u043d\u044b\u0439 \u043d\u0430\u0431\u043e\u0440 observability \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0439: tracing, prom/statsd \u043c\u0435\u0442\u0440\u0438\u043a\u0438</li> <li>\u0413\u0438\u0431\u043a\u0430\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f: circuit breakers, retries, rate limiting, mTLS</li> <li>L4 \u0438 L7 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430, \u0432\u043a\u043b\u044e\u0447\u0430\u044f http/2, gRPC</li> </ul>"},{"location":"06%20ServiceMesh/6.2_Istio/#envoy","title":"Envoy \u0442\u0435\u0440\u043c\u0438\u043d\u043e\u043b\u043e\u0433\u0438\u044f","text":"<p>Listener - \u0447\u0442\u043e \u0441\u043b\u0443\u0448\u0430\u0435\u0442 envoy</p> <p>Route - \u043c\u0435\u0445\u0430\u043d\u0438\u043a\u0430 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 (location \u0432 nginx)</p> <p>Cluster - \u0442\u043e \u043a\u0443\u0434\u0430 \u043c\u044b \u0431\u0443\u0434\u0435\u043c \u0441\u043a\u0438\u0434\u044b\u0432\u0430\u0442\u044c \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0443 (upstream \u0432 nginx)</p> <p>Cluster load assignment - \u0441\u0430\u043c\u0438 \u0430\u0434\u0440\u0435\u0441\u0430</p> <p>\u041d\u0430 \u0432\u0445\u043e\u0434 \u043c\u044b \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u0432 listener \u043f\u043e route \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c \u043a\u0443\u0434\u0430 \u0438\u0434\u0442\u0438 \u0434\u0430\u043b\u044c\u0448\u0435 \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u043c \u0432 cluster \u0438 load assignment</p>"},{"location":"06%20ServiceMesh/6.2_Istio/#_1","title":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440","text":"<pre><code>curl -L https://istio.io/downloadIstio | ISTIO_VERSION=1.21.2 TARGET_ARCH=x86_64 sh -\ncd istio-1.21.2\nexport PATH=$PWD/bin:$PATH\nistioctl x precheck\nistioctl install --set profile=default --set \"values.global.proxy.resources.requests.cpu=10m\" --set \"values.global.proxy.resources.requests.memory=100Mi\" -y\n</code></pre>"},{"location":"07%20Observability/7.1_Monitoring/","title":"7.1 \u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433","text":"<p>C\u043e\u0432\u043e\u043a\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0438 \u043f\u0440\u0430\u043a\u0442\u0438\u043a, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0449\u0430\u044f \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u0442\u044c \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043d\u0430\u0434 \u0440\u0430\u0431\u043e\u0442\u043e\u0439 IT \u0441\u0438\u0441\u0442\u0435\u043c \u0438 \u0434\u0430\u0432\u0430\u0442\u044c \u043e\u0446\u0435\u043d\u043a\u0443 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u044d\u0442\u0438\u0445 \u0441\u0438\u0441\u0442\u0435\u043c.</p> <p>\u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u0445\u043e\u0441\u0442\u0430</p> <ul> <li>CPU</li> <li>Memory</li> <li>Processes</li> <li>Disk</li> <li>Network</li> <li>\u0438 \u0442.\u0434.</li> </ul> <p>\u041c\u0435\u0442\u0440\u0438\u043a\u0438 Docker-\u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432</p> <ul> <li>CPU</li> <li>Memory</li> <li>Network</li> <li>Block I/O</li> <li>Docker Daemon</li> </ul> <p>\u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432</p> <ul> <li>\u0411\u0414, \u043e\u0447\u0435\u0440\u0435\u0434\u0438</li> <li>Load balancer</li> <li>\u0421\u0435\u0440\u0432\u0435\u0440 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f</li> <li>\u0421\u0442\u043e\u0440\u043e\u043d\u043d\u0438\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u044b</li> <li>\u0412\u0441\u0435, \u043e\u0442 \u0447\u0435\u0433\u043e \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u0441\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u044b \u0432\u0430\u0448\u0435\u0433\u043e \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430</li> </ul>"},{"location":"07%20Observability/7.2_Logging/","title":"7.2 \u041b\u043e\u0433\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435","text":"<p>\u041f\u043e \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0443 \u043c\u044b \u0432\u0438\u0434\u0438\u043c \u0447\u0442\u043e \u0441 \u0441\u0438\u0441\u0442\u0435\u043c\u043e\u0439 \u0447\u0442\u043e-\u0442\u043e \u043d\u0435 \u0442\u0430\u043a \u0438 \u043b\u043e\u0433\u0438 \u0434\u0430\u044e\u0442 \u043d\u0430\u043c \u0443\u0436\u0435 \u0431\u043e\u043b\u0435\u0435 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e</p> <ul> <li>\u0412\u0438\u0434\u0438\u043c\u043e\u0441\u0442\u044c \u0438 \u043f\u043e\u043d\u0438\u043c\u0430\u043d\u0438\u0435 \u0442\u043e\u0433\u043e, \u043a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0442 \u043d\u0430\u0448\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u044b</li> <li>\u041f\u043e\u0438\u0441\u043a \u043e\u0448\u0438\u0431\u043e\u043a \u0438 \u0438\u0445 \u043f\u0440\u0438\u0447\u0438\u043d</li> <li>\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043d\u043e\u0435 \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043c\u0435\u0442\u0440\u0438\u043a \u0441\u0438\u0441\u0442\u0435\u043c \u0438\u043b\u0438 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432</li> </ul>"},{"location":"07%20Observability/7.2_Logging/#elk-kafka","title":"ELK + kafka","text":"<ul> <li>Filebeat - \u0421\u0431\u043e\u0440\u0449\u0438\u043a</li> <li>Kafka - \u0411\u0443\u0444\u0435\u0440 (\u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u0437\u0430\u0445\u043b\u0435\u0431\u043d\u0443\u043b\u0441\u044f logstash)</li> <li>Logstash - \u0410\u0433\u0440\u0435\u0433\u0430\u0446\u0438\u044f \u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430</li> <li>Elasticsearch - \u0418\u043d\u0434\u0435\u043a\u0441\u0430\u0446\u0438\u044f \u0438 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435</li> <li>Kibana - \u0410\u043d\u0430\u043b\u0438\u0437 \u0438 \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f</li> </ul>"},{"location":"07%20Observability/7.3_Tracing/","title":"7.3 \u0422\u0440\u0435\u0439\u0441\u0438\u043d\u0433","text":"<ul> <li>Metrics - \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u0438 \u043f\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u044f\u043c, \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u044e\u0449\u0438\u0435 \u0442\u0440\u0435\u043d\u0434\u044b</li> <li>Logging - \u0436\u0443\u0440\u043d\u0430\u043b \u0441\u043e\u0431\u044b\u0442\u0438\u0439 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432</li> <li>Distributed tracing - \u0436\u0443\u0440\u043d\u0430\u043b \u0441\u043e\u0431\u044b\u0442\u0438\u0439 \u0441 \u043f\u0440\u0438\u0447\u0438\u043d\u043e-\u0441\u043b\u0435\u0434\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0439 \u0441\u0432\u044f\u0437\u044c\u044e</li> </ul> <p>Tracing</p> <ul> <li>\u041e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u043e\u0434\u043d\u043e\u0433\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u044f (\u0432 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435)</li> <li>\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0433\u0440\u0430\u0444\u044b \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 (traces) \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438</li> <li>\u0410\u043d\u0430\u043b\u0438\u0437 \u0433\u0440\u0430\u0444\u043e\u0432 \u043f\u043e\u043c\u043e\u0433\u0430\u0435\u0442 \u043d\u0430\u0439\u0442\u0438 \u043f\u0440\u0438\u0447\u0438\u043d\u044b \u0434\u043e\u043b\u0433\u0438\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432</li> </ul> <p>Zipkin</p>"},{"location":"10%20Security/10.1_TLS/","title":"10.1 TLS and mTLS","text":""},{"location":"10%20Security/10.1_TLS/#tls-","title":"\u0421\u043e\u0437\u0434\u0430\u0435\u043c TLS-\u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u044b","text":"<pre><code>openssl req -new -x509 -days 365 -nodes -out nginx_cert.crt -keyout nginx_cert.key -subj \"/CN=localhost\"\n</code></pre> <ul> <li>new: \u0412 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0435 \u044d\u0442\u043e\u0439 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u043e\u043d \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u0441\u0430\u043c\u043e\u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430.</li> <li>x509: \u042d\u0442\u043e\u0442 \u0444\u043b\u0430\u0433 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 OpenSSL \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u0430\u043c\u043e\u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0439 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 X.509 \u0432\u043c\u0435\u0441\u0442\u043e CSR.</li> <li>days 1461: \u042d\u0442\u043e\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0441\u0440\u043e\u043a \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0432 \u0434\u043d\u044f\u0445.</li> <li>nodes: \u042d\u0442\u043e\u0442 \u0444\u043b\u0430\u0433 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 OpenSSL \u043d\u0435 \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0439 \u043a\u043b\u044e\u0447.</li> <li>subj \"/CN=pk.nginx\": \u041e\u0431\u044a\u0435\u043a\u0442, \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u0432\u044b\u0434\u0430\u043d \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442. \u042d\u0442\u043e \u043c\u043e\u0436\u0435\u0442 \u0432\u043a\u043b\u044e\u0447\u0430\u0442\u044c \u0432 \u0441\u0435\u0431\u044f \u0438\u043c\u044f \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438, \u0434\u043e\u043c\u0435\u043d\u043d\u043e\u0435 \u0438\u043c\u044f (Common Name) \u0438\u043b\u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u044e\u0442 \u043d\u0430 \u0442\u043e, \u043a\u043e\u043c\u0443 \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442. \u0412 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0435 SSL/TLS, Subject \u043e\u0431\u044b\u0447\u043d\u043e \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0441\u044f \u043a \u0438\u043c\u0435\u043d\u0438 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438 \u0438\u043b\u0438 \u0434\u043e\u043c\u0435\u043d\u0443, \u0437\u0430\u0449\u0438\u0449\u0430\u0435\u043c\u043e\u043c\u0443 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u043c</li> </ul> <p>\u0422\u0435\u043f\u0435\u0440\u044c \u043c\u043e\u0436\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u044b \u0432 \u043a\u043e\u043d\u0444\u0438\u0433 nginx.conf <pre><code>events { worker_connections 1024; }\n\nhttp {\n    server {\n        listen 443 ssl;\n\n        ssl_certificate     nginx_cert.crt;\n        ssl_certificate_key nginx_cert.key;\n\n        location / {\n            return 200 'Hello, world!';\n        }\n    }\n}\n</code></pre></p> <p>\u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c nginx <pre><code>docker run -d -p 443:443 --name nginx -v $(pwd)/nginx/:/etc/nginx/ nginx:latest\n</code></pre></p> <pre><code>curl --cacert nginx/nginx_cert.crt https://localhost:443\n\nHello, world!\n</code></pre>"},{"location":"10%20Security/10.1_TLS/#_1","title":"\u0421\u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u043c \u043a\u043b\u044e\u0447 \u0434\u043b\u044f \u0446\u0435\u043d\u0442\u0440\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438","text":"<pre><code>openssl req -newkey rsa:2048 -x509 -nodes -keyout ca.key -days 3650 -subj \"/CN=ca.pk.nginx\" -out ca.crt\n</code></pre> <p>\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u0432 \u043a\u043e\u043d\u0444\u0438\u0433 <pre><code>server {\n    ...\n    ssl_client_certificate /etc/ssl/client/ca.crt;\n    ssl_verify_client on;\n    ...\n}\n</code></pre></p> <pre><code>docker run -d -p 443:443 --name nginx -v $(pwd)/nginx/:/etc/nginx/ -v $(pwd)/cacert/:/etc/ssl/client/ nginx:latest\n</code></pre> <p>\u0421\u043e\u0437\u0434\u0430\u0434\u0438\u043c \u0444\u0430\u0439\u043b \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430</p> <p>\u0424\u0430\u0439\u043b CSR (Certificate Signing Request) \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0439 \u043a\u043b\u044e\u0447 \u043a\u043b\u0438\u0435\u043d\u0442\u0430 \u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043a\u043b\u0438\u0435\u043d\u0442 \u0445\u043e\u0447\u0435\u0442 \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0432 \u0441\u0432\u043e\u0439 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0438\u043c\u044f \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438, \u0441\u0442\u0440\u0430\u043d\u0430, \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0438 \u0442.\u0434.). CSR \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0432 \u0426\u0421 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430.</p> <pre><code>openssl req -newkey rsa:2048 -keyout client1.key -out client1.csr -nodes -days 365 -subj \"/CN=client1\"\n</code></pre> <p>\u0412\u044b\u0434\u0430\u0435\u043c \u0438 \u0437\u0430\u0432\u0435\u0440\u044f\u0435\u043c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u043a\u043b\u044e\u0447\u043e\u043c \u0446\u0435\u043d\u0442\u0440\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438</p> <pre><code>openssl x509 -req -in client1.csr -out client1.crt -CA ca.crt -CAkey ca.key -CAcreateserial -days 365\n\nCertificate request self-signature ok\nsubject=CN = client1\n</code></pre> <p>\u0422\u0435\u043f\u0435\u0440\u044c \u043c\u043e\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441 \u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u043c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u043c</p> <pre><code>curl -k --key client1.key --cert client1.crt https://127.0.0.1:443\n\nHello, world!\n</code></pre>"},{"location":"10%20Security/10.1_TLS/#_2","title":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430","text":"<pre><code>openssl x509 -in client1.crt -text -noout \n\nopenssl x509 -in client1.crt -subject -issuer -noout\n</code></pre>"},{"location":"10%20Security/10.1_TLS/#ca","title":"\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0447\u0442\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d CA","text":"<pre><code>openssl verify -CAfile cacert/ca.crt client1.crt\n\nclient1.crt: OK\n</code></pre>"},{"location":"10%20Security/10.1_TLS/#_3","title":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0432\u0441\u0435\u0445 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430\u0445 \u0432 \u0446\u0435\u043f\u043e\u0447\u043a\u0435","text":"<pre><code>openssl crl2pkcs7 -nocrl -certfile all_certs.crt | openssl pkcs7 -print_certs -text -noout | grep -E \"(Certificate:)|(Issuer:)|(Subject:)\"\n</code></pre>"},{"location":"20%20React/20.1_React/","title":"20.1 React","text":""},{"location":"20%20React/20.1_React/#_1","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u0430","text":"<pre><code>npm create vite@latest\n\nnpm i\n\nnpm run dev\n</code></pre>"},{"location":"20%20React/20.1_React/#_2","title":"\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":"<ul> <li>React \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u0440\u043e\u0449\u0435 \u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u044b \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432</li> <li>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u044d\u0442\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 JSX</li> <li>JSX \u044d\u0442\u043e \u0441\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0441\u0430\u0445\u0430\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 React \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u0442 \u0432 JS</li> <li>\u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u043c\u043e\u0433\u0443\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435</li> </ul> <p>\u041f\u043b\u044e\u0441\u044b \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432</p> <ul> <li>\u041f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u043e\u0441\u0442\u044c</li> <li>\u0420\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u044c</li> <li>\u0423\u0434\u043e\u0431\u043d\u043e\u0435 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435</li> </ul>"},{"location":"20%20React/20.1_React/#props","title":"Props","text":"<ul> <li>Props \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438</li> <li>\u042d\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e \u043f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b</li> </ul> <code>App.jsx</code> <code>JournalItem.jsx</code> <pre><code>import JournalItem from \"./JournalItem\";\n\nfunction App() {\n  const data = [\n    {\n      title: \"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0443\u0440\u0441\u043e\u0432\",\n      date: new Date(),\n      text: \"\u0413\u043e\u0440\u043d\u044b\u0435 \u043f\u043e\u0445\u043e\u0434\u044b \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u044e\u0442 \u0443\u0434\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0440\u043e\u0434\u043d\u044b\u0435 \u043b\u0430\u043d\u0434\u0448\u0430\u0444\u0442\u044b\",\n    },\n    {\n      title: \"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0443\u0440\u0441\u043e\u04322\",\n      date: new Date(),\n      text: \"\u0413\u043e\u0440\u043d\u044b\u0435 \u043f\u043e\u0445\u043e\u0434\u044b 222 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u044e\u0442 \u0443\u0434\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0440\u043e\u0434\u043d\u044b\u0435 \u043b\u0430\u043d\u0434\u0448\u0430\u0444\u0442\u044b\",\n    },\n  ];\n\n  return (\n    &lt;&gt;\n      &lt;JournalItem\n        title={data[0].title}\n        text={data[0].text}\n        date={data[0].date}\n      /&gt;\n    &lt;/&gt;\n  );\n}\n</code></pre> <pre><code>  function JournalItem({ title, text, date }) {\n  const formatedDate = new Intl.DateTimeFormat(\"ru-RU\").format(date);\n\n  return (\n    &lt;div className=\"journal-item\"&gt;\n      &lt;h2 className=\"journal-item__header\"&gt;{title}&lt;/h2&gt;\n      &lt;h2 className=\"journal-item__body\"&gt;\n        &lt;div className=\"journal-item__date\"&gt;{formatedDate}&lt;/div&gt;\n        &lt;div className=\"journal-item__text\"&gt;{text}&lt;/div&gt;\n      &lt;/h2&gt;\n    &lt;/div&gt;\n  );\n}\n\nexport default JournalItem;\n</code></pre>"},{"location":"20%20React/20.1_React/#_3","title":"\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u0439","text":"<pre><code>function Button({ children, onClick }) {\n    console.log('Button');\n    return (\n        &lt;button className='button accent' onClick={onClick}&gt;{children}&lt;/button&gt;\n    );\n}\n</code></pre>"},{"location":"20%20React/20.1_React/#usestate","title":"useState","text":"<ul> <li>\u042d\u0442\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043a\u043e\u0440\u0442\u0435\u0436 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f</li> <li>\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u043d\u0430 \u0441\u0440\u0430\u0437\u0443, \u0430 \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u043a \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044e react'\u043e\u043c</li> <li>\u041f\u0440\u0438 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u043c \u0440\u0435\u043d\u0434\u0438\u0440\u0435\u043d\u0433\u0435 useState \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u0438\u0441\u0432\u0430\u0438\u0432\u0430\u0442\u044c \u0434\u0435\u0444\u043e\u043b\u0442\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435</li> </ul> <pre><code>  const [text, setText] = useState(\"Save\");\n\n  // \u0414\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \"\u0441\u0442\u0430\u0440\u043e\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f\"\n  setText(oldText =&gt; oldText + \"!\");\n</code></pre>"},{"location":"20%20React/20.1_React/#usereducer","title":"useReducer","text":"<ul> <li>useReducer() \u044d\u0442\u043e \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u0430 useState() \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0434\u0430\u0435\u0442 \u0431\u043e\u043b\u044c\u0448\u0438\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043d\u0430\u0434 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435\u043c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0438 \u0443\u043f\u0440\u043e\u0449\u0430\u0435\u0442 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435</li> <li>\u0412\u0441\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u044b \u043c\u043e\u0436\u043d\u043e \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0438 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e useState()</li> </ul> <pre><code>function reducer(state, action) {\n  switch (action.type) {\n    case 'ADD': return { count: state.count + 1 };\n    case 'SUB': return { count: state.count - 1 };\n    default: return state;\n  }\n}\n\nfunction Counter() {\n  const [state, dispatch] = React.useReducer(reducer, { count: 0 });\n  return (\n    &lt;&gt;\n      \u0418\u0442\u043e\u0433\u043e: {state.count}\n      &lt;button onClick={() =&gt; dispatch({type: 'ADD'})}&gt;\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c&lt;/button&gt;\n      &lt;button onClick={() =&gt; dispatch({type: 'SUB'})}&gt;\u0412\u044b\u0447\u0435\u0441\u0442\u044c&lt;/button&gt;\n    &lt;/&gt;\n  );\n}\n</code></pre>"},{"location":"20%20React/20.1_React/#usecontext","title":"useContext","text":"<ul> <li>\u041e\u0431\u044b\u0447\u043d\u043e \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f, \u0435\u0441\u043b\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u0434\u0430\u043d\u043d\u044b\u0445 \u0432\u043e \u043c\u043d\u043e\u0433\u0438\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u0445 \u043d\u0430 \u0440\u0430\u0437\u043d\u044b\u0445 \u0443\u0440\u043e\u0432\u043d\u044f\u0445 \u0432\u043b\u043e\u0436\u0435\u043d\u043d\u043e\u0441\u0442\u0438.</li> <li>\u041f\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0435\u0433\u043e, \u0442\u0430\u043a \u043a\u0430\u043a \u044d\u0442\u043e \u0443\u0441\u043b\u043e\u0436\u043d\u044f\u0435\u0442 \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432.</li> <li>\u0427\u0442\u043e\u0431\u044b \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043c\u044b \u0445\u043e\u0442\u0438\u043c \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c, \u043c\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u043d\u0430\u0447\u0430\u0442\u044c \u0441 \u043f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a\u0430 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 ().</li> <li>\u0417\u0430\u0442\u0435\u043c \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b\u044c \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 (), \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0437\u0430\u0445\u0432\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u044d\u0442\u0438 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0438\u0445 \u0442\u0430\u043c, \u0433\u0434\u0435 \u043e\u043d\u0438 \u0432\u044b\u0437\u044b\u0432\u0430\u044e\u0442\u0441\u044f.</li> </ul> <pre><code>const { userId } = UserContext(UserContext);\n</code></pre>"},{"location":"20%20React/20.1_React/#_4","title":"\u041f\u0440\u043e\u0441\u0442\u0430\u044f \u0434\u0435\u043a\u043e\u043c\u043f\u043e\u0437\u0438\u0446\u0438\u044f \u043d\u0430 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":"<code>App.jsx</code> <pre><code>function App() {\n    return (\n        &lt;div className='app'&gt;\n            &lt;LeftPanel&gt;\n                &lt;Header/&gt;\n                &lt;JournalAddButton/&gt;\n                &lt;JournalList/&gt;\n            &lt;/LeftPanel&gt;\n            &lt;Body&gt;\n                &lt;JournalForm/&gt;\n            &lt;/Body&gt;\n        &lt;/div&gt;\n    );\n}\n</code></pre>"},{"location":"20%20React/20.1_React/#_5","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0444\u043e\u0440\u043c\u0430\u043c\u0438","text":"<code>JournalForm.jsx</code> <pre><code>function JournalForm() {\n\n    const addJournalItem = (e) =&gt; {\n        e.preventDefault();\n        const formData = new FormData(e.target);\n        const formProps = Object.fromEntries(formData);\n        // \u041c\u0435\u0442\u043e\u0434 Object.fromEntries() static \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u0442 \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u0430\u0440 \u043a\u043b\u044e\u0447-\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0432 \u043e\u0431\u044a\u0435\u043a\u0442.\n        console.log('submit');\n    };\n\n    return (\n        &lt;form className={styles['journal-form']} onSubmit={addJournalItem}&gt;\n            &lt;input type=\"text\" placeholder=\"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a\" onChange={inputChange}/&gt;\n            &lt;textarea&gt;&lt;/textarea&gt;\n            &lt;Button&gt;\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c&lt;/Button&gt;\n        &lt;/form&gt;\n    );\n}\n</code></pre>"},{"location":"20%20React/20.1_React/#_6","title":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441\u043e \u0441\u043f\u0438\u0441\u043a\u043e\u043c \u0434\u0430\u043d\u043d\u044b\u0445","text":"<code>App.jsx</code> <pre><code>function App() {\n    const data = [\n        {   \n            id : 1,\n            title: \"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0443\u0440\u0441\u043e\u0432\",\n            date: new Date(),\n            text: \"\u0413\u043e\u0440\u043d\u044b\u0435 \u043f\u043e\u0445\u043e\u0434\u044b \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u044e\u0442 \u0443\u0434\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0440\u043e\u0434\u043d\u044b\u0435 \u043b\u0430\u043d\u0434\u0448\u0430\u0444\u0442\u044b\",\n        },\n        {\n            id : 2,\n            title: \"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0443\u0440\u0441\u043e\u04322\",\n            date: new Date(),\n            text: \"\u0413\u043e\u0440\u043d\u044b\u0435 \u043f\u043e\u0445\u043e\u0434\u044b 222 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u044e\u0442 \u0443\u0434\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0440\u043e\u0434\u043d\u044b\u0435 \u043b\u0430\u043d\u0434\u0448\u0430\u0444\u0442\u044b\",\n        },\n        ];\n        return (\n        &lt;&gt;\n            {data.sort(sortItems).map(el =&gt; (\n                &lt;JournalItem key={el.id}\n                    title={el.title}\n                    text={el.text}\n                    date={el.date}\n                /&gt;\n            ))}\n        &lt;/&gt;\n    );\n}\n</code></pre> <p>Note</p> <p>key \u044d\u0442\u043e \u0432\u0430\u0436\u043d\u044b\u0439 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0434\u043b\u044f \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u0441\u043f\u0438\u0441\u043a\u0430 \u041a\u043b\u044e\u0447\u0438 \u043f\u043e\u043c\u043e\u0433\u0430\u044e\u0442 React \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0442\u044c, \u043a\u0430\u043a\u0438\u0435 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u0431\u044b\u043b\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u044b, \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u044b \u0438\u043b\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u044b.</p>"},{"location":"20%20React/20.1_React/#jsx","title":"\u0423\u0441\u043b\u043e\u0432\u043d\u044b\u0439 \u0440\u0435\u043d\u0434\u0435\u0440 \u0432 JSX","text":"<pre><code>condition &amp;&amp; &lt;JSX /&gt; \u0440\u0435\u043d\u0434\u0435\u0440\u0438\u0442 &lt;JSX /&gt; \u0435\u0441\u043b\u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u0435 condition \u0432\u0435\u0440\u043d\u0435\u0442 true\ncondition ? &lt;JsxTrue /&gt; : &lt;JsxFalse /&gt; \u0440\u0435\u043d\u0434\u0435\u0440\u0438\u0442 &lt;JsxTrue /&gt; \u0438\u043b\u0438 &lt;JsxFalse&gt; \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0442\u043e\u0433\u043e, \u0447\u0442\u043e \u0432\u0435\u0440\u043d\u0435\u0442 \u0443\u0441\u043b\u043e\u0432\u0438\u0435 condition.\n\n{items.length === 0 &amp;&amp; &lt;p&gt;\u0417\u0430\u043f\u0438\u0441\u0435\u0439 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442&lt;/p&gt;}\n{items.length &gt; 0 &amp;&amp; items.map(el =&gt; ())}\n</code></pre>"},{"location":"20%20React/20.1_React/#css","title":"\u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430 \u0441 CSS \u043c\u043e\u0434\u0443\u043b\u044f\u043c\u0438","text":"<pre><code>import styles from './JournalItem.module.css';\n\n&lt;img className={styles.image}&gt;\n</code></pre> <p>\u0411\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430 classNames \u041e\u0441\u043d\u043e\u0432\u043d\u0438\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u0433\u0434\u0430 \u043d\u0443\u0436\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043b\u0430\u0441\u0441\u044b \u043f\u043e \u0443\u0441\u043b\u043e\u0432\u0438\u044e</p> <pre><code>import classNames from 'classnames';\n\nclassName={classNames(styles['image'], {[styles['image--small']]: ifSmall})}\n</code></pre>"},{"location":"20%20React/20.1_React/#useeffect","title":"useEffect","text":"<ul> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u044d\u0442\u043e\u0442 \u0445\u0443\u043a, \u0432\u044b \u0433\u043e\u0432\u043e\u0440\u0438\u0442\u0435 React \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0447\u0442\u043e-\u0442\u043e \u043f\u043e\u0441\u043b\u0435 \u0440\u0435\u043d\u0434\u0435\u0440\u0430.</li> <li>React \u0437\u0430\u043f\u043e\u043c\u043d\u0438\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u044e (\u0442\u043e \u0435\u0441\u0442\u044c \u00ab\u044d\u0444\u0444\u0435\u043a\u0442\u00bb), \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u0432\u044b \u043f\u0435\u0440\u0435\u0434\u0430\u043b\u0438 \u0438 \u0432\u044b\u0437\u043e\u0432\u0435\u0442 \u0435\u0451 \u043f\u043e\u0441\u043b\u0435 \u0442\u043e\u0433\u043e, \u043a\u0430\u043a \u0432\u043d\u0435\u0441\u0451\u0442 \u0432\u0441\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 DOM.</li> <li>useEffect \u0433\u043e\u0432\u043e\u0440\u0438\u0442 \u0447\u0442\u043e \u043c\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0432\u044b\u0437\u0432\u0430\u0442\u044c \u043a\u0430\u043a\u043e\u0439 \u044d\u0442\u043e \u044d\u0444\u0444\u0435\u043a\u0442 \u043f\u0440\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u043d\u0430\u0448\u0438\u0445 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439.</li> <li>\u0415\u0441\u043b\u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043f\u0443\u0441\u0442\u044b\u0435 \u0437\u043d\u0430\u0447\u0438\u0442 \u043e\u043d \u0431\u043e\u043b\u044c\u0448\u0435 \u043d\u0438\u043a\u043e\u0433\u0434\u0430 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0442\u0440\u0438\u0433\u0433\u0435\u0440\u0438\u0442\u044c\u0441\u044f.</li> </ul> <pre><code>const [items, setItems] = useState([]);\n\nconst data = JSON.parse(localStorage.getItem('data'));\n\nif (data) {\n    setItems(data);\n}\n</code></pre> <p>Warning</p> <p>\u0422\u0430\u043a\u0430\u044f \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f \u0432\u044b\u0437\u043e\u0432\u0435\u0442 \u0431\u0435\u0441\u043a\u043e\u043d\u0435\u0447\u043d\u044b\u0439 \u0440\u0435\u0440\u0435\u043d\u0434\u0438\u043d\u0433 \u0414\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u044d\u0442\u043e \u043d\u0435 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u043b\u043e, \u043d\u0443\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c useEffect</p> <pre><code>useEffect(() =&gt; {\n    console.log('useEffect');\n    }, [items]);\n</code></pre>"},{"location":"20%20React/20.1_React/#footer","title":"\u041f\u0440\u0438\u0436\u0430\u0442\u044b\u0439 footer","text":"<code>main.html</code> <code>main.css</code> <pre><code>&lt;html&gt;\n&lt;body&gt;\n\n&lt;div class=\"wrapper\"&gt;\n\n  &lt;div class=\"content\"&gt;&lt;/div&gt;\n\n  &lt;div class=\"footer\"&gt;&lt;/div&gt;\n\n&lt;/div&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <pre><code>html,\nbody {\n  height: 100%;\n}\n.wrapper {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n.content {\n  flex: 1 0 auto;\n}\n.footer {\n  flex: 0 0 auto;\n}\n</code></pre>"},{"location":"20%20React/20.2_useState/","title":"20.2 useState","text":""},{"location":"20%20React/20.2_useState/#usestate","title":"\u041a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 useState","text":"<p>\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0441\u0442\u0430\u0440\u0442\u0443\u0435\u0442 \u043e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0432 \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0442 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 (\u043f\u043e \u0441\u0443\u0442\u0438 js \u0444\u0443\u043d\u043a\u0446\u0438\u044e)</p> <p>\u0421\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u043e\u0431\u044a\u0435\u043a\u0442 saved \u0441 \u0444\u0443\u043d\u043a\u0446\u0438\u0435\u0439 \u0438 \u0434\u0430\u043d\u043d\u044b\u043c\u0438</p> <p>\u0414\u0430\u043b\u0435\u0435 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f fn</p> <p>\u041f\u0440\u0438 \u0432\u044b\u0437\u043e\u0432\u0435 \u0432\u043d\u0443\u0442\u0440\u0438 \u043d\u0435\u0451 \u0432\u0441\u0451 \u0435\u0449\u0451 \u0431\u0443\u0434\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a componentFn \u0438 saved, \u043f\u043e\u0441\u043a\u043e\u043b\u044c\u043a\u0443 \u043e\u043d\u0438 \u0431\u044b\u043b\u0438 \u0432 \u043e\u0431\u043b\u0430\u0441\u0442\u0438 \u0432\u0438\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 fn.</p> <p>connect.now: \u0445\u0440\u0430\u043d\u0438\u0442 \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430, \u0447\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u043d\u0438\u044f \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u043c\u0435\u0436\u0434\u0443 \u0432\u044b\u0437\u043e\u0432\u0430\u043c\u0438.</p> <p>\u0418 \u0434\u0430\u043b\u0435\u0435 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0441\u0430\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442</p> <code>index.html</code> <code>index.html</code> <pre><code>    function connect (componentFn) {\n        const saved = {\n            fn () {\n                connect.now = Object.assign(saved, { context: this, args: arguments, slot: 0 });\n\n                const returnValue = componentFn.apply(this, arguments);\n\n                delete connect.now;\n\n                return returnValue;\n            },\n            data: []\n        };\n\n        return saved.fn;\n    }\n</code></pre> <pre><code>    function Example() {\n      // Declare a new state variable, which we'll call \"count\"\n      const [count1, setCount1] = useState(0);\n      const [count2, setCount2] = useState(0);\n\n      document.body.innerHTML = `\n        &lt;div&gt;\n          &lt;p&gt;You clicked ${count1} times&lt;/p&gt;\n          &lt;p&gt;You clicked ${count2} times&lt;/p&gt;\n          &lt;button id=\"bt1\"&gt;Click me1&lt;/button&gt;\n          &lt;button id=\"bt2\"&gt;Click me2&lt;/button&gt;\n        &lt;/div&gt;\n      `;\n\n      document.getElementById('bt1').onclick = () =&gt; setCount1(count1 + 1);\n      document.getElementById('bt2').onclick = () =&gt; setCount2(count2 + 1);\n    }\n</code></pre> <p>\u0412\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0441 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\u043c \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e</p> <p>\u041e\u0431\u044a\u0435\u043a\u0442 saved \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0438\u0437 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0439 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0438\u0306</p> <p>\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0441\u043b\u043e\u0442\u0430 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u043d\u0430 \u0442\u043e \u043a\u0430\u043a\u043e\u0439 \u0440\u0430\u0437 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f useState \u0432\u043d\u0443\u0442\u0440\u0438 \u044d\u0442\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430</p> <p>\u0421\u043e\u0437\u0434\u0430\u0435\u0442\u0441\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f setValue, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u0437\u044b\u0432\u0430\u0442\u044c\u0441\u044f \u043f\u0440\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f</p> <p>\u041a\u043e\u0433\u0434\u0430 \u043e\u043d\u0430 \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u0437\u0432\u0430\u043d\u0430 \u0443 \u043d\u0435\u0435 \u0431\u0443\u0434\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a saved \u0438 slot, \u043e\u043d\u0430 \u0438\u0437\u043c\u0435\u043d\u0438\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0438 \u0434\u0430\u043b\u044c\u0448\u0435 \u0432\u044b\u0437\u043e\u0432\u0435\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u044e fn \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0437\u0430\u043d\u043e\u0433\u043e \u043f\u0435\u0440\u0435\u0440\u0435\u043d\u0434\u0435\u0440\u0438\u0442 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442</p> <code>index.html</code> <pre><code>    function useState (value) {\n        const saved = connect.now;\n        const { slot } = Object(saved);\n\n        if (saved) {\n            ++saved.slot;\n\n            value = slot in saved.data\n                ? saved.data[slot]\n            : saved.data[slot] = value;\n        }\n\n        return [ value, setValue ];\n\n        function setValue (newValue) {\n            if (saved) {\n                saved.data[slot] = newValue;\n\n                saved.fn.apply(saved.context, saved.args);\n            }\n        }\n    }\n</code></pre> <p>\u0412\u044b\u0437\u043e\u0432 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u0438</p> <code>index.html</code> <pre><code>    connect(Example)();\n</code></pre> <p>Info</p> <pre><code>\u0415\u0441\u043b\u0438 \u043d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c this \u0442\u043e \u0432\u0441\u0435 \u0442\u0430\u043a \u0436\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0432 \u043c\u043e\u0435\u043c \u043f\u0440\u0438\u043c\u0435\u0440\u0435, \u0441\u043a\u043e\u0440\u0435\u0435 \u0432\u0441\u0435\u0433\u043e \n\u044d\u0442\u043e \u043d\u0443\u0436\u043d\u043e \u043a\u043e\u0433\u0434\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0432\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0438 \u0442.\u043f.\n</code></pre>"}]}